2025-05-29 01:50:13,616 DeMo INFO: Saving model in the path :./MSVR310-DeMo/multimodelse_moeloss_frozen_nisimple_momloss_20250529_015009
2025-05-29 01:50:13,616 DeMo INFO: Namespace(config_file='configs/MSVR310/DeMo.yml', fea_cft=0, local_rank=0, opts=['OUTPUT_DIR', './MSVR310-DeMo/multimodelse_moeloss_frozen_nisimple_momloss_20250529_015009'])
2025-05-29 01:50:13,616 DeMo INFO: Loaded configuration file configs/MSVR310/DeMo.yml
2025-05-29 01:50:13,617 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 0
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: True
  HDM: True
  ATM: True
  HEAD: 8
  FROZEN: True
  CENGJIFUSION: True

INPUT:
  SIZE_TRAIN: [ 128, 256 ]
  SIZE_TEST: [ 128, 256 ]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.5 # random erasing
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 4
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('MSVR310')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.00035
  WARMUP_ITERS: 10
  MAX_EPOCHS: 50
  OPTIMIZER_NAME: 'Adam'
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1

TEST:
  IMS_PER_BATCH: 64
  RE_RANKING: 'yes'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'


2025-05-29 01:50:13,617 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: MSVR310
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [128, 256]
  SIZE_TRAIN: [128, 256]
MODEL:
  ADAPTER: False
  ATM: True
  ATT_DROP_RATE: 0.0
  CENGJIFUSION: True
  DEVICE: cuda
  DEVICE_ID: 0
  DIRECT: 0
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: True
  GLOBAL_LOCAL: True
  HDM: True
  HEAD: 8
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  METRIC_LOSS_TYPE: triplet
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
OUTPUT_DIR: ./MSVR310-DeMo/multimodelse_moeloss_frozen_nisimple_momloss_20250529_015009
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 60
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  MARGIN: 0.3
  MAX_EPOCHS: 50
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1111
  STEPS: (40, 70)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 10
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 64
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: yes
  WEIGHT: 
=> RGB_IR loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   155 |     1032 |         8
  query    |    52 |      591 |         8
  gallery  |   155 |     1055 |         8
  ----------------------------------------
data is ready
cengjifusion: True mxa
rwkvbackbone: False mxa
using Transformer_type: ViT-B-16 as a backbone
simplegate: False mxa
tiaoyuelianjie: False mxa
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:8 width: 16
Successfully load ckpt!
_IncompatibleKeys(missing_keys=['visual.triple_dff.fc_atten1.0.weight', 'visual.triple_dff.fc_atten1.1.weight', 'visual.triple_dff.fc_atten1.1.bias', 'visual.triple_dff.fc_atten2.0.weight', 'visual.triple_dff.fc_atten2.1.weight', 'visual.triple_dff.fc_atten2.1.bias', 'visual.triple_dff.fc_atten4.0.weight', 'visual.triple_dff.fc_atten4.1.weight', 'visual.triple_dff.fc_atten4.1.bias', 'visual.triple_dff.input_weight_net.0.weight', 'visual.triple_dff.input_weight_net.0.bias', 'visual.triple_dff.input_weight_net.2.weight', 'visual.triple_dff.input_weight_net.2.bias', 'visual.triple_dff.gate_fc.0.weight', 'visual.triple_dff.gate_enhancement.0.weight', 'visual.triple_dff.gate_enhancement.0.bias', 'visual.triple_dff.fc_redu.0.weight', 'visual.triple_dff.fc_redu.1.weight', 'visual.triple_dff.fc_redu.1.bias', 'visual.triple_dff.residual_fc1.0.weight', 'visual.triple_dff.residual_fc1.1.weight', 'visual.triple_dff.residual_fc1.1.bias', 'visual.triple_dff.residual_fc2.0.weight', 'visual.triple_dff.residual_fc2.1.weight', 'visual.triple_dff.residual_fc2.1.bias', 'visual.triple_dff.residual_fc3.0.weight', 'visual.triple_dff.residual_fc3.1.weight', 'visual.triple_dff.residual_fc3.1.bias', 'visual.triple_dff.residual_fusion.0.weight', 'visual.triple_dff.residual_fusion.1.weight', 'visual.triple_dff.residual_fusion.1.bias', 'visual.triple_dff.fc1.weight', 'visual.triple_dff.fc1.bias', 'visual.triple_dff.fc2.weight', 'visual.triple_dff.fc2.bias', 'visual.triple_dff.fc3.weight', 'visual.triple_dff.fc3.bias', 'visual.triple_dff.attention_fusion.0.weight', 'visual.triple_dff.attention_fusion.0.bias', 'visual.quad_dffs.stage1_triple_dff.fc_atten1.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten1.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten1.1.bias', 'visual.quad_dffs.stage1_triple_dff.fc_atten2.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten2.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten2.1.bias', 'visual.quad_dffs.stage1_triple_dff.fc_atten4.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten4.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten4.1.bias', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.0.weight', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.0.bias', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.2.weight', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.2.bias', 'visual.quad_dffs.stage1_triple_dff.gate_fc.0.weight', 'visual.quad_dffs.stage1_triple_dff.gate_enhancement.0.weight', 'visual.quad_dffs.stage1_triple_dff.gate_enhancement.0.bias', 'visual.quad_dffs.stage1_triple_dff.fc_redu.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_redu.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_redu.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fc1.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc1.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc1.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fc2.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc2.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc2.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fc3.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc3.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc3.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fusion.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fusion.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fusion.1.bias', 'visual.quad_dffs.stage1_triple_dff.fc1.weight', 'visual.quad_dffs.stage1_triple_dff.fc1.bias', 'visual.quad_dffs.stage1_triple_dff.fc2.weight', 'visual.quad_dffs.stage1_triple_dff.fc2.bias', 'visual.quad_dffs.stage1_triple_dff.fc3.weight', 'visual.quad_dffs.stage1_triple_dff.fc3.bias', 'visual.quad_dffs.stage1_triple_dff.attention_fusion.0.weight', 'visual.quad_dffs.stage1_triple_dff.attention_fusion.0.bias', 'visual.quad_dffs.stage1_enhancement.0.weight', 'visual.quad_dffs.stage1_enhancement.0.bias', 'visual.quad_dffs.stage1_enhancement.1.weight', 'visual.quad_dffs.stage1_enhancement.1.bias', 'visual.quad_dffs.stage1_enhancement.3.weight', 'visual.quad_dffs.stage1_enhancement.3.bias', 'visual.quad_dffs.stage1_enhancement.5.weight', 'visual.quad_dffs.stage1_enhancement.5.bias', 'visual.quad_dffs.input4_preprocessing.0.weight', 'visual.quad_dffs.input4_preprocessing.0.bias', 'visual.quad_dffs.input4_preprocessing.1.weight', 'visual.quad_dffs.input4_preprocessing.1.bias', 'visual.quad_dffs.input4_preprocessing.3.weight', 'visual.quad_dffs.input4_preprocessing.3.bias', 'visual.quad_dffs.input4_preprocessing.4.weight', 'visual.quad_dffs.input4_preprocessing.4.bias', 'visual.quad_dffs.cross_stage_attention.0.weight', 'visual.quad_dffs.cross_stage_attention.0.bias', 'visual.quad_dffs.cross_stage_attention.2.weight', 'visual.quad_dffs.cross_stage_attention.2.bias', 'visual.quad_dffs.adaptive_fusion_weight.0.weight', 'visual.quad_dffs.adaptive_fusion_weight.0.bias', 'visual.quad_dffs.adaptive_fusion_weight.2.weight', 'visual.quad_dffs.adaptive_fusion_weight.2.bias', 'visual.quad_dffs.stage2_dff.fc_atten1.0.weight', 'visual.quad_dffs.stage2_dff.fc_atten2.0.weight', 'visual.quad_dffs.stage2_dff.fc_atten3.0.weight', 'visual.quad_dffs.stage2_dff.gate_fc.0.weight', 'visual.quad_dffs.stage2_dff.fc_redu.weight', 'visual.quad_dffs.stage2_dff.residual_fc.weight', 'visual.quad_dffs.stage2_dff.fc1.weight', 'visual.quad_dffs.stage2_dff.fc1.bias', 'visual.quad_dffs.stage2_dff.fc2.weight', 'visual.quad_dffs.stage2_dff.fc2.bias', 'visual.quad_dffs.memory_input1.weight', 'visual.quad_dffs.memory_input4.weight', 'visual.quad_dffs.memory_fusion.0.weight', 'visual.quad_dffs.memory_fusion.1.weight', 'visual.quad_dffs.memory_fusion.1.bias', 'visual.quad_dffs.global_context.0.weight', 'visual.quad_dffs.global_context.0.bias', 'visual.quad_dffs.global_context.2.weight', 'visual.quad_dffs.global_context.2.bias', 'visual.quad_dffs.final_refinement.0.weight', 'visual.quad_dffs.final_refinement.0.bias', 'visual.quad_dffs.final_refinement.1.weight', 'visual.quad_dffs.final_refinement.1.bias', 'visual.quad_dffs.final_refinement.3.weight', 'visual.quad_dffs.final_refinement.3.bias', 'visual.quad_dffs.final_refinement.4.weight', 'visual.quad_dffs.final_refinement.4.bias', 'visual.gated_enhancement.rgb_gating.residual_weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.q_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.k_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.v_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.out_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.out_proj.bias', 'visual.gated_enhancement.rgb_gating.channel_gate.0.weight', 'visual.gated_enhancement.rgb_gating.channel_gate.0.bias', 'visual.gated_enhancement.rgb_gating.channel_gate.2.weight', 'visual.gated_enhancement.rgb_gating.channel_gate.2.bias', 'visual.gated_enhancement.rgb_gating.spatial_gate.0.weight', 'visual.gated_enhancement.rgb_gating.spatial_gate.0.bias', 'visual.gated_enhancement.rgb_gating.spatial_gate.2.weight', 'visual.gated_enhancement.rgb_gating.spatial_gate.2.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.0.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.0.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.1.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.1.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.3.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.3.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.4.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.4.bias', 'visual.gated_enhancement.rgb_gating.adaptive_weight.0.weight', 'visual.gated_enhancement.rgb_gating.adaptive_weight.0.bias', 'visual.gated_enhancement.rgb_gating.adaptive_weight.2.weight', 'visual.gated_enhancement.rgb_gating.adaptive_weight.2.bias', 'visual.gated_enhancement.nir_gating.residual_weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.q_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.k_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.v_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.out_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.out_proj.bias', 'visual.gated_enhancement.nir_gating.channel_gate.0.weight', 'visual.gated_enhancement.nir_gating.channel_gate.0.bias', 'visual.gated_enhancement.nir_gating.channel_gate.2.weight', 'visual.gated_enhancement.nir_gating.channel_gate.2.bias', 'visual.gated_enhancement.nir_gating.spatial_gate.0.weight', 'visual.gated_enhancement.nir_gating.spatial_gate.0.bias', 'visual.gated_enhancement.nir_gating.spatial_gate.2.weight', 'visual.gated_enhancement.nir_gating.spatial_gate.2.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.0.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.0.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.1.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.1.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.3.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.3.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.4.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.4.bias', 'visual.gated_enhancement.nir_gating.adaptive_weight.0.weight', 'visual.gated_enhancement.nir_gating.adaptive_weight.0.bias', 'visual.gated_enhancement.nir_gating.adaptive_weight.2.weight', 'visual.gated_enhancement.nir_gating.adaptive_weight.2.bias', 'visual.gated_enhancement.tir_gating.residual_weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.q_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.k_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.v_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.out_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.out_proj.bias', 'visual.gated_enhancement.tir_gating.channel_gate.0.weight', 'visual.gated_enhancement.tir_gating.channel_gate.0.bias', 'visual.gated_enhancement.tir_gating.channel_gate.2.weight', 'visual.gated_enhancement.tir_gating.channel_gate.2.bias', 'visual.gated_enhancement.tir_gating.spatial_gate.0.weight', 'visual.gated_enhancement.tir_gating.spatial_gate.0.bias', 'visual.gated_enhancement.tir_gating.spatial_gate.2.weight', 'visual.gated_enhancement.tir_gating.spatial_gate.2.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.0.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.0.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.1.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.1.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.3.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.3.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.4.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.4.bias', 'visual.gated_enhancement.tir_gating.adaptive_weight.0.weight', 'visual.gated_enhancement.tir_gating.adaptive_weight.0.bias', 'visual.gated_enhancement.tir_gating.adaptive_weight.2.weight', 'visual.gated_enhancement.tir_gating.adaptive_weight.2.bias', 'visual.gated_enhancement.global_coordination.interaction_net.0.weight', 'visual.gated_enhancement.global_coordination.interaction_net.0.bias', 'visual.gated_enhancement.global_coordination.interaction_net.1.weight', 'visual.gated_enhancement.global_coordination.interaction_net.1.bias', 'visual.gated_enhancement.global_coordination.interaction_net.3.weight', 'visual.gated_enhancement.global_coordination.interaction_net.3.bias', 'visual.gated_enhancement.global_coordination.interaction_net.4.weight', 'visual.gated_enhancement.global_coordination.interaction_net.4.bias', 'visual.gated_enhancement.global_coordination.balance_net.0.weight', 'visual.gated_enhancement.global_coordination.balance_net.0.bias', 'visual.gated_enhancement.global_coordination.balance_net.2.weight', 'visual.gated_enhancement.global_coordination.balance_net.2.bias', 'visual.gated_enhancement.global_coordination.global_gate.0.weight', 'visual.gated_enhancement.global_coordination.global_gate.0.bias', 'visual.gated_enhancement.global_coordination.global_gate.2.weight', 'visual.gated_enhancement.global_coordination.global_gate.2.bias'], unexpected_keys=[])
Loading pretrained model from CLIP
camera number is : 8
combineway: multimodelse mxa
2025-05-29 01:50:22,390 DeMo INFO: combineway: multimodelse
UsingDiversity: False mxa
usemultimodal_token_se: True mxa
===========Building DeMo===========
2025-05-29 01:50:22,404 DeMo INFO: DeMo(
  (BACKBONE): build_transformer_new(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (triple_dff): TripleInputDirectDFF(
        (avg_pool1): AdaptiveAvgPool1d(output_size=1)
        (avg_pool2): AdaptiveAvgPool1d(output_size=2)
        (avg_pool4): AdaptiveAvgPool1d(output_size=4)
        (fc_atten1): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
        (fc_atten2): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
        (fc_atten4): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
        (input_weight_net): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=768, out_features=3, bias=True)
          (3): Softmax(dim=-1)
        )
        (gate_fc): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): Sigmoid()
        )
        (gate_enhancement): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=True)
          (1): Tanh()
        )
        (fc_redu): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
        )
        (residual_fc1): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (residual_fc2): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (residual_fc3): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (residual_fusion): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (fc1): Linear(in_features=768, out_features=1, bias=True)
        (fc2): Linear(in_features=768, out_features=1, bias=True)
        (fc3): Linear(in_features=768, out_features=1, bias=True)
        (attention_fusion): Sequential(
          (0): Linear(in_features=3, out_features=1, bias=True)
          (1): Sigmoid()
        )
      )
      (quad_dffs): QuadInputHierarchicalDFF(
        (stage1_triple_dff): TripleInputDirectDFF(
          (avg_pool1): AdaptiveAvgPool1d(output_size=1)
          (avg_pool2): AdaptiveAvgPool1d(output_size=2)
          (avg_pool4): AdaptiveAvgPool1d(output_size=4)
          (fc_atten1): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
            (2): Sigmoid()
          )
          (fc_atten2): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
            (2): Sigmoid()
          )
          (fc_atten4): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
            (2): Sigmoid()
          )
          (input_weight_net): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=3, bias=True)
            (3): Softmax(dim=-1)
          )
          (gate_fc): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): Sigmoid()
          )
          (gate_enhancement): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=True)
            (1): Tanh()
          )
          (fc_redu): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
          )
          (residual_fc1): Sequential(
            (0): Linear(in_features=768, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (residual_fc2): Sequential(
            (0): Linear(in_features=768, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (residual_fc3): Sequential(
            (0): Linear(in_features=768, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (residual_fusion): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (fc1): Linear(in_features=768, out_features=1, bias=True)
          (fc2): Linear(in_features=768, out_features=1, bias=True)
          (fc3): Linear(in_features=768, out_features=1, bias=True)
          (attention_fusion): Sequential(
            (0): Linear(in_features=3, out_features=1, bias=True)
            (1): Sigmoid()
          )
        )
        (stage1_enhancement): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
          (3): Linear(in_features=768, out_features=192, bias=True)
          (4): ReLU(inplace=True)
          (5): Linear(in_features=192, out_features=768, bias=True)
          (6): Sigmoid()
        )
        (input4_preprocessing): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
          (3): Linear(in_features=768, out_features=768, bias=True)
          (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (cross_stage_attention): Sequential(
          (0): Linear(in_features=768, out_features=96, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=96, out_features=768, bias=True)
          (3): Sigmoid()
        )
        (adaptive_fusion_weight): Sequential(
          (0): Linear(in_features=1536, out_features=192, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=192, out_features=2, bias=True)
          (3): Softmax(dim=-1)
        )
        (stage2_dff): InnovativeDFF(
          (avg_pool1): AdaptiveAvgPool1d(output_size=1)
          (avg_pool2): AdaptiveAvgPool1d(output_size=2)
          (avg_pool3): AdaptiveAvgPool1d(output_size=4)
          (fc_atten1): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (fc_atten2): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (fc_atten3): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (gate_fc): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (fc_redu): Linear(in_features=1536, out_features=768, bias=False)
          (residual_fc): Linear(in_features=768, out_features=768, bias=False)
          (fc1): Linear(in_features=768, out_features=1, bias=True)
          (fc2): Linear(in_features=768, out_features=1, bias=True)
          (nonlin): Sigmoid()
        )
        (memory_input1): Linear(in_features=768, out_features=768, bias=False)
        (memory_input4): Linear(in_features=768, out_features=768, bias=False)
        (memory_fusion): Sequential(
          (0): Linear(in_features=1536, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (global_context): Sequential(
          (0): Linear(in_features=768, out_features=384, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=384, out_features=768, bias=True)
          (3): Sigmoid()
        )
        (final_refinement): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
          (3): Linear(in_features=768, out_features=768, bias=True)
          (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
      (gated_enhancement): GatedModalityEnhancement(
        (rgb_gating): ModalityGatingUnit(
          (cross_modal_attention): CrossModalAttentionGate(
            (q_proj): Linear(in_features=768, out_features=768, bias=False)
            (k_proj): Linear(in_features=768, out_features=768, bias=False)
            (v_proj): Linear(in_features=768, out_features=768, bias=False)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (channel_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=768, bias=True)
            (3): Sigmoid()
          )
          (spatial_gate): Sequential(
            (0): Linear(in_features=1536, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=1, bias=True)
            (3): Sigmoid()
          )
          (feature_fusion): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (adaptive_weight): Sequential(
            (0): Linear(in_features=1536, out_features=384, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=384, out_features=2, bias=True)
            (3): Softmax(dim=-1)
          )
        )
        (nir_gating): ModalityGatingUnit(
          (cross_modal_attention): CrossModalAttentionGate(
            (q_proj): Linear(in_features=768, out_features=768, bias=False)
            (k_proj): Linear(in_features=768, out_features=768, bias=False)
            (v_proj): Linear(in_features=768, out_features=768, bias=False)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (channel_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=768, bias=True)
            (3): Sigmoid()
          )
          (spatial_gate): Sequential(
            (0): Linear(in_features=1536, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=1, bias=True)
            (3): Sigmoid()
          )
          (feature_fusion): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (adaptive_weight): Sequential(
            (0): Linear(in_features=1536, out_features=384, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=384, out_features=2, bias=True)
            (3): Softmax(dim=-1)
          )
        )
        (tir_gating): ModalityGatingUnit(
          (cross_modal_attention): CrossModalAttentionGate(
            (q_proj): Linear(in_features=768, out_features=768, bias=False)
            (k_proj): Linear(in_features=768, out_features=768, bias=False)
            (v_proj): Linear(in_features=768, out_features=768, bias=False)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (channel_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=768, bias=True)
            (3): Sigmoid()
          )
          (spatial_gate): Sequential(
            (0): Linear(in_features=1536, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=1, bias=True)
            (3): Sigmoid()
          )
          (feature_fusion): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (adaptive_weight): Sequential(
            (0): Linear(in_features=1536, out_features=384, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=384, out_features=2, bias=True)
            (3): Softmax(dim=-1)
          )
        )
        (global_coordination): GlobalCoordinationGate(
          (interaction_net): Sequential(
            (0): Linear(in_features=2304, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (balance_net): Sequential(
            (0): Linear(in_features=4608, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=3, bias=True)
            (3): Softmax(dim=-1)
          )
          (global_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=1, bias=True)
            (3): Sigmoid()
          )
        )
      )
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (generalFusion): GeneralFusion(
    (r): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (n): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (t): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (rn): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (rt): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (nt): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (rnt): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (moe): MoM(
      (experts): ModuleList(
        (0): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (1): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (2): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (3): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (4): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (5): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (6): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (7): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
      )
      (gating_network): GatingNetwork(
        (gate): CrossAttention(
          (linear_re): Sequential(
            (0): Linear(in_features=3584, out_features=512, bias=True)
            (1): QuickGELU()
            (2): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (q_): Linear(in_features=512, out_features=512, bias=False)
          (k_): Linear(in_features=512, out_features=512, bias=False)
        )
      )
    )
    (multimodal_token_se): MultiModalTokenSE(
      (rgb_aggregator): Sequential(
        (0): Linear(in_features=128, out_features=32, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=32, out_features=128, bias=True)
        (3): Sigmoid()
      )
      (nir_aggregator): Sequential(
        (0): Linear(in_features=128, out_features=32, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=32, out_features=128, bias=True)
        (3): Sigmoid()
      )
      (tir_aggregator): Sequential(
        (0): Linear(in_features=128, out_features=32, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=32, out_features=128, bias=True)
        (3): Sigmoid()
      )
      (adaptive_weighting): AdaptiveWeighting(
        (weight_net): Sequential(
          (0): Linear(in_features=384, out_features=128, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=128, out_features=384, bias=True)
          (3): Softmax(dim=-1)
        )
      )
      (global_context_net): Sequential(
        (0): Linear(in_features=384, out_features=128, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=128, out_features=128, bias=True)
        (3): Sigmoid()
      )
      (modal_balance): Sequential(
        (0): Linear(in_features=3, out_features=8, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=8, out_features=3, bias=True)
        (3): Softmax(dim=-1)
      )
      (enhancement_net): Sequential(
        (0): Linear(in_features=384, out_features=128, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=128, out_features=128, bias=True)
        (3): Sigmoid()
      )
    )
  )
  (classifier_moe): Linear(in_features=3584, out_features=155, bias=False)
  (bottleneck_moe): BatchNorm1d(3584, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_r): Linear(in_features=512, out_features=155, bias=False)
  (bottleneck_r): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_n): Linear(in_features=512, out_features=155, bias=False)
  (bottleneck_n): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_t): Linear(in_features=512, out_features=155, bias=False)
  (bottleneck_t): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-05-29 01:50:22,407 DeMo INFO: number of parameters:12.599836
using soft triplet loss for training
label smooth on, numclasses: 155
2025-05-29 01:50:22,432 DeMo.train INFO: start training
diversityweight: 10 mxa
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/ma1/work/demorelated/DeMo/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
2025-05-29 01:50:53,150 DeMo.train INFO: Epoch[1] Iteration[10/16] Loss: 12.270, Acc: 0.006, Base Lr: 6.65e-05
2025-05-29 01:50:55,534 DeMo.train INFO: Epoch 1 done. Time per batch: 2.363[s] Speed: 27.1[samples/s]
2025-05-29 01:50:55,538 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:50:55,538 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 01:50:55,538 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1093
CMC curve: Rank-1: 0.2758, Rank-5: 0.4332, Rank-10: 0.5262
=> Enter reranking
=> Results after reranking:
mAP: 0.1093
CMC curve: Rank-1: 0.2386, Rank-5: 0.4027, Rank-10: 0.4839
=> Improvement:
mAP improvement: 0.0000 (+0.02%)
Rank-1 improvement: -0.0372 (-13.50%)
2025-05-29 01:51:54,495 DeMo.train INFO: Validation Results - Epoch: 1
2025-05-29 01:51:54,495 DeMo.train INFO: mAP: 10.9%
2025-05-29 01:51:54,495 DeMo.train INFO: CMC curve, Rank-1  :23.9%
2025-05-29 01:51:54,496 DeMo.train INFO: CMC curve, Rank-5  :40.3%
2025-05-29 01:51:54,496 DeMo.train INFO: CMC curve, Rank-10 :48.4%
2025-05-29 01:51:54,496 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:51:55,573 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:51:55,573 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 01:51:55,573 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/home/ma1/work/demorelated/DeMo/utils/metrics.py:275: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1420.)
  distmat_original.addmm_(1, -2, qf, gf.t())
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1455
CMC curve: Rank-1: 0.3706, Rank-5: 0.5499, Rank-10: 0.6261
=> Enter reranking
=> Results after reranking:
mAP: 0.1501
CMC curve: Rank-1: 0.3299, Rank-5: 0.4890, Rank-10: 0.5651
=> Improvement:
mAP improvement: 0.0046 (+3.17%)
Rank-1 improvement: -0.0406 (-10.96%)
2025-05-29 01:52:49,022 DeMo.train INFO: Validation Results - Epoch: 1
2025-05-29 01:52:49,022 DeMo.train INFO: mAP: 15.0%
2025-05-29 01:52:49,022 DeMo.train INFO: CMC curve, Rank-1  :33.0%
2025-05-29 01:52:49,022 DeMo.train INFO: CMC curve, Rank-5  :48.9%
2025-05-29 01:52:49,022 DeMo.train INFO: CMC curve, Rank-10 :56.5%
2025-05-29 01:52:49,023 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:52:49,322 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:52:49,322 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 01:52:49,322 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1093
CMC curve: Rank-1: 0.2758, Rank-5: 0.4332, Rank-10: 0.5262
=> Enter reranking
=> Results after reranking:
mAP: 0.1094
CMC curve: Rank-1: 0.2369, Rank-5: 0.4027, Rank-10: 0.4839
=> Improvement:
mAP improvement: 0.0001 (+0.06%)
Rank-1 improvement: -0.0389 (-14.11%)
2025-05-29 01:53:42,704 DeMo.train INFO: Validation Results - Epoch: 1
2025-05-29 01:53:42,704 DeMo.train INFO: mAP: 10.9%
2025-05-29 01:53:42,704 DeMo.train INFO: CMC curve, Rank-1  :23.7%
2025-05-29 01:53:42,705 DeMo.train INFO: CMC curve, Rank-5  :40.3%
2025-05-29 01:53:42,705 DeMo.train INFO: CMC curve, Rank-10 :48.4%
2025-05-29 01:53:42,705 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:53:51,661 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:53:51,661 DeMo.train INFO: Best mAP: 10.9%
2025-05-29 01:53:51,661 DeMo.train INFO: Best Rank-1: 23.7%
2025-05-29 01:53:51,661 DeMo.train INFO: Best Rank-5: 40.3%
2025-05-29 01:53:51,662 DeMo.train INFO: Best Rank-10: 48.4%
2025-05-29 01:53:51,662 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:54:08,335 DeMo.train INFO: Epoch[2] Iteration[10/16] Loss: 10.529, Acc: 0.219, Base Lr: 9.80e-05
2025-05-29 01:54:10,733 DeMo.train INFO: Epoch 2 done. Time per batch: 1.362[s] Speed: 47.0[samples/s]
2025-05-29 01:54:10,737 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:54:10,737 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 01:54:10,737 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1216
CMC curve: Rank-1: 0.2826, Rank-5: 0.4585, Rank-10: 0.5533
=> Enter reranking
=> Results after reranking:
mAP: 0.1296
CMC curve: Rank-1: 0.2521, Rank-5: 0.4298, Rank-10: 0.5110
=> Improvement:
mAP improvement: 0.0081 (+6.63%)
Rank-1 improvement: -0.0305 (-10.78%)
2025-05-29 01:55:05,675 DeMo.train INFO: Validation Results - Epoch: 2
2025-05-29 01:55:05,675 DeMo.train INFO: mAP: 13.0%
2025-05-29 01:55:05,676 DeMo.train INFO: CMC curve, Rank-1  :25.2%
2025-05-29 01:55:05,676 DeMo.train INFO: CMC curve, Rank-5  :43.0%
2025-05-29 01:55:05,676 DeMo.train INFO: CMC curve, Rank-10 :51.1%
2025-05-29 01:55:05,676 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:55:06,298 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:55:06,299 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 01:55:06,299 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1842
CMC curve: Rank-1: 0.4044, Rank-5: 0.5871, Rank-10: 0.6751
=> Enter reranking
=> Results after reranking:
mAP: 0.2170
CMC curve: Rank-1: 0.3909, Rank-5: 0.5567, Rank-10: 0.6277
=> Improvement:
mAP improvement: 0.0328 (+17.83%)
Rank-1 improvement: -0.0135 (-3.35%)
2025-05-29 01:56:04,529 DeMo.train INFO: Validation Results - Epoch: 2
2025-05-29 01:56:04,529 DeMo.train INFO: mAP: 21.7%
2025-05-29 01:56:04,529 DeMo.train INFO: CMC curve, Rank-1  :39.1%
2025-05-29 01:56:04,529 DeMo.train INFO: CMC curve, Rank-5  :55.7%
2025-05-29 01:56:04,529 DeMo.train INFO: CMC curve, Rank-10 :62.8%
2025-05-29 01:56:04,529 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:56:05,685 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:56:05,685 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 01:56:05,686 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1221
CMC curve: Rank-1: 0.2843, Rank-5: 0.4602, Rank-10: 0.5550
=> Enter reranking
=> Results after reranking:
mAP: 0.1296
CMC curve: Rank-1: 0.2487, Rank-5: 0.4315, Rank-10: 0.5110
=> Improvement:
mAP improvement: 0.0075 (+6.14%)
Rank-1 improvement: -0.0355 (-12.50%)
2025-05-29 01:56:59,215 DeMo.train INFO: Validation Results - Epoch: 2
2025-05-29 01:56:59,216 DeMo.train INFO: mAP: 13.0%
2025-05-29 01:56:59,216 DeMo.train INFO: CMC curve, Rank-1  :24.9%
2025-05-29 01:56:59,216 DeMo.train INFO: CMC curve, Rank-5  :43.1%
2025-05-29 01:56:59,216 DeMo.train INFO: CMC curve, Rank-10 :51.1%
2025-05-29 01:56:59,216 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:57:06,942 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:57:06,943 DeMo.train INFO: Best mAP: 13.0%
2025-05-29 01:57:06,943 DeMo.train INFO: Best Rank-1: 24.9%
2025-05-29 01:57:06,943 DeMo.train INFO: Best Rank-5: 43.1%
2025-05-29 01:57:06,943 DeMo.train INFO: Best Rank-10: 51.1%
2025-05-29 01:57:06,943 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:57:25,142 DeMo.train INFO: Epoch[3] Iteration[10/16] Loss: 9.477, Acc: 0.553, Base Lr: 1.30e-04
2025-05-29 01:57:30,761 DeMo.train INFO: Epoch 3 done. Time per batch: 1.701[s] Speed: 37.6[samples/s]
2025-05-29 01:57:30,765 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:57:30,765 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 01:57:30,765 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1345
CMC curve: Rank-1: 0.3080, Rank-5: 0.4822, Rank-10: 0.5770
=> Enter reranking
=> Results after reranking:
mAP: 0.1530
CMC curve: Rank-1: 0.3080, Rank-5: 0.4738, Rank-10: 0.5431
=> Improvement:
mAP improvement: 0.0185 (+13.75%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 01:58:19,195 DeMo.train INFO: Validation Results - Epoch: 3
2025-05-29 01:58:19,196 DeMo.train INFO: mAP: 15.3%
2025-05-29 01:58:19,196 DeMo.train INFO: CMC curve, Rank-1  :30.8%
2025-05-29 01:58:19,196 DeMo.train INFO: CMC curve, Rank-5  :47.4%
2025-05-29 01:58:19,196 DeMo.train INFO: CMC curve, Rank-10 :54.3%
2025-05-29 01:58:19,196 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:58:19,772 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:58:19,773 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 01:58:19,773 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2098
CMC curve: Rank-1: 0.4196, Rank-5: 0.6091, Rank-10: 0.6971
=> Enter reranking
=> Results after reranking:
mAP: 0.2682
CMC curve: Rank-1: 0.4332, Rank-5: 0.5973, Rank-10: 0.6464
=> Improvement:
mAP improvement: 0.0584 (+27.86%)
Rank-1 improvement: 0.0135 (+3.23%)
2025-05-29 01:59:23,327 DeMo.train INFO: Validation Results - Epoch: 3
2025-05-29 01:59:23,327 DeMo.train INFO: mAP: 26.8%
2025-05-29 01:59:23,327 DeMo.train INFO: CMC curve, Rank-1  :43.3%
2025-05-29 01:59:23,327 DeMo.train INFO: CMC curve, Rank-5  :59.7%
2025-05-29 01:59:23,327 DeMo.train INFO: CMC curve, Rank-10 :64.6%
2025-05-29 01:59:23,327 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:59:24,493 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 01:59:24,493 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 01:59:24,493 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1373
CMC curve: Rank-1: 0.3096, Rank-5: 0.4890, Rank-10: 0.5854
=> Enter reranking
=> Results after reranking:
mAP: 0.1564
CMC curve: Rank-1: 0.3063, Rank-5: 0.4839, Rank-10: 0.5516
=> Improvement:
mAP improvement: 0.0191 (+13.95%)
Rank-1 improvement: -0.0034 (-1.09%)
2025-05-29 02:00:19,625 DeMo.train INFO: Validation Results - Epoch: 3
2025-05-29 02:00:19,625 DeMo.train INFO: mAP: 15.6%
2025-05-29 02:00:19,626 DeMo.train INFO: CMC curve, Rank-1  :30.6%
2025-05-29 02:00:19,626 DeMo.train INFO: CMC curve, Rank-5  :48.4%
2025-05-29 02:00:19,626 DeMo.train INFO: CMC curve, Rank-10 :55.2%
2025-05-29 02:00:19,626 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:00:27,688 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:00:27,688 DeMo.train INFO: Best mAP: 15.6%
2025-05-29 02:00:27,688 DeMo.train INFO: Best Rank-1: 30.6%
2025-05-29 02:00:27,688 DeMo.train INFO: Best Rank-5: 48.4%
2025-05-29 02:00:27,688 DeMo.train INFO: Best Rank-10: 55.2%
2025-05-29 02:00:27,688 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:00:45,918 DeMo.train INFO: Epoch[4] Iteration[10/16] Loss: 8.884, Acc: 0.641, Base Lr: 1.61e-04
2025-05-29 02:00:52,680 DeMo.train INFO: Epoch 4 done. Time per batch: 1.666[s] Speed: 38.4[samples/s]
2025-05-29 02:00:52,684 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:00:52,684 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:00:52,684 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1439
CMC curve: Rank-1: 0.3198, Rank-5: 0.5025, Rank-10: 0.6024
=> Enter reranking
=> Results after reranking:
mAP: 0.1797
CMC curve: Rank-1: 0.3418, Rank-5: 0.5059, Rank-10: 0.5770
=> Improvement:
mAP improvement: 0.0357 (+24.82%)
Rank-1 improvement: 0.0220 (+6.88%)
2025-05-29 02:01:43,914 DeMo.train INFO: Validation Results - Epoch: 4
2025-05-29 02:01:43,914 DeMo.train INFO: mAP: 18.0%
2025-05-29 02:01:43,914 DeMo.train INFO: CMC curve, Rank-1  :34.2%
2025-05-29 02:01:43,914 DeMo.train INFO: CMC curve, Rank-5  :50.6%
2025-05-29 02:01:43,915 DeMo.train INFO: CMC curve, Rank-10 :57.7%
2025-05-29 02:01:43,915 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:01:44,014 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:01:44,014 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:01:44,014 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2333
CMC curve: Rank-1: 0.4552, Rank-5: 0.6244, Rank-10: 0.7208
=> Enter reranking
=> Results after reranking:
mAP: 0.3046
CMC curve: Rank-1: 0.4365, Rank-5: 0.6159, Rank-10: 0.6853
=> Improvement:
mAP improvement: 0.0713 (+30.55%)
Rank-1 improvement: -0.0186 (-4.09%)
2025-05-29 02:02:46,717 DeMo.train INFO: Validation Results - Epoch: 4
2025-05-29 02:02:46,717 DeMo.train INFO: mAP: 30.5%
2025-05-29 02:02:46,717 DeMo.train INFO: CMC curve, Rank-1  :43.7%
2025-05-29 02:02:46,717 DeMo.train INFO: CMC curve, Rank-5  :61.6%
2025-05-29 02:02:46,717 DeMo.train INFO: CMC curve, Rank-10 :68.5%
2025-05-29 02:02:46,717 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:02:46,734 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:02:46,734 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:02:46,734 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1650
CMC curve: Rank-1: 0.3469, Rank-5: 0.5364, Rank-10: 0.6379
=> Enter reranking
=> Results after reranking:
mAP: 0.2078
CMC curve: Rank-1: 0.3587, Rank-5: 0.5347, Rank-10: 0.5973
=> Improvement:
mAP improvement: 0.0429 (+25.99%)
Rank-1 improvement: 0.0118 (+3.41%)
2025-05-29 02:03:41,474 DeMo.train INFO: Validation Results - Epoch: 4
2025-05-29 02:03:41,474 DeMo.train INFO: mAP: 20.8%
2025-05-29 02:03:41,475 DeMo.train INFO: CMC curve, Rank-1  :35.9%
2025-05-29 02:03:41,475 DeMo.train INFO: CMC curve, Rank-5  :53.5%
2025-05-29 02:03:41,475 DeMo.train INFO: CMC curve, Rank-10 :59.7%
2025-05-29 02:03:41,475 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:03:49,781 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:03:49,781 DeMo.train INFO: Best mAP: 20.8%
2025-05-29 02:03:49,781 DeMo.train INFO: Best Rank-1: 35.9%
2025-05-29 02:03:49,781 DeMo.train INFO: Best Rank-5: 53.5%
2025-05-29 02:03:49,781 DeMo.train INFO: Best Rank-10: 59.7%
2025-05-29 02:03:49,781 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:04:08,475 DeMo.train INFO: Epoch[5] Iteration[10/16] Loss: 8.434, Acc: 0.664, Base Lr: 1.93e-04
2025-05-29 02:04:14,864 DeMo.train INFO: Epoch 5 done. Time per batch: 1.672[s] Speed: 38.3[samples/s]
2025-05-29 02:04:14,868 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:04:14,868 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:04:14,868 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1537
CMC curve: Rank-1: 0.3215, Rank-5: 0.5127, Rank-10: 0.6176
=> Enter reranking
=> Results after reranking:
mAP: 0.2047
CMC curve: Rank-1: 0.3316, Rank-5: 0.5279, Rank-10: 0.6024
=> Improvement:
mAP improvement: 0.0511 (+33.24%)
Rank-1 improvement: 0.0102 (+3.16%)
2025-05-29 02:05:06,662 DeMo.train INFO: Validation Results - Epoch: 5
2025-05-29 02:05:06,662 DeMo.train INFO: mAP: 20.5%
2025-05-29 02:05:06,662 DeMo.train INFO: CMC curve, Rank-1  :33.2%
2025-05-29 02:05:06,662 DeMo.train INFO: CMC curve, Rank-5  :52.8%
2025-05-29 02:05:06,662 DeMo.train INFO: CMC curve, Rank-10 :60.2%
2025-05-29 02:05:06,663 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:05:06,983 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:05:06,984 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:05:06,984 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2616
CMC curve: Rank-1: 0.4484, Rank-5: 0.6514, Rank-10: 0.7310
=> Enter reranking
=> Results after reranking:
mAP: 0.3390
CMC curve: Rank-1: 0.4687, Rank-5: 0.6396, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.0774 (+29.60%)
Rank-1 improvement: 0.0203 (+4.53%)
2025-05-29 02:06:10,397 DeMo.train INFO: Validation Results - Epoch: 5
2025-05-29 02:06:10,398 DeMo.train INFO: mAP: 33.9%
2025-05-29 02:06:10,398 DeMo.train INFO: CMC curve, Rank-1  :46.9%
2025-05-29 02:06:10,398 DeMo.train INFO: CMC curve, Rank-5  :64.0%
2025-05-29 02:06:10,398 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 02:06:10,398 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:06:11,253 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:06:11,253 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:06:11,253 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2453
CMC curve: Rank-1: 0.4298, Rank-5: 0.6582, Rank-10: 0.7208
=> Enter reranking
=> Results after reranking:
mAP: 0.3318
CMC curve: Rank-1: 0.4738, Rank-5: 0.6481, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.0864 (+35.23%)
Rank-1 improvement: 0.0440 (+10.24%)
2025-05-29 02:07:04,787 DeMo.train INFO: Validation Results - Epoch: 5
2025-05-29 02:07:04,787 DeMo.train INFO: mAP: 33.2%
2025-05-29 02:07:04,787 DeMo.train INFO: CMC curve, Rank-1  :47.4%
2025-05-29 02:07:04,787 DeMo.train INFO: CMC curve, Rank-5  :64.8%
2025-05-29 02:07:04,787 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 02:07:04,787 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:07:12,743 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:07:12,743 DeMo.train INFO: Best mAP: 33.2%
2025-05-29 02:07:12,743 DeMo.train INFO: Best Rank-1: 47.4%
2025-05-29 02:07:12,743 DeMo.train INFO: Best Rank-5: 64.8%
2025-05-29 02:07:12,743 DeMo.train INFO: Best Rank-10: 70.7%
2025-05-29 02:07:12,743 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:07:31,084 DeMo.train INFO: Epoch[6] Iteration[10/16] Loss: 7.892, Acc: 0.688, Base Lr: 2.24e-04
2025-05-29 02:07:36,726 DeMo.train INFO: Epoch 6 done. Time per batch: 1.713[s] Speed: 37.4[samples/s]
2025-05-29 02:07:36,729 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:07:36,730 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:07:36,730 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1394
CMC curve: Rank-1: 0.2843, Rank-5: 0.5127, Rank-10: 0.6074
=> Enter reranking
=> Results after reranking:
mAP: 0.1974
CMC curve: Rank-1: 0.3689, Rank-5: 0.5127, Rank-10: 0.5973
=> Improvement:
mAP improvement: 0.0580 (+41.61%)
Rank-1 improvement: 0.0846 (+29.76%)
2025-05-29 02:08:25,837 DeMo.train INFO: Validation Results - Epoch: 6
2025-05-29 02:08:25,837 DeMo.train INFO: mAP: 19.7%
2025-05-29 02:08:25,837 DeMo.train INFO: CMC curve, Rank-1  :36.9%
2025-05-29 02:08:25,837 DeMo.train INFO: CMC curve, Rank-5  :51.3%
2025-05-29 02:08:25,837 DeMo.train INFO: CMC curve, Rank-10 :59.7%
2025-05-29 02:08:25,837 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:08:26,530 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:08:26,530 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:08:26,530 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2741
CMC curve: Rank-1: 0.4687, Rank-5: 0.6684, Rank-10: 0.7411
=> Enter reranking
=> Results after reranking:
mAP: 0.3715
CMC curve: Rank-1: 0.4907, Rank-5: 0.6396, Rank-10: 0.6988
=> Improvement:
mAP improvement: 0.0974 (+35.53%)
Rank-1 improvement: 0.0220 (+4.69%)
2025-05-29 02:09:30,728 DeMo.train INFO: Validation Results - Epoch: 6
2025-05-29 02:09:30,728 DeMo.train INFO: mAP: 37.2%
2025-05-29 02:09:30,728 DeMo.train INFO: CMC curve, Rank-1  :49.1%
2025-05-29 02:09:30,728 DeMo.train INFO: CMC curve, Rank-5  :64.0%
2025-05-29 02:09:30,729 DeMo.train INFO: CMC curve, Rank-10 :69.9%
2025-05-29 02:09:30,729 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:09:31,936 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:09:31,937 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:09:31,937 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2737
CMC curve: Rank-1: 0.4619, Rank-5: 0.6650, Rank-10: 0.7293
=> Enter reranking
=> Results after reranking:
mAP: 0.3751
CMC curve: Rank-1: 0.4924, Rank-5: 0.6616, Rank-10: 0.7140
=> Improvement:
mAP improvement: 0.1014 (+37.04%)
Rank-1 improvement: 0.0305 (+6.59%)
2025-05-29 02:10:25,655 DeMo.train INFO: Validation Results - Epoch: 6
2025-05-29 02:10:25,655 DeMo.train INFO: mAP: 37.5%
2025-05-29 02:10:25,655 DeMo.train INFO: CMC curve, Rank-1  :49.2%
2025-05-29 02:10:25,655 DeMo.train INFO: CMC curve, Rank-5  :66.2%
2025-05-29 02:10:25,655 DeMo.train INFO: CMC curve, Rank-10 :71.4%
2025-05-29 02:10:25,655 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:10:33,512 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:10:33,512 DeMo.train INFO: Best mAP: 37.5%
2025-05-29 02:10:33,512 DeMo.train INFO: Best Rank-1: 49.2%
2025-05-29 02:10:33,512 DeMo.train INFO: Best Rank-5: 66.2%
2025-05-29 02:10:33,513 DeMo.train INFO: Best Rank-10: 71.4%
2025-05-29 02:10:33,513 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:10:51,974 DeMo.train INFO: Epoch[7] Iteration[10/16] Loss: 7.524, Acc: 0.809, Base Lr: 2.55e-04
2025-05-29 02:10:57,566 DeMo.train INFO: Epoch 7 done. Time per batch: 1.718[s] Speed: 37.3[samples/s]
2025-05-29 02:10:57,570 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:10:57,570 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:10:57,570 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1364
CMC curve: Rank-1: 0.3029, Rank-5: 0.4992, Rank-10: 0.6024
=> Enter reranking
=> Results after reranking:
mAP: 0.1890
CMC curve: Rank-1: 0.3299, Rank-5: 0.4958, Rank-10: 0.5618
=> Improvement:
mAP improvement: 0.0526 (+38.55%)
Rank-1 improvement: 0.0271 (+8.94%)
2025-05-29 02:11:46,171 DeMo.train INFO: Validation Results - Epoch: 7
2025-05-29 02:11:46,171 DeMo.train INFO: mAP: 18.9%
2025-05-29 02:11:46,171 DeMo.train INFO: CMC curve, Rank-1  :33.0%
2025-05-29 02:11:46,171 DeMo.train INFO: CMC curve, Rank-5  :49.6%
2025-05-29 02:11:46,171 DeMo.train INFO: CMC curve, Rank-10 :56.2%
2025-05-29 02:11:46,171 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:11:46,692 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:11:46,692 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:11:46,692 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2814
CMC curve: Rank-1: 0.4670, Rank-5: 0.6667, Rank-10: 0.7343
=> Enter reranking
=> Results after reranking:
mAP: 0.3780
CMC curve: Rank-1: 0.5025, Rank-5: 0.6684, Rank-10: 0.7310
=> Improvement:
mAP improvement: 0.0966 (+34.34%)
Rank-1 improvement: 0.0355 (+7.61%)
2025-05-29 02:12:48,850 DeMo.train INFO: Validation Results - Epoch: 7
2025-05-29 02:12:48,851 DeMo.train INFO: mAP: 37.8%
2025-05-29 02:12:48,851 DeMo.train INFO: CMC curve, Rank-1  :50.3%
2025-05-29 02:12:48,851 DeMo.train INFO: CMC curve, Rank-5  :66.8%
2025-05-29 02:12:48,851 DeMo.train INFO: CMC curve, Rank-10 :73.1%
2025-05-29 02:12:48,851 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:12:49,173 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:12:49,173 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:12:49,173 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2821
CMC curve: Rank-1: 0.4670, Rank-5: 0.6667, Rank-10: 0.7360
=> Enter reranking
=> Results after reranking:
mAP: 0.3814
CMC curve: Rank-1: 0.5025, Rank-5: 0.6836, Rank-10: 0.7377
=> Improvement:
mAP improvement: 0.0993 (+35.21%)
Rank-1 improvement: 0.0355 (+7.61%)
2025-05-29 02:13:41,062 DeMo.train INFO: Validation Results - Epoch: 7
2025-05-29 02:13:41,062 DeMo.train INFO: mAP: 38.1%
2025-05-29 02:13:41,062 DeMo.train INFO: CMC curve, Rank-1  :50.3%
2025-05-29 02:13:41,062 DeMo.train INFO: CMC curve, Rank-5  :68.4%
2025-05-29 02:13:41,062 DeMo.train INFO: CMC curve, Rank-10 :73.8%
2025-05-29 02:13:41,062 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:13:49,082 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:13:49,083 DeMo.train INFO: Best mAP: 38.1%
2025-05-29 02:13:49,083 DeMo.train INFO: Best Rank-1: 50.3%
2025-05-29 02:13:49,083 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 02:13:49,083 DeMo.train INFO: Best Rank-10: 73.8%
2025-05-29 02:13:49,083 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:14:07,711 DeMo.train INFO: Epoch[8] Iteration[10/16] Loss: 7.193, Acc: 0.883, Base Lr: 2.87e-04
2025-05-29 02:14:13,341 DeMo.train INFO: Epoch 8 done. Time per batch: 1.733[s] Speed: 36.9[samples/s]
2025-05-29 02:14:13,345 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:14:13,345 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:14:13,345 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1580
CMC curve: Rank-1: 0.3249, Rank-5: 0.5178, Rank-10: 0.5922
=> Enter reranking
=> Results after reranking:
mAP: 0.2108
CMC curve: Rank-1: 0.3452, Rank-5: 0.5076, Rank-10: 0.5787
=> Improvement:
mAP improvement: 0.0528 (+33.44%)
Rank-1 improvement: 0.0203 (+6.25%)
2025-05-29 02:15:01,494 DeMo.train INFO: Validation Results - Epoch: 8
2025-05-29 02:15:01,494 DeMo.train INFO: mAP: 21.1%
2025-05-29 02:15:01,494 DeMo.train INFO: CMC curve, Rank-1  :34.5%
2025-05-29 02:15:01,494 DeMo.train INFO: CMC curve, Rank-5  :50.8%
2025-05-29 02:15:01,494 DeMo.train INFO: CMC curve, Rank-10 :57.9%
2025-05-29 02:15:01,494 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:15:01,760 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:15:01,761 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:15:01,761 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2751
CMC curve: Rank-1: 0.4399, Rank-5: 0.6413, Rank-10: 0.7293
=> Enter reranking
=> Results after reranking:
mAP: 0.3607
CMC curve: Rank-1: 0.4755, Rank-5: 0.6261, Rank-10: 0.7039
=> Improvement:
mAP improvement: 0.0856 (+31.12%)
Rank-1 improvement: 0.0355 (+8.08%)
2025-05-29 02:15:51,862 DeMo.train INFO: Validation Results - Epoch: 8
2025-05-29 02:15:51,862 DeMo.train INFO: mAP: 36.1%
2025-05-29 02:15:51,862 DeMo.train INFO: CMC curve, Rank-1  :47.5%
2025-05-29 02:15:51,862 DeMo.train INFO: CMC curve, Rank-5  :62.6%
2025-05-29 02:15:51,862 DeMo.train INFO: CMC curve, Rank-10 :70.4%
2025-05-29 02:15:51,862 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:15:52,788 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:15:52,788 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:15:52,788 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2793
CMC curve: Rank-1: 0.4450, Rank-5: 0.6616, Rank-10: 0.7259
=> Enter reranking
=> Results after reranking:
mAP: 0.3627
CMC curve: Rank-1: 0.4755, Rank-5: 0.6277, Rank-10: 0.7090
=> Improvement:
mAP improvement: 0.0834 (+29.88%)
Rank-1 improvement: 0.0305 (+6.84%)
2025-05-29 02:16:34,038 DeMo.train INFO: Validation Results - Epoch: 8
2025-05-29 02:16:34,038 DeMo.train INFO: mAP: 36.3%
2025-05-29 02:16:34,038 DeMo.train INFO: CMC curve, Rank-1  :47.5%
2025-05-29 02:16:34,038 DeMo.train INFO: CMC curve, Rank-5  :62.8%
2025-05-29 02:16:34,038 DeMo.train INFO: CMC curve, Rank-10 :70.9%
2025-05-29 02:16:34,038 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:16:34,857 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:16:34,857 DeMo.train INFO: Best mAP: 38.1%
2025-05-29 02:16:34,857 DeMo.train INFO: Best Rank-1: 50.3%
2025-05-29 02:16:34,857 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 02:16:34,857 DeMo.train INFO: Best Rank-10: 73.8%
2025-05-29 02:16:34,857 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:16:51,369 DeMo.train INFO: Epoch[9] Iteration[10/16] Loss: 6.913, Acc: 0.933, Base Lr: 3.18e-04
2025-05-29 02:16:55,733 DeMo.train INFO: Epoch 9 done. Time per batch: 1.491[s] Speed: 42.9[samples/s]
2025-05-29 02:16:55,736 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:16:55,736 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:16:55,737 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1698
CMC curve: Rank-1: 0.3367, Rank-5: 0.5448, Rank-10: 0.6261
=> Enter reranking
=> Results after reranking:
mAP: 0.2305
CMC curve: Rank-1: 0.3790, Rank-5: 0.5415, Rank-10: 0.6024
=> Improvement:
mAP improvement: 0.0607 (+35.77%)
Rank-1 improvement: 0.0423 (+12.56%)
2025-05-29 02:17:52,024 DeMo.train INFO: Validation Results - Epoch: 9
2025-05-29 02:17:52,024 DeMo.train INFO: mAP: 23.1%
2025-05-29 02:17:52,024 DeMo.train INFO: CMC curve, Rank-1  :37.9%
2025-05-29 02:17:52,024 DeMo.train INFO: CMC curve, Rank-5  :54.1%
2025-05-29 02:17:52,024 DeMo.train INFO: CMC curve, Rank-10 :60.2%
2025-05-29 02:17:52,024 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:17:53,150 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:17:53,151 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:17:53,151 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2758
CMC curve: Rank-1: 0.4569, Rank-5: 0.6734, Rank-10: 0.7479
=> Enter reranking
=> Results after reranking:
mAP: 0.3722
CMC curve: Rank-1: 0.4788, Rank-5: 0.6616, Rank-10: 0.7208
=> Improvement:
mAP improvement: 0.0964 (+34.95%)
Rank-1 improvement: 0.0220 (+4.81%)
2025-05-29 02:18:43,063 DeMo.train INFO: Validation Results - Epoch: 9
2025-05-29 02:18:43,063 DeMo.train INFO: mAP: 37.2%
2025-05-29 02:18:43,063 DeMo.train INFO: CMC curve, Rank-1  :47.9%
2025-05-29 02:18:43,063 DeMo.train INFO: CMC curve, Rank-5  :66.2%
2025-05-29 02:18:43,064 DeMo.train INFO: CMC curve, Rank-10 :72.1%
2025-05-29 02:18:43,064 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:18:43,968 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:18:43,968 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:18:43,968 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2791
CMC curve: Rank-1: 0.4552, Rank-5: 0.6734, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.3798
CMC curve: Rank-1: 0.4975, Rank-5: 0.6616, Rank-10: 0.7327
=> Improvement:
mAP improvement: 0.1007 (+36.07%)
Rank-1 improvement: 0.0423 (+9.29%)
2025-05-29 02:19:30,314 DeMo.train INFO: Validation Results - Epoch: 9
2025-05-29 02:19:30,315 DeMo.train INFO: mAP: 38.0%
2025-05-29 02:19:30,315 DeMo.train INFO: CMC curve, Rank-1  :49.7%
2025-05-29 02:19:30,315 DeMo.train INFO: CMC curve, Rank-5  :66.2%
2025-05-29 02:19:30,315 DeMo.train INFO: CMC curve, Rank-10 :73.3%
2025-05-29 02:19:30,315 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:19:31,121 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:19:31,122 DeMo.train INFO: Best mAP: 38.1%
2025-05-29 02:19:31,122 DeMo.train INFO: Best Rank-1: 50.3%
2025-05-29 02:19:31,122 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 02:19:31,122 DeMo.train INFO: Best Rank-10: 73.8%
2025-05-29 02:19:31,122 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:19:47,526 DeMo.train INFO: Epoch[10] Iteration[10/16] Loss: 6.704, Acc: 0.966, Base Lr: 3.17e-04
2025-05-29 02:19:52,426 DeMo.train INFO: Epoch 10 done. Time per batch: 1.522[s] Speed: 42.1[samples/s]
2025-05-29 02:19:52,430 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:19:52,430 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:19:52,430 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1730
CMC curve: Rank-1: 0.3503, Rank-5: 0.5516, Rank-10: 0.6311
=> Enter reranking
=> Results after reranking:
mAP: 0.2222
CMC curve: Rank-1: 0.3689, Rank-5: 0.5296, Rank-10: 0.5990
=> Improvement:
mAP improvement: 0.0492 (+28.46%)
Rank-1 improvement: 0.0186 (+5.31%)
2025-05-29 02:20:44,361 DeMo.train INFO: Validation Results - Epoch: 10
2025-05-29 02:20:44,361 DeMo.train INFO: mAP: 22.2%
2025-05-29 02:20:44,361 DeMo.train INFO: CMC curve, Rank-1  :36.9%
2025-05-29 02:20:44,361 DeMo.train INFO: CMC curve, Rank-5  :53.0%
2025-05-29 02:20:44,362 DeMo.train INFO: CMC curve, Rank-10 :59.9%
2025-05-29 02:20:44,362 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:20:45,726 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:20:45,726 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:20:45,726 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2849
CMC curve: Rank-1: 0.4602, Rank-5: 0.6734, Rank-10: 0.7411
=> Enter reranking
=> Results after reranking:
mAP: 0.3821
CMC curve: Rank-1: 0.4839, Rank-5: 0.6650, Rank-10: 0.7445
=> Improvement:
mAP improvement: 0.0972 (+34.11%)
Rank-1 improvement: 0.0237 (+5.15%)
2025-05-29 02:21:34,081 DeMo.train INFO: Validation Results - Epoch: 10
2025-05-29 02:21:34,081 DeMo.train INFO: mAP: 38.2%
2025-05-29 02:21:34,081 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-05-29 02:21:34,081 DeMo.train INFO: CMC curve, Rank-5  :66.5%
2025-05-29 02:21:34,081 DeMo.train INFO: CMC curve, Rank-10 :74.5%
2025-05-29 02:21:34,081 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:21:34,975 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:21:34,976 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:21:34,976 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2886
CMC curve: Rank-1: 0.4687, Rank-5: 0.6853, Rank-10: 0.7428
=> Enter reranking
=> Results after reranking:
mAP: 0.3817
CMC curve: Rank-1: 0.4788, Rank-5: 0.6667, Rank-10: 0.7394
=> Improvement:
mAP improvement: 0.0931 (+32.26%)
Rank-1 improvement: 0.0102 (+2.17%)
2025-05-29 02:22:25,804 DeMo.train INFO: Validation Results - Epoch: 10
2025-05-29 02:22:25,804 DeMo.train INFO: mAP: 38.2%
2025-05-29 02:22:25,804 DeMo.train INFO: CMC curve, Rank-1  :47.9%
2025-05-29 02:22:25,804 DeMo.train INFO: CMC curve, Rank-5  :66.7%
2025-05-29 02:22:25,804 DeMo.train INFO: CMC curve, Rank-10 :73.9%
2025-05-29 02:22:25,804 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:22:34,344 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:22:34,344 DeMo.train INFO: Best mAP: 38.2%
2025-05-29 02:22:34,344 DeMo.train INFO: Best Rank-1: 47.9%
2025-05-29 02:22:34,344 DeMo.train INFO: Best Rank-5: 66.7%
2025-05-29 02:22:34,344 DeMo.train INFO: Best Rank-10: 73.9%
2025-05-29 02:22:34,344 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:22:51,453 DeMo.train INFO: Epoch[11] Iteration[10/16] Loss: 6.531, Acc: 0.966, Base Lr: 3.10e-04
2025-05-29 02:22:56,355 DeMo.train INFO: Epoch 11 done. Time per batch: 1.572[s] Speed: 40.7[samples/s]
2025-05-29 02:22:56,359 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:22:56,359 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:22:56,359 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1805
CMC curve: Rank-1: 0.3435, Rank-5: 0.5567, Rank-10: 0.6481
=> Enter reranking
=> Results after reranking:
mAP: 0.2378
CMC curve: Rank-1: 0.3790, Rank-5: 0.5465, Rank-10: 0.6142
=> Improvement:
mAP improvement: 0.0573 (+31.75%)
Rank-1 improvement: 0.0355 (+10.34%)
2025-05-29 02:23:47,912 DeMo.train INFO: Validation Results - Epoch: 11
2025-05-29 02:23:47,912 DeMo.train INFO: mAP: 23.8%
2025-05-29 02:23:47,912 DeMo.train INFO: CMC curve, Rank-1  :37.9%
2025-05-29 02:23:47,913 DeMo.train INFO: CMC curve, Rank-5  :54.7%
2025-05-29 02:23:47,913 DeMo.train INFO: CMC curve, Rank-10 :61.4%
2025-05-29 02:23:47,913 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:23:49,028 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:23:49,029 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:23:49,029 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2816
CMC curve: Rank-1: 0.4636, Rank-5: 0.6701, Rank-10: 0.7259
=> Enter reranking
=> Results after reranking:
mAP: 0.3686
CMC curve: Rank-1: 0.4839, Rank-5: 0.6294, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.0870 (+30.91%)
Rank-1 improvement: 0.0203 (+4.38%)
2025-05-29 02:24:38,969 DeMo.train INFO: Validation Results - Epoch: 11
2025-05-29 02:24:38,969 DeMo.train INFO: mAP: 36.9%
2025-05-29 02:24:38,969 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-05-29 02:24:38,969 DeMo.train INFO: CMC curve, Rank-5  :62.9%
2025-05-29 02:24:38,969 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 02:24:38,969 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:24:38,976 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:24:38,976 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:24:38,976 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2880
CMC curve: Rank-1: 0.4721, Rank-5: 0.6684, Rank-10: 0.7411
=> Enter reranking
=> Results after reranking:
mAP: 0.3719
CMC curve: Rank-1: 0.4772, Rank-5: 0.6430, Rank-10: 0.7022
=> Improvement:
mAP improvement: 0.0839 (+29.13%)
Rank-1 improvement: 0.0051 (+1.08%)
2025-05-29 02:25:27,394 DeMo.train INFO: Validation Results - Epoch: 11
2025-05-29 02:25:27,394 DeMo.train INFO: mAP: 37.2%
2025-05-29 02:25:27,394 DeMo.train INFO: CMC curve, Rank-1  :47.7%
2025-05-29 02:25:27,394 DeMo.train INFO: CMC curve, Rank-5  :64.3%
2025-05-29 02:25:27,394 DeMo.train INFO: CMC curve, Rank-10 :70.2%
2025-05-29 02:25:27,394 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:25:28,143 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:25:28,144 DeMo.train INFO: Best mAP: 38.2%
2025-05-29 02:25:28,144 DeMo.train INFO: Best Rank-1: 47.9%
2025-05-29 02:25:28,144 DeMo.train INFO: Best Rank-5: 66.7%
2025-05-29 02:25:28,144 DeMo.train INFO: Best Rank-10: 73.9%
2025-05-29 02:25:28,144 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:25:37,895 DeMo.train INFO: Epoch[12] Iteration[10/16] Loss: 6.404, Acc: 0.981, Base Lr: 3.03e-04
2025-05-29 02:25:42,723 DeMo.train INFO: Epoch 12 done. Time per batch: 1.041[s] Speed: 61.5[samples/s]
2025-05-29 02:25:42,727 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:25:42,727 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:25:42,727 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1857
CMC curve: Rank-1: 0.3638, Rank-5: 0.5635, Rank-10: 0.6328
=> Enter reranking
=> Results after reranking:
mAP: 0.2427
CMC curve: Rank-1: 0.3909, Rank-5: 0.5431, Rank-10: 0.6125
=> Improvement:
mAP improvement: 0.0569 (+30.66%)
Rank-1 improvement: 0.0271 (+7.44%)
2025-05-29 02:26:35,604 DeMo.train INFO: Validation Results - Epoch: 12
2025-05-29 02:26:35,604 DeMo.train INFO: mAP: 24.3%
2025-05-29 02:26:35,604 DeMo.train INFO: CMC curve, Rank-1  :39.1%
2025-05-29 02:26:35,604 DeMo.train INFO: CMC curve, Rank-5  :54.3%
2025-05-29 02:26:35,605 DeMo.train INFO: CMC curve, Rank-10 :61.3%
2025-05-29 02:26:35,605 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:26:36,819 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:26:36,820 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:26:36,820 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2829
CMC curve: Rank-1: 0.4653, Rank-5: 0.6650, Rank-10: 0.7462
=> Enter reranking
=> Results after reranking:
mAP: 0.3664
CMC curve: Rank-1: 0.4585, Rank-5: 0.6582, Rank-10: 0.7310
=> Improvement:
mAP improvement: 0.0835 (+29.52%)
Rank-1 improvement: -0.0068 (-1.45%)
2025-05-29 02:27:29,843 DeMo.train INFO: Validation Results - Epoch: 12
2025-05-29 02:27:29,844 DeMo.train INFO: mAP: 36.6%
2025-05-29 02:27:29,844 DeMo.train INFO: CMC curve, Rank-1  :45.9%
2025-05-29 02:27:29,844 DeMo.train INFO: CMC curve, Rank-5  :65.8%
2025-05-29 02:27:29,844 DeMo.train INFO: CMC curve, Rank-10 :73.1%
2025-05-29 02:27:29,844 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:27:29,850 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:27:29,850 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:27:29,850 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2907
CMC curve: Rank-1: 0.4738, Rank-5: 0.6751, Rank-10: 0.7547
=> Enter reranking
=> Results after reranking:
mAP: 0.3796
CMC curve: Rank-1: 0.4839, Rank-5: 0.6717, Rank-10: 0.7276
=> Improvement:
mAP improvement: 0.0889 (+30.58%)
Rank-1 improvement: 0.0102 (+2.14%)
2025-05-29 02:28:18,834 DeMo.train INFO: Validation Results - Epoch: 12
2025-05-29 02:28:18,834 DeMo.train INFO: mAP: 38.0%
2025-05-29 02:28:18,834 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-05-29 02:28:18,834 DeMo.train INFO: CMC curve, Rank-5  :67.2%
2025-05-29 02:28:18,834 DeMo.train INFO: CMC curve, Rank-10 :72.8%
2025-05-29 02:28:18,834 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:28:18,848 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:28:18,848 DeMo.train INFO: Best mAP: 38.2%
2025-05-29 02:28:18,848 DeMo.train INFO: Best Rank-1: 47.9%
2025-05-29 02:28:18,848 DeMo.train INFO: Best Rank-5: 66.7%
2025-05-29 02:28:18,848 DeMo.train INFO: Best Rank-10: 73.9%
2025-05-29 02:28:18,848 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:28:36,848 DeMo.train INFO: Epoch[13] Iteration[10/16] Loss: 6.316, Acc: 0.972, Base Lr: 2.95e-04
2025-05-29 02:28:39,296 DeMo.train INFO: Epoch 13 done. Time per batch: 1.461[s] Speed: 43.8[samples/s]
2025-05-29 02:28:39,299 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:28:39,299 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:28:39,299 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1896
CMC curve: Rank-1: 0.3756, Rank-5: 0.5702, Rank-10: 0.6548
=> Enter reranking
=> Results after reranking:
mAP: 0.2447
CMC curve: Rank-1: 0.3790, Rank-5: 0.5431, Rank-10: 0.6125
=> Improvement:
mAP improvement: 0.0550 (+29.02%)
Rank-1 improvement: 0.0034 (+0.90%)
2025-05-29 02:29:17,451 DeMo.train INFO: Validation Results - Epoch: 13
2025-05-29 02:29:17,451 DeMo.train INFO: mAP: 24.5%
2025-05-29 02:29:17,451 DeMo.train INFO: CMC curve, Rank-1  :37.9%
2025-05-29 02:29:17,451 DeMo.train INFO: CMC curve, Rank-5  :54.3%
2025-05-29 02:29:17,451 DeMo.train INFO: CMC curve, Rank-10 :61.3%
2025-05-29 02:29:17,451 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:29:17,755 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:29:17,756 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:29:17,756 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2814
CMC curve: Rank-1: 0.4585, Rank-5: 0.6616, Rank-10: 0.7513
=> Enter reranking
=> Results after reranking:
mAP: 0.3635
CMC curve: Rank-1: 0.4772, Rank-5: 0.6244, Rank-10: 0.7022
=> Improvement:
mAP improvement: 0.0821 (+29.17%)
Rank-1 improvement: 0.0186 (+4.06%)
2025-05-29 02:30:10,724 DeMo.train INFO: Validation Results - Epoch: 13
2025-05-29 02:30:10,724 DeMo.train INFO: mAP: 36.4%
2025-05-29 02:30:10,724 DeMo.train INFO: CMC curve, Rank-1  :47.7%
2025-05-29 02:30:10,725 DeMo.train INFO: CMC curve, Rank-5  :62.4%
2025-05-29 02:30:10,725 DeMo.train INFO: CMC curve, Rank-10 :70.2%
2025-05-29 02:30:10,725 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:30:10,756 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:30:10,756 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:30:10,756 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2925
CMC curve: Rank-1: 0.4788, Rank-5: 0.6802, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.3821
CMC curve: Rank-1: 0.4805, Rank-5: 0.6514, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.0895 (+30.60%)
Rank-1 improvement: 0.0017 (+0.35%)
2025-05-29 02:30:58,538 DeMo.train INFO: Validation Results - Epoch: 13
2025-05-29 02:30:58,538 DeMo.train INFO: mAP: 38.2%
2025-05-29 02:30:58,538 DeMo.train INFO: CMC curve, Rank-1  :48.1%
2025-05-29 02:30:58,539 DeMo.train INFO: CMC curve, Rank-5  :65.1%
2025-05-29 02:30:58,539 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 02:30:58,539 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:31:06,327 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:31:06,327 DeMo.train INFO: Best mAP: 38.2%
2025-05-29 02:31:06,327 DeMo.train INFO: Best Rank-1: 48.1%
2025-05-29 02:31:06,327 DeMo.train INFO: Best Rank-5: 65.1%
2025-05-29 02:31:06,328 DeMo.train INFO: Best Rank-10: 71.1%
2025-05-29 02:31:06,328 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:31:20,402 DeMo.train INFO: Epoch[14] Iteration[10/16] Loss: 6.241, Acc: 0.980, Base Lr: 2.87e-04
2025-05-29 02:31:26,001 DeMo.train INFO: Epoch 14 done. Time per batch: 1.405[s] Speed: 45.5[samples/s]
2025-05-29 02:31:26,004 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:31:26,004 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:31:26,004 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.1977
CMC curve: Rank-1: 0.3892, Rank-5: 0.5668, Rank-10: 0.6633
=> Enter reranking
=> Results after reranking:
mAP: 0.2498
CMC curve: Rank-1: 0.3875, Rank-5: 0.5516, Rank-10: 0.6125
=> Improvement:
mAP improvement: 0.0521 (+26.36%)
Rank-1 improvement: -0.0017 (-0.43%)
2025-05-29 02:32:11,582 DeMo.train INFO: Validation Results - Epoch: 14
2025-05-29 02:32:11,582 DeMo.train INFO: mAP: 25.0%
2025-05-29 02:32:11,582 DeMo.train INFO: CMC curve, Rank-1  :38.7%
2025-05-29 02:32:11,582 DeMo.train INFO: CMC curve, Rank-5  :55.2%
2025-05-29 02:32:11,582 DeMo.train INFO: CMC curve, Rank-10 :61.3%
2025-05-29 02:32:11,582 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:32:12,590 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:32:12,591 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:32:12,591 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2875
CMC curve: Rank-1: 0.4619, Rank-5: 0.6768, Rank-10: 0.7428
=> Enter reranking
=> Results after reranking:
mAP: 0.3793
CMC curve: Rank-1: 0.5076, Rank-5: 0.6565, Rank-10: 0.7090
=> Improvement:
mAP improvement: 0.0919 (+31.95%)
Rank-1 improvement: 0.0457 (+9.89%)
2025-05-29 02:33:05,795 DeMo.train INFO: Validation Results - Epoch: 14
2025-05-29 02:33:05,795 DeMo.train INFO: mAP: 37.9%
2025-05-29 02:33:05,795 DeMo.train INFO: CMC curve, Rank-1  :50.8%
2025-05-29 02:33:05,795 DeMo.train INFO: CMC curve, Rank-5  :65.7%
2025-05-29 02:33:05,796 DeMo.train INFO: CMC curve, Rank-10 :70.9%
2025-05-29 02:33:05,796 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:33:06,831 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:33:06,831 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:33:06,831 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2943
CMC curve: Rank-1: 0.4704, Rank-5: 0.6802, Rank-10: 0.7462
=> Enter reranking
=> Results after reranking:
mAP: 0.3836
CMC curve: Rank-1: 0.5008, Rank-5: 0.6497, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.0892 (+30.32%)
Rank-1 improvement: 0.0305 (+6.47%)
2025-05-29 02:33:56,593 DeMo.train INFO: Validation Results - Epoch: 14
2025-05-29 02:33:56,593 DeMo.train INFO: mAP: 38.4%
2025-05-29 02:33:56,593 DeMo.train INFO: CMC curve, Rank-1  :50.1%
2025-05-29 02:33:56,593 DeMo.train INFO: CMC curve, Rank-5  :65.0%
2025-05-29 02:33:56,593 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 02:33:56,593 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:34:04,957 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:34:04,957 DeMo.train INFO: Best mAP: 38.4%
2025-05-29 02:34:04,957 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 02:34:04,957 DeMo.train INFO: Best Rank-5: 65.0%
2025-05-29 02:34:04,957 DeMo.train INFO: Best Rank-10: 71.1%
2025-05-29 02:34:04,957 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:34:14,774 DeMo.train INFO: Epoch[15] Iteration[10/16] Loss: 6.038, Acc: 0.989, Base Lr: 2.78e-04
2025-05-29 02:34:20,153 DeMo.train INFO: Epoch 15 done. Time per batch: 1.085[s] Speed: 59.0[samples/s]
2025-05-29 02:34:20,157 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:34:20,157 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:34:20,157 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2071
CMC curve: Rank-1: 0.3976, Rank-5: 0.5770, Rank-10: 0.6667
=> Enter reranking
=> Results after reranking:
mAP: 0.2691
CMC curve: Rank-1: 0.4061, Rank-5: 0.5702, Rank-10: 0.6328
=> Improvement:
mAP improvement: 0.0620 (+29.92%)
Rank-1 improvement: 0.0085 (+2.13%)
2025-05-29 02:35:11,124 DeMo.train INFO: Validation Results - Epoch: 15
2025-05-29 02:35:11,124 DeMo.train INFO: mAP: 26.9%
2025-05-29 02:35:11,125 DeMo.train INFO: CMC curve, Rank-1  :40.6%
2025-05-29 02:35:11,125 DeMo.train INFO: CMC curve, Rank-5  :57.0%
2025-05-29 02:35:11,125 DeMo.train INFO: CMC curve, Rank-10 :63.3%
2025-05-29 02:35:11,125 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:35:11,233 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:35:11,234 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:35:11,234 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2976
CMC curve: Rank-1: 0.4687, Rank-5: 0.6650, Rank-10: 0.7428
=> Enter reranking
=> Results after reranking:
mAP: 0.3894
CMC curve: Rank-1: 0.4907, Rank-5: 0.6531, Rank-10: 0.7259
=> Improvement:
mAP improvement: 0.0918 (+30.86%)
Rank-1 improvement: 0.0220 (+4.69%)
2025-05-29 02:36:06,180 DeMo.train INFO: Validation Results - Epoch: 15
2025-05-29 02:36:06,180 DeMo.train INFO: mAP: 38.9%
2025-05-29 02:36:06,180 DeMo.train INFO: CMC curve, Rank-1  :49.1%
2025-05-29 02:36:06,180 DeMo.train INFO: CMC curve, Rank-5  :65.3%
2025-05-29 02:36:06,180 DeMo.train INFO: CMC curve, Rank-10 :72.6%
2025-05-29 02:36:06,180 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:36:07,396 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:36:07,397 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:36:07,397 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3022
CMC curve: Rank-1: 0.4788, Rank-5: 0.6751, Rank-10: 0.7428
=> Enter reranking
=> Results after reranking:
mAP: 0.3913
CMC curve: Rank-1: 0.4873, Rank-5: 0.6650, Rank-10: 0.7293
=> Improvement:
mAP improvement: 0.0891 (+29.48%)
Rank-1 improvement: 0.0085 (+1.77%)
2025-05-29 02:36:57,174 DeMo.train INFO: Validation Results - Epoch: 15
2025-05-29 02:36:57,174 DeMo.train INFO: mAP: 39.1%
2025-05-29 02:36:57,174 DeMo.train INFO: CMC curve, Rank-1  :48.7%
2025-05-29 02:36:57,174 DeMo.train INFO: CMC curve, Rank-5  :66.5%
2025-05-29 02:36:57,174 DeMo.train INFO: CMC curve, Rank-10 :72.9%
2025-05-29 02:36:57,174 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:37:05,434 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:37:05,434 DeMo.train INFO: Best mAP: 39.1%
2025-05-29 02:37:05,435 DeMo.train INFO: Best Rank-1: 48.7%
2025-05-29 02:37:05,435 DeMo.train INFO: Best Rank-5: 66.5%
2025-05-29 02:37:05,435 DeMo.train INFO: Best Rank-10: 72.9%
2025-05-29 02:37:05,435 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:37:14,966 DeMo.train INFO: Epoch[16] Iteration[10/16] Loss: 5.919, Acc: 0.988, Base Lr: 2.69e-04
2025-05-29 02:37:18,896 DeMo.train INFO: Epoch 16 done. Time per batch: 0.962[s] Speed: 66.6[samples/s]
2025-05-29 02:37:18,900 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:37:18,900 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:37:18,900 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2143
CMC curve: Rank-1: 0.4044, Rank-5: 0.5922, Rank-10: 0.6751
=> Enter reranking
=> Results after reranking:
mAP: 0.2860
CMC curve: Rank-1: 0.4298, Rank-5: 0.5770, Rank-10: 0.6277
=> Improvement:
mAP improvement: 0.0717 (+33.48%)
Rank-1 improvement: 0.0254 (+6.28%)
2025-05-29 02:38:12,086 DeMo.train INFO: Validation Results - Epoch: 16
2025-05-29 02:38:12,087 DeMo.train INFO: mAP: 28.6%
2025-05-29 02:38:12,087 DeMo.train INFO: CMC curve, Rank-1  :43.0%
2025-05-29 02:38:12,087 DeMo.train INFO: CMC curve, Rank-5  :57.7%
2025-05-29 02:38:12,087 DeMo.train INFO: CMC curve, Rank-10 :62.8%
2025-05-29 02:38:12,087 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:38:12,273 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:38:12,273 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:38:12,273 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2963
CMC curve: Rank-1: 0.4856, Rank-5: 0.6616, Rank-10: 0.7327
=> Enter reranking
=> Results after reranking:
mAP: 0.3934
CMC curve: Rank-1: 0.4755, Rank-5: 0.6531, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.0971 (+32.78%)
Rank-1 improvement: -0.0102 (-2.09%)
2025-05-29 02:39:05,671 DeMo.train INFO: Validation Results - Epoch: 16
2025-05-29 02:39:05,672 DeMo.train INFO: mAP: 39.3%
2025-05-29 02:39:05,672 DeMo.train INFO: CMC curve, Rank-1  :47.5%
2025-05-29 02:39:05,672 DeMo.train INFO: CMC curve, Rank-5  :65.3%
2025-05-29 02:39:05,672 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 02:39:05,672 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:39:05,678 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:39:05,678 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:39:05,678 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3056
CMC curve: Rank-1: 0.4856, Rank-5: 0.6650, Rank-10: 0.7530
=> Enter reranking
=> Results after reranking:
mAP: 0.3991
CMC curve: Rank-1: 0.4721, Rank-5: 0.6447, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.0936 (+30.62%)
Rank-1 improvement: -0.0135 (-2.79%)
2025-05-29 02:39:58,876 DeMo.train INFO: Validation Results - Epoch: 16
2025-05-29 02:39:58,876 DeMo.train INFO: mAP: 39.9%
2025-05-29 02:39:58,876 DeMo.train INFO: CMC curve, Rank-1  :47.2%
2025-05-29 02:39:58,876 DeMo.train INFO: CMC curve, Rank-5  :64.5%
2025-05-29 02:39:58,876 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 02:39:58,876 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:40:07,052 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:40:07,052 DeMo.train INFO: Best mAP: 39.9%
2025-05-29 02:40:07,052 DeMo.train INFO: Best Rank-1: 47.2%
2025-05-29 02:40:07,052 DeMo.train INFO: Best Rank-5: 64.5%
2025-05-29 02:40:07,052 DeMo.train INFO: Best Rank-10: 70.6%
2025-05-29 02:40:07,053 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:40:20,354 DeMo.train INFO: Epoch[17] Iteration[10/16] Loss: 5.774, Acc: 0.988, Base Lr: 2.59e-04
2025-05-29 02:40:23,350 DeMo.train INFO: Epoch 17 done. Time per batch: 1.086[s] Speed: 58.9[samples/s]
2025-05-29 02:40:23,353 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:40:23,354 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:40:23,354 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2265
CMC curve: Rank-1: 0.4196, Rank-5: 0.6108, Rank-10: 0.6920
=> Enter reranking
=> Results after reranking:
mAP: 0.3039
CMC curve: Rank-1: 0.4569, Rank-5: 0.6041, Rank-10: 0.6531
=> Improvement:
mAP improvement: 0.0774 (+34.17%)
Rank-1 improvement: 0.0372 (+8.87%)
2025-05-29 02:41:19,094 DeMo.train INFO: Validation Results - Epoch: 17
2025-05-29 02:41:19,094 DeMo.train INFO: mAP: 30.4%
2025-05-29 02:41:19,094 DeMo.train INFO: CMC curve, Rank-1  :45.7%
2025-05-29 02:41:19,094 DeMo.train INFO: CMC curve, Rank-5  :60.4%
2025-05-29 02:41:19,094 DeMo.train INFO: CMC curve, Rank-10 :65.3%
2025-05-29 02:41:19,094 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:41:20,471 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:41:20,471 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:41:20,471 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2885
CMC curve: Rank-1: 0.4755, Rank-5: 0.6633, Rank-10: 0.7310
=> Enter reranking
=> Results after reranking:
mAP: 0.3691
CMC curve: Rank-1: 0.4704, Rank-5: 0.6311, Rank-10: 0.7022
=> Improvement:
mAP improvement: 0.0805 (+27.91%)
Rank-1 improvement: -0.0051 (-1.07%)
2025-05-29 02:42:13,961 DeMo.train INFO: Validation Results - Epoch: 17
2025-05-29 02:42:13,961 DeMo.train INFO: mAP: 36.9%
2025-05-29 02:42:13,961 DeMo.train INFO: CMC curve, Rank-1  :47.0%
2025-05-29 02:42:13,961 DeMo.train INFO: CMC curve, Rank-5  :63.1%
2025-05-29 02:42:13,961 DeMo.train INFO: CMC curve, Rank-10 :70.2%
2025-05-29 02:42:13,962 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:42:15,206 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:42:15,207 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:42:15,207 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2957
CMC curve: Rank-1: 0.4738, Rank-5: 0.6650, Rank-10: 0.7411
=> Enter reranking
=> Results after reranking:
mAP: 0.3848
CMC curve: Rank-1: 0.4738, Rank-5: 0.6261, Rank-10: 0.6937
=> Improvement:
mAP improvement: 0.0891 (+30.13%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 02:43:08,192 DeMo.train INFO: Validation Results - Epoch: 17
2025-05-29 02:43:08,193 DeMo.train INFO: mAP: 38.5%
2025-05-29 02:43:08,193 DeMo.train INFO: CMC curve, Rank-1  :47.4%
2025-05-29 02:43:08,193 DeMo.train INFO: CMC curve, Rank-5  :62.6%
2025-05-29 02:43:08,193 DeMo.train INFO: CMC curve, Rank-10 :69.4%
2025-05-29 02:43:08,193 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:43:09,002 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:43:09,002 DeMo.train INFO: Best mAP: 39.9%
2025-05-29 02:43:09,003 DeMo.train INFO: Best Rank-1: 47.2%
2025-05-29 02:43:09,003 DeMo.train INFO: Best Rank-5: 64.5%
2025-05-29 02:43:09,003 DeMo.train INFO: Best Rank-10: 70.6%
2025-05-29 02:43:09,003 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:43:28,264 DeMo.train INFO: Epoch[18] Iteration[10/16] Loss: 5.679, Acc: 0.989, Base Lr: 2.50e-04
2025-05-29 02:43:30,677 DeMo.train INFO: Epoch 18 done. Time per batch: 1.548[s] Speed: 41.3[samples/s]
2025-05-29 02:43:30,680 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:43:30,681 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:43:30,681 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2282
CMC curve: Rank-1: 0.4078, Rank-5: 0.6193, Rank-10: 0.6870
=> Enter reranking
=> Results after reranking:
mAP: 0.2995
CMC curve: Rank-1: 0.4484, Rank-5: 0.5973, Rank-10: 0.6565
=> Improvement:
mAP improvement: 0.0713 (+31.26%)
Rank-1 improvement: 0.0406 (+9.96%)
2025-05-29 02:44:24,748 DeMo.train INFO: Validation Results - Epoch: 18
2025-05-29 02:44:24,748 DeMo.train INFO: mAP: 29.9%
2025-05-29 02:44:24,748 DeMo.train INFO: CMC curve, Rank-1  :44.8%
2025-05-29 02:44:24,748 DeMo.train INFO: CMC curve, Rank-5  :59.7%
2025-05-29 02:44:24,748 DeMo.train INFO: CMC curve, Rank-10 :65.7%
2025-05-29 02:44:24,748 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:44:25,928 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:44:25,928 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:44:25,928 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2994
CMC curve: Rank-1: 0.4755, Rank-5: 0.6599, Rank-10: 0.7343
=> Enter reranking
=> Results after reranking:
mAP: 0.3827
CMC curve: Rank-1: 0.4805, Rank-5: 0.6684, Rank-10: 0.7327
=> Improvement:
mAP improvement: 0.0832 (+27.80%)
Rank-1 improvement: 0.0051 (+1.07%)
2025-05-29 02:45:19,233 DeMo.train INFO: Validation Results - Epoch: 18
2025-05-29 02:45:19,233 DeMo.train INFO: mAP: 38.3%
2025-05-29 02:45:19,233 DeMo.train INFO: CMC curve, Rank-1  :48.1%
2025-05-29 02:45:19,233 DeMo.train INFO: CMC curve, Rank-5  :66.8%
2025-05-29 02:45:19,233 DeMo.train INFO: CMC curve, Rank-10 :73.3%
2025-05-29 02:45:19,234 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:45:19,394 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:45:19,394 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:45:19,394 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3043
CMC curve: Rank-1: 0.4822, Rank-5: 0.6650, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.3910
CMC curve: Rank-1: 0.5025, Rank-5: 0.6734, Rank-10: 0.7310
=> Improvement:
mAP improvement: 0.0867 (+28.50%)
Rank-1 improvement: 0.0203 (+4.21%)
2025-05-29 02:46:16,124 DeMo.train INFO: Validation Results - Epoch: 18
2025-05-29 02:46:16,124 DeMo.train INFO: mAP: 39.1%
2025-05-29 02:46:16,124 DeMo.train INFO: CMC curve, Rank-1  :50.3%
2025-05-29 02:46:16,124 DeMo.train INFO: CMC curve, Rank-5  :67.3%
2025-05-29 02:46:16,124 DeMo.train INFO: CMC curve, Rank-10 :73.1%
2025-05-29 02:46:16,125 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:46:16,560 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:46:16,560 DeMo.train INFO: Best mAP: 39.9%
2025-05-29 02:46:16,560 DeMo.train INFO: Best Rank-1: 47.2%
2025-05-29 02:46:16,561 DeMo.train INFO: Best Rank-5: 64.5%
2025-05-29 02:46:16,561 DeMo.train INFO: Best Rank-10: 70.6%
2025-05-29 02:46:16,561 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:46:34,872 DeMo.train INFO: Epoch[19] Iteration[10/16] Loss: 5.570, Acc: 0.986, Base Lr: 2.40e-04
2025-05-29 02:46:40,525 DeMo.train INFO: Epoch 19 done. Time per batch: 1.712[s] Speed: 37.4[samples/s]
2025-05-29 02:46:40,529 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:46:40,529 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:46:40,529 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2324
CMC curve: Rank-1: 0.4129, Rank-5: 0.6142, Rank-10: 0.7090
=> Enter reranking
=> Results after reranking:
mAP: 0.3039
CMC curve: Rank-1: 0.4365, Rank-5: 0.6041, Rank-10: 0.6582
=> Improvement:
mAP improvement: 0.0715 (+30.77%)
Rank-1 improvement: 0.0237 (+5.74%)
2025-05-29 02:47:29,957 DeMo.train INFO: Validation Results - Epoch: 19
2025-05-29 02:47:29,957 DeMo.train INFO: mAP: 30.4%
2025-05-29 02:47:29,957 DeMo.train INFO: CMC curve, Rank-1  :43.7%
2025-05-29 02:47:29,957 DeMo.train INFO: CMC curve, Rank-5  :60.4%
2025-05-29 02:47:29,957 DeMo.train INFO: CMC curve, Rank-10 :65.8%
2025-05-29 02:47:29,957 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:47:31,306 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:47:31,307 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:47:31,307 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2998
CMC curve: Rank-1: 0.4839, Rank-5: 0.6819, Rank-10: 0.7479
=> Enter reranking
=> Results after reranking:
mAP: 0.3926
CMC curve: Rank-1: 0.4805, Rank-5: 0.6717, Rank-10: 0.7411
=> Improvement:
mAP improvement: 0.0929 (+30.99%)
Rank-1 improvement: -0.0034 (-0.70%)
2025-05-29 02:48:09,065 DeMo.train INFO: Validation Results - Epoch: 19
2025-05-29 02:48:09,065 DeMo.train INFO: mAP: 39.3%
2025-05-29 02:48:09,065 DeMo.train INFO: CMC curve, Rank-1  :48.1%
2025-05-29 02:48:09,065 DeMo.train INFO: CMC curve, Rank-5  :67.2%
2025-05-29 02:48:09,065 DeMo.train INFO: CMC curve, Rank-10 :74.1%
2025-05-29 02:48:09,065 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:48:09,454 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:48:09,455 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:48:09,455 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3092
CMC curve: Rank-1: 0.5008, Rank-5: 0.6751, Rank-10: 0.7563
=> Enter reranking
=> Results after reranking:
mAP: 0.4057
CMC curve: Rank-1: 0.5059, Rank-5: 0.6836, Rank-10: 0.7276
=> Improvement:
mAP improvement: 0.0965 (+31.20%)
Rank-1 improvement: 0.0051 (+1.01%)
2025-05-29 02:49:02,354 DeMo.train INFO: Validation Results - Epoch: 19
2025-05-29 02:49:02,354 DeMo.train INFO: mAP: 40.6%
2025-05-29 02:49:02,354 DeMo.train INFO: CMC curve, Rank-1  :50.6%
2025-05-29 02:49:02,354 DeMo.train INFO: CMC curve, Rank-5  :68.4%
2025-05-29 02:49:02,354 DeMo.train INFO: CMC curve, Rank-10 :72.8%
2025-05-29 02:49:02,354 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:49:10,419 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:49:10,419 DeMo.train INFO: Best mAP: 40.6%
2025-05-29 02:49:10,419 DeMo.train INFO: Best Rank-1: 50.6%
2025-05-29 02:49:10,419 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 02:49:10,419 DeMo.train INFO: Best Rank-10: 72.8%
2025-05-29 02:49:10,419 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:49:20,236 DeMo.train INFO: Epoch[20] Iteration[10/16] Loss: 5.413, Acc: 0.995, Base Lr: 2.29e-04
2025-05-29 02:49:25,055 DeMo.train INFO: Epoch 20 done. Time per batch: 1.045[s] Speed: 61.2[samples/s]
2025-05-29 02:49:25,058 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:49:25,059 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:49:25,059 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2346
CMC curve: Rank-1: 0.4298, Rank-5: 0.6277, Rank-10: 0.7039
=> Enter reranking
=> Results after reranking:
mAP: 0.3120
CMC curve: Rank-1: 0.4653, Rank-5: 0.5956, Rank-10: 0.6650
=> Improvement:
mAP improvement: 0.0774 (+33.01%)
Rank-1 improvement: 0.0355 (+8.27%)
2025-05-29 02:50:16,203 DeMo.train INFO: Validation Results - Epoch: 20
2025-05-29 02:50:16,203 DeMo.train INFO: mAP: 31.2%
2025-05-29 02:50:16,203 DeMo.train INFO: CMC curve, Rank-1  :46.5%
2025-05-29 02:50:16,204 DeMo.train INFO: CMC curve, Rank-5  :59.6%
2025-05-29 02:50:16,204 DeMo.train INFO: CMC curve, Rank-10 :66.5%
2025-05-29 02:50:16,204 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:50:17,087 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:50:17,087 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:50:17,088 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2879
CMC curve: Rank-1: 0.4822, Rank-5: 0.6717, Rank-10: 0.7360
=> Enter reranking
=> Results after reranking:
mAP: 0.3753
CMC curve: Rank-1: 0.4788, Rank-5: 0.6430, Rank-10: 0.7022
=> Improvement:
mAP improvement: 0.0874 (+30.35%)
Rank-1 improvement: -0.0034 (-0.70%)
2025-05-29 02:51:03,281 DeMo.train INFO: Validation Results - Epoch: 20
2025-05-29 02:51:03,282 DeMo.train INFO: mAP: 37.5%
2025-05-29 02:51:03,282 DeMo.train INFO: CMC curve, Rank-1  :47.9%
2025-05-29 02:51:03,282 DeMo.train INFO: CMC curve, Rank-5  :64.3%
2025-05-29 02:51:03,282 DeMo.train INFO: CMC curve, Rank-10 :70.2%
2025-05-29 02:51:03,282 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:51:03,301 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:51:03,302 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:51:03,302 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2963
CMC curve: Rank-1: 0.4839, Rank-5: 0.6887, Rank-10: 0.7462
=> Enter reranking
=> Results after reranking:
mAP: 0.3888
CMC curve: Rank-1: 0.4839, Rank-5: 0.6599, Rank-10: 0.7090
=> Improvement:
mAP improvement: 0.0925 (+31.21%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 02:51:56,492 DeMo.train INFO: Validation Results - Epoch: 20
2025-05-29 02:51:56,493 DeMo.train INFO: mAP: 38.9%
2025-05-29 02:51:56,493 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-05-29 02:51:56,493 DeMo.train INFO: CMC curve, Rank-5  :66.0%
2025-05-29 02:51:56,493 DeMo.train INFO: CMC curve, Rank-10 :70.9%
2025-05-29 02:51:56,493 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:51:56,824 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:51:56,824 DeMo.train INFO: Best mAP: 40.6%
2025-05-29 02:51:56,824 DeMo.train INFO: Best Rank-1: 50.6%
2025-05-29 02:51:56,824 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 02:51:56,824 DeMo.train INFO: Best Rank-10: 72.8%
2025-05-29 02:51:56,824 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:52:14,760 DeMo.train INFO: Epoch[21] Iteration[10/16] Loss: 5.348, Acc: 0.994, Base Lr: 2.19e-04
2025-05-29 02:52:19,257 DeMo.train INFO: Epoch 21 done. Time per batch: 1.602[s] Speed: 39.9[samples/s]
2025-05-29 02:52:19,260 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:52:19,260 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:52:19,260 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2393
CMC curve: Rank-1: 0.4196, Rank-5: 0.6294, Rank-10: 0.7124
=> Enter reranking
=> Results after reranking:
mAP: 0.3203
CMC curve: Rank-1: 0.4670, Rank-5: 0.5888, Rank-10: 0.6582
=> Improvement:
mAP improvement: 0.0810 (+33.87%)
Rank-1 improvement: 0.0474 (+11.29%)
2025-05-29 02:53:10,933 DeMo.train INFO: Validation Results - Epoch: 21
2025-05-29 02:53:10,933 DeMo.train INFO: mAP: 32.0%
2025-05-29 02:53:10,933 DeMo.train INFO: CMC curve, Rank-1  :46.7%
2025-05-29 02:53:10,933 DeMo.train INFO: CMC curve, Rank-5  :58.9%
2025-05-29 02:53:10,933 DeMo.train INFO: CMC curve, Rank-10 :65.8%
2025-05-29 02:53:10,933 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:53:12,050 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:53:12,050 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:53:12,050 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2855
CMC curve: Rank-1: 0.4738, Rank-5: 0.6785, Rank-10: 0.7394
=> Enter reranking
=> Results after reranking:
mAP: 0.3841
CMC curve: Rank-1: 0.4772, Rank-5: 0.6684, Rank-10: 0.7140
=> Improvement:
mAP improvement: 0.0986 (+34.53%)
Rank-1 improvement: 0.0034 (+0.71%)
2025-05-29 02:54:08,726 DeMo.train INFO: Validation Results - Epoch: 21
2025-05-29 02:54:08,727 DeMo.train INFO: mAP: 38.4%
2025-05-29 02:54:08,727 DeMo.train INFO: CMC curve, Rank-1  :47.7%
2025-05-29 02:54:08,727 DeMo.train INFO: CMC curve, Rank-5  :66.8%
2025-05-29 02:54:08,727 DeMo.train INFO: CMC curve, Rank-10 :71.4%
2025-05-29 02:54:08,727 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:54:09,293 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:54:09,293 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:54:09,293 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2973
CMC curve: Rank-1: 0.4890, Rank-5: 0.6870, Rank-10: 0.7513
=> Enter reranking
=> Results after reranking:
mAP: 0.3974
CMC curve: Rank-1: 0.4890, Rank-5: 0.6599, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.1001 (+33.67%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 02:55:02,707 DeMo.train INFO: Validation Results - Epoch: 21
2025-05-29 02:55:02,707 DeMo.train INFO: mAP: 39.7%
2025-05-29 02:55:02,708 DeMo.train INFO: CMC curve, Rank-1  :48.9%
2025-05-29 02:55:02,708 DeMo.train INFO: CMC curve, Rank-5  :66.0%
2025-05-29 02:55:02,708 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 02:55:02,708 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:55:03,158 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:55:03,158 DeMo.train INFO: Best mAP: 40.6%
2025-05-29 02:55:03,158 DeMo.train INFO: Best Rank-1: 50.6%
2025-05-29 02:55:03,158 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 02:55:03,158 DeMo.train INFO: Best Rank-10: 72.8%
2025-05-29 02:55:03,159 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:55:21,152 DeMo.train INFO: Epoch[22] Iteration[10/16] Loss: 5.318, Acc: 0.994, Base Lr: 2.08e-04
2025-05-29 02:55:26,775 DeMo.train INFO: Epoch 22 done. Time per batch: 1.687[s] Speed: 37.9[samples/s]
2025-05-29 02:55:26,778 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:55:26,778 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:55:26,778 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2398
CMC curve: Rank-1: 0.4450, Rank-5: 0.6176, Rank-10: 0.7039
=> Enter reranking
=> Results after reranking:
mAP: 0.3151
CMC curve: Rank-1: 0.4552, Rank-5: 0.6074, Rank-10: 0.6481
=> Improvement:
mAP improvement: 0.0753 (+31.42%)
Rank-1 improvement: 0.0102 (+2.28%)
2025-05-29 02:56:15,761 DeMo.train INFO: Validation Results - Epoch: 22
2025-05-29 02:56:15,761 DeMo.train INFO: mAP: 31.5%
2025-05-29 02:56:15,761 DeMo.train INFO: CMC curve, Rank-1  :45.5%
2025-05-29 02:56:15,761 DeMo.train INFO: CMC curve, Rank-5  :60.7%
2025-05-29 02:56:15,761 DeMo.train INFO: CMC curve, Rank-10 :64.8%
2025-05-29 02:56:15,761 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:56:16,775 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:56:16,775 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:56:16,775 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2893
CMC curve: Rank-1: 0.4619, Rank-5: 0.6650, Rank-10: 0.7293
=> Enter reranking
=> Results after reranking:
mAP: 0.3995
CMC curve: Rank-1: 0.5059, Rank-5: 0.6497, Rank-10: 0.7242
=> Improvement:
mAP improvement: 0.1102 (+38.07%)
Rank-1 improvement: 0.0440 (+9.52%)
2025-05-29 02:57:04,944 DeMo.train INFO: Validation Results - Epoch: 22
2025-05-29 02:57:04,944 DeMo.train INFO: mAP: 39.9%
2025-05-29 02:57:04,944 DeMo.train INFO: CMC curve, Rank-1  :50.6%
2025-05-29 02:57:04,944 DeMo.train INFO: CMC curve, Rank-5  :65.0%
2025-05-29 02:57:04,944 DeMo.train INFO: CMC curve, Rank-10 :72.4%
2025-05-29 02:57:04,945 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:57:06,186 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:57:06,186 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 02:57:06,186 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2970
CMC curve: Rank-1: 0.4687, Rank-5: 0.6734, Rank-10: 0.7428
=> Enter reranking
=> Results after reranking:
mAP: 0.4064
CMC curve: Rank-1: 0.5059, Rank-5: 0.6650, Rank-10: 0.7242
=> Improvement:
mAP improvement: 0.1094 (+36.83%)
Rank-1 improvement: 0.0372 (+7.94%)
2025-05-29 02:57:53,834 DeMo.train INFO: Validation Results - Epoch: 22
2025-05-29 02:57:53,834 DeMo.train INFO: mAP: 40.6%
2025-05-29 02:57:53,834 DeMo.train INFO: CMC curve, Rank-1  :50.6%
2025-05-29 02:57:53,835 DeMo.train INFO: CMC curve, Rank-5  :66.5%
2025-05-29 02:57:53,835 DeMo.train INFO: CMC curve, Rank-10 :72.4%
2025-05-29 02:57:53,835 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:58:02,750 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:58:02,751 DeMo.train INFO: Best mAP: 40.6%
2025-05-29 02:58:02,751 DeMo.train INFO: Best Rank-1: 50.6%
2025-05-29 02:58:02,751 DeMo.train INFO: Best Rank-5: 66.5%
2025-05-29 02:58:02,751 DeMo.train INFO: Best Rank-10: 72.4%
2025-05-29 02:58:02,751 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:58:21,345 DeMo.train INFO: Epoch[23] Iteration[10/16] Loss: 5.144, Acc: 0.992, Base Lr: 1.97e-04
2025-05-29 02:58:28,297 DeMo.train INFO: Epoch 23 done. Time per batch: 1.703[s] Speed: 37.6[samples/s]
2025-05-29 02:58:28,300 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:58:28,301 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 02:58:28,301 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2397
CMC curve: Rank-1: 0.4264, Rank-5: 0.6328, Rank-10: 0.6920
=> Enter reranking
=> Results after reranking:
mAP: 0.3163
CMC curve: Rank-1: 0.4382, Rank-5: 0.6125, Rank-10: 0.6785
=> Improvement:
mAP improvement: 0.0766 (+31.94%)
Rank-1 improvement: 0.0118 (+2.78%)
2025-05-29 02:59:17,587 DeMo.train INFO: Validation Results - Epoch: 23
2025-05-29 02:59:17,587 DeMo.train INFO: mAP: 31.6%
2025-05-29 02:59:17,587 DeMo.train INFO: CMC curve, Rank-1  :43.8%
2025-05-29 02:59:17,587 DeMo.train INFO: CMC curve, Rank-5  :61.3%
2025-05-29 02:59:17,587 DeMo.train INFO: CMC curve, Rank-10 :67.9%
2025-05-29 02:59:17,587 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:59:18,863 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 02:59:18,864 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 02:59:18,864 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2981
CMC curve: Rank-1: 0.4856, Rank-5: 0.6701, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.4031
CMC curve: Rank-1: 0.5008, Rank-5: 0.6717, Rank-10: 0.7293
=> Improvement:
mAP improvement: 0.1050 (+35.21%)
Rank-1 improvement: 0.0152 (+3.14%)
2025-05-29 03:00:09,541 DeMo.train INFO: Validation Results - Epoch: 23
2025-05-29 03:00:09,541 DeMo.train INFO: mAP: 40.3%
2025-05-29 03:00:09,541 DeMo.train INFO: CMC curve, Rank-1  :50.1%
2025-05-29 03:00:09,541 DeMo.train INFO: CMC curve, Rank-5  :67.2%
2025-05-29 03:00:09,541 DeMo.train INFO: CMC curve, Rank-10 :72.9%
2025-05-29 03:00:09,541 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:00:10,131 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:00:10,131 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:00:10,131 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3062
CMC curve: Rank-1: 0.4856, Rank-5: 0.6717, Rank-10: 0.7496
=> Enter reranking
=> Results after reranking:
mAP: 0.4073
CMC curve: Rank-1: 0.5144, Rank-5: 0.6734, Rank-10: 0.7327
=> Improvement:
mAP improvement: 0.1010 (+32.98%)
Rank-1 improvement: 0.0288 (+5.92%)
2025-05-29 03:01:03,434 DeMo.train INFO: Validation Results - Epoch: 23
2025-05-29 03:01:03,434 DeMo.train INFO: mAP: 40.7%
2025-05-29 03:01:03,434 DeMo.train INFO: CMC curve, Rank-1  :51.4%
2025-05-29 03:01:03,434 DeMo.train INFO: CMC curve, Rank-5  :67.3%
2025-05-29 03:01:03,434 DeMo.train INFO: CMC curve, Rank-10 :73.3%
2025-05-29 03:01:03,434 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:01:11,304 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:01:11,305 DeMo.train INFO: Best mAP: 40.7%
2025-05-29 03:01:11,305 DeMo.train INFO: Best Rank-1: 51.4%
2025-05-29 03:01:11,305 DeMo.train INFO: Best Rank-5: 67.3%
2025-05-29 03:01:11,305 DeMo.train INFO: Best Rank-10: 73.3%
2025-05-29 03:01:11,305 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:01:29,494 DeMo.train INFO: Epoch[24] Iteration[10/16] Loss: 5.070, Acc: 0.992, Base Lr: 1.86e-04
2025-05-29 03:01:35,105 DeMo.train INFO: Epoch 24 done. Time per batch: 1.700[s] Speed: 37.6[samples/s]
2025-05-29 03:01:35,109 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:01:35,109 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:01:35,109 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2442
CMC curve: Rank-1: 0.4416, Rank-5: 0.6396, Rank-10: 0.7073
=> Enter reranking
=> Results after reranking:
mAP: 0.3196
CMC curve: Rank-1: 0.4484, Rank-5: 0.6108, Rank-10: 0.6684
=> Improvement:
mAP improvement: 0.0754 (+30.89%)
Rank-1 improvement: 0.0068 (+1.53%)
2025-05-29 03:02:23,523 DeMo.train INFO: Validation Results - Epoch: 24
2025-05-29 03:02:23,523 DeMo.train INFO: mAP: 32.0%
2025-05-29 03:02:23,523 DeMo.train INFO: CMC curve, Rank-1  :44.8%
2025-05-29 03:02:23,523 DeMo.train INFO: CMC curve, Rank-5  :61.1%
2025-05-29 03:02:23,523 DeMo.train INFO: CMC curve, Rank-10 :66.8%
2025-05-29 03:02:23,523 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:02:23,814 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:02:23,814 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:02:23,814 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3004
CMC curve: Rank-1: 0.4755, Rank-5: 0.6633, Rank-10: 0.7496
=> Enter reranking
=> Results after reranking:
mAP: 0.3939
CMC curve: Rank-1: 0.4890, Rank-5: 0.6531, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.0935 (+31.12%)
Rank-1 improvement: 0.0135 (+2.85%)
2025-05-29 03:03:15,805 DeMo.train INFO: Validation Results - Epoch: 24
2025-05-29 03:03:15,806 DeMo.train INFO: mAP: 39.4%
2025-05-29 03:03:15,806 DeMo.train INFO: CMC curve, Rank-1  :48.9%
2025-05-29 03:03:15,806 DeMo.train INFO: CMC curve, Rank-5  :65.3%
2025-05-29 03:03:15,806 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 03:03:15,806 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:03:16,590 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:03:16,590 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:03:16,590 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3086
CMC curve: Rank-1: 0.4873, Rank-5: 0.6836, Rank-10: 0.7597
=> Enter reranking
=> Results after reranking:
mAP: 0.4059
CMC curve: Rank-1: 0.4975, Rank-5: 0.6650, Rank-10: 0.7157
=> Improvement:
mAP improvement: 0.0972 (+31.50%)
Rank-1 improvement: 0.0102 (+2.08%)
2025-05-29 03:03:58,390 DeMo.train INFO: Validation Results - Epoch: 24
2025-05-29 03:03:58,390 DeMo.train INFO: mAP: 40.6%
2025-05-29 03:03:58,390 DeMo.train INFO: CMC curve, Rank-1  :49.7%
2025-05-29 03:03:58,390 DeMo.train INFO: CMC curve, Rank-5  :66.5%
2025-05-29 03:03:58,390 DeMo.train INFO: CMC curve, Rank-10 :71.6%
2025-05-29 03:03:58,390 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:03:59,006 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:03:59,006 DeMo.train INFO: Best mAP: 40.7%
2025-05-29 03:03:59,006 DeMo.train INFO: Best Rank-1: 51.4%
2025-05-29 03:03:59,006 DeMo.train INFO: Best Rank-5: 67.3%
2025-05-29 03:03:59,006 DeMo.train INFO: Best Rank-10: 73.3%
2025-05-29 03:03:59,006 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:04:13,657 DeMo.train INFO: Epoch[25] Iteration[10/16] Loss: 4.941, Acc: 0.989, Base Lr: 1.75e-04
2025-05-29 03:04:18,554 DeMo.train INFO: Epoch 25 done. Time per batch: 1.396[s] Speed: 45.8[samples/s]
2025-05-29 03:04:18,558 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:04:18,558 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:04:18,558 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2458
CMC curve: Rank-1: 0.4298, Rank-5: 0.6311, Rank-10: 0.7039
=> Enter reranking
=> Results after reranking:
mAP: 0.3252
CMC curve: Rank-1: 0.4602, Rank-5: 0.6125, Rank-10: 0.6701
=> Improvement:
mAP improvement: 0.0794 (+32.32%)
Rank-1 improvement: 0.0305 (+7.09%)
2025-05-29 03:05:15,026 DeMo.train INFO: Validation Results - Epoch: 25
2025-05-29 03:05:15,026 DeMo.train INFO: mAP: 32.5%
2025-05-29 03:05:15,026 DeMo.train INFO: CMC curve, Rank-1  :46.0%
2025-05-29 03:05:15,026 DeMo.train INFO: CMC curve, Rank-5  :61.3%
2025-05-29 03:05:15,026 DeMo.train INFO: CMC curve, Rank-10 :67.0%
2025-05-29 03:05:15,026 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:05:16,321 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:05:16,322 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:05:16,322 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2968
CMC curve: Rank-1: 0.4772, Rank-5: 0.6701, Rank-10: 0.7377
=> Enter reranking
=> Results after reranking:
mAP: 0.3776
CMC curve: Rank-1: 0.4569, Rank-5: 0.6362, Rank-10: 0.6887
=> Improvement:
mAP improvement: 0.0807 (+27.21%)
Rank-1 improvement: -0.0203 (-4.26%)
2025-05-29 03:06:07,730 DeMo.train INFO: Validation Results - Epoch: 25
2025-05-29 03:06:07,730 DeMo.train INFO: mAP: 37.8%
2025-05-29 03:06:07,730 DeMo.train INFO: CMC curve, Rank-1  :45.7%
2025-05-29 03:06:07,731 DeMo.train INFO: CMC curve, Rank-5  :63.6%
2025-05-29 03:06:07,731 DeMo.train INFO: CMC curve, Rank-10 :68.9%
2025-05-29 03:06:07,731 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:06:08,450 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:06:08,450 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:06:08,450 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3062
CMC curve: Rank-1: 0.4873, Rank-5: 0.6717, Rank-10: 0.7411
=> Enter reranking
=> Results after reranking:
mAP: 0.3919
CMC curve: Rank-1: 0.4788, Rank-5: 0.6497, Rank-10: 0.7005
=> Improvement:
mAP improvement: 0.0858 (+28.02%)
Rank-1 improvement: -0.0085 (-1.74%)
2025-05-29 03:06:55,497 DeMo.train INFO: Validation Results - Epoch: 25
2025-05-29 03:06:55,497 DeMo.train INFO: mAP: 39.2%
2025-05-29 03:06:55,497 DeMo.train INFO: CMC curve, Rank-1  :47.9%
2025-05-29 03:06:55,497 DeMo.train INFO: CMC curve, Rank-5  :65.0%
2025-05-29 03:06:55,497 DeMo.train INFO: CMC curve, Rank-10 :70.1%
2025-05-29 03:06:55,498 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:06:56,375 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:06:56,375 DeMo.train INFO: Best mAP: 40.7%
2025-05-29 03:06:56,376 DeMo.train INFO: Best Rank-1: 51.4%
2025-05-29 03:06:56,376 DeMo.train INFO: Best Rank-5: 67.3%
2025-05-29 03:06:56,376 DeMo.train INFO: Best Rank-10: 73.3%
2025-05-29 03:06:56,376 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:07:12,702 DeMo.train INFO: Epoch[26] Iteration[10/16] Loss: 4.872, Acc: 1.000, Base Lr: 1.64e-04
2025-05-29 03:07:17,595 DeMo.train INFO: Epoch 26 done. Time per batch: 1.516[s] Speed: 42.2[samples/s]
2025-05-29 03:07:17,598 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:07:17,598 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:07:17,598 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2555
CMC curve: Rank-1: 0.4467, Rank-5: 0.6396, Rank-10: 0.7124
=> Enter reranking
=> Results after reranking:
mAP: 0.3273
CMC curve: Rank-1: 0.4467, Rank-5: 0.6159, Rank-10: 0.6717
=> Improvement:
mAP improvement: 0.0718 (+28.08%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 03:08:10,043 DeMo.train INFO: Validation Results - Epoch: 26
2025-05-29 03:08:10,043 DeMo.train INFO: mAP: 32.7%
2025-05-29 03:08:10,043 DeMo.train INFO: CMC curve, Rank-1  :44.7%
2025-05-29 03:08:10,043 DeMo.train INFO: CMC curve, Rank-5  :61.6%
2025-05-29 03:08:10,043 DeMo.train INFO: CMC curve, Rank-10 :67.2%
2025-05-29 03:08:10,043 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:08:11,180 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:08:11,180 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:08:11,180 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3001
CMC curve: Rank-1: 0.4738, Rank-5: 0.6633, Rank-10: 0.7360
=> Enter reranking
=> Results after reranking:
mAP: 0.4006
CMC curve: Rank-1: 0.4839, Rank-5: 0.6582, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.1005 (+33.48%)
Rank-1 improvement: 0.0102 (+2.14%)
2025-05-29 03:09:00,855 DeMo.train INFO: Validation Results - Epoch: 26
2025-05-29 03:09:00,855 DeMo.train INFO: mAP: 40.1%
2025-05-29 03:09:00,856 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-05-29 03:09:00,856 DeMo.train INFO: CMC curve, Rank-5  :65.8%
2025-05-29 03:09:00,856 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 03:09:00,856 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:09:01,189 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:09:01,189 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:09:01,189 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3096
CMC curve: Rank-1: 0.4839, Rank-5: 0.6701, Rank-10: 0.7496
=> Enter reranking
=> Results after reranking:
mAP: 0.4061
CMC curve: Rank-1: 0.4975, Rank-5: 0.6616, Rank-10: 0.7208
=> Improvement:
mAP improvement: 0.0966 (+31.20%)
Rank-1 improvement: 0.0135 (+2.80%)
2025-05-29 03:09:56,513 DeMo.train INFO: Validation Results - Epoch: 26
2025-05-29 03:09:56,513 DeMo.train INFO: mAP: 40.6%
2025-05-29 03:09:56,514 DeMo.train INFO: CMC curve, Rank-1  :49.7%
2025-05-29 03:09:56,514 DeMo.train INFO: CMC curve, Rank-5  :66.2%
2025-05-29 03:09:56,514 DeMo.train INFO: CMC curve, Rank-10 :72.1%
2025-05-29 03:09:56,514 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:09:57,447 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:09:57,448 DeMo.train INFO: Best mAP: 40.7%
2025-05-29 03:09:57,448 DeMo.train INFO: Best Rank-1: 51.4%
2025-05-29 03:09:57,448 DeMo.train INFO: Best Rank-5: 67.3%
2025-05-29 03:09:57,448 DeMo.train INFO: Best Rank-10: 73.3%
2025-05-29 03:09:57,448 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:10:06,757 DeMo.train INFO: Epoch[27] Iteration[10/16] Loss: 4.845, Acc: 0.998, Base Lr: 1.53e-04
2025-05-29 03:10:11,647 DeMo.train INFO: Epoch 27 done. Time per batch: 1.014[s] Speed: 63.1[samples/s]
2025-05-29 03:10:11,651 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:10:11,651 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:10:11,651 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2573
CMC curve: Rank-1: 0.4467, Rank-5: 0.6447, Rank-10: 0.7124
=> Enter reranking
=> Results after reranking:
mAP: 0.3390
CMC curve: Rank-1: 0.4602, Rank-5: 0.6210, Rank-10: 0.6751
=> Improvement:
mAP improvement: 0.0817 (+31.74%)
Rank-1 improvement: 0.0135 (+3.03%)
2025-05-29 03:11:04,580 DeMo.train INFO: Validation Results - Epoch: 27
2025-05-29 03:11:04,580 DeMo.train INFO: mAP: 33.9%
2025-05-29 03:11:04,580 DeMo.train INFO: CMC curve, Rank-1  :46.0%
2025-05-29 03:11:04,580 DeMo.train INFO: CMC curve, Rank-5  :62.1%
2025-05-29 03:11:04,581 DeMo.train INFO: CMC curve, Rank-10 :67.5%
2025-05-29 03:11:04,581 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:11:05,062 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:11:05,063 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:11:05,063 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3041
CMC curve: Rank-1: 0.4805, Rank-5: 0.6667, Rank-10: 0.7428
=> Enter reranking
=> Results after reranking:
mAP: 0.4092
CMC curve: Rank-1: 0.5025, Rank-5: 0.6701, Rank-10: 0.7191
=> Improvement:
mAP improvement: 0.1050 (+34.54%)
Rank-1 improvement: 0.0220 (+4.58%)
2025-05-29 03:11:58,166 DeMo.train INFO: Validation Results - Epoch: 27
2025-05-29 03:11:58,166 DeMo.train INFO: mAP: 40.9%
2025-05-29 03:11:58,166 DeMo.train INFO: CMC curve, Rank-1  :50.3%
2025-05-29 03:11:58,166 DeMo.train INFO: CMC curve, Rank-5  :67.0%
2025-05-29 03:11:58,166 DeMo.train INFO: CMC curve, Rank-10 :71.9%
2025-05-29 03:11:58,166 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:11:58,526 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:11:58,526 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:11:58,526 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3145
CMC curve: Rank-1: 0.4890, Rank-5: 0.6836, Rank-10: 0.7530
=> Enter reranking
=> Results after reranking:
mAP: 0.4149
CMC curve: Rank-1: 0.5008, Rank-5: 0.6836, Rank-10: 0.7360
=> Improvement:
mAP improvement: 0.1004 (+31.92%)
Rank-1 improvement: 0.0118 (+2.42%)
2025-05-29 03:12:47,761 DeMo.train INFO: Validation Results - Epoch: 27
2025-05-29 03:12:47,761 DeMo.train INFO: mAP: 41.5%
2025-05-29 03:12:47,761 DeMo.train INFO: CMC curve, Rank-1  :50.1%
2025-05-29 03:12:47,761 DeMo.train INFO: CMC curve, Rank-5  :68.4%
2025-05-29 03:12:47,761 DeMo.train INFO: CMC curve, Rank-10 :73.6%
2025-05-29 03:12:47,761 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:12:55,504 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:12:55,504 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:12:55,504 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:12:55,504 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:12:55,504 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:12:55,504 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:13:05,042 DeMo.train INFO: Epoch[28] Iteration[10/16] Loss: 4.812, Acc: 0.998, Base Lr: 1.42e-04
2025-05-29 03:13:07,595 DeMo.train INFO: Epoch 28 done. Time per batch: 0.864[s] Speed: 74.1[samples/s]
2025-05-29 03:13:07,599 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:13:07,599 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:13:07,599 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2574
CMC curve: Rank-1: 0.4518, Rank-5: 0.6531, Rank-10: 0.7107
=> Enter reranking
=> Results after reranking:
mAP: 0.3461
CMC curve: Rank-1: 0.4653, Rank-5: 0.6142, Rank-10: 0.6785
=> Improvement:
mAP improvement: 0.0887 (+34.47%)
Rank-1 improvement: 0.0135 (+3.00%)
2025-05-29 03:14:00,184 DeMo.train INFO: Validation Results - Epoch: 28
2025-05-29 03:14:00,185 DeMo.train INFO: mAP: 34.6%
2025-05-29 03:14:00,185 DeMo.train INFO: CMC curve, Rank-1  :46.5%
2025-05-29 03:14:00,185 DeMo.train INFO: CMC curve, Rank-5  :61.4%
2025-05-29 03:14:00,185 DeMo.train INFO: CMC curve, Rank-10 :67.9%
2025-05-29 03:14:00,185 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:14:01,613 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:14:01,613 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:14:01,613 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2994
CMC curve: Rank-1: 0.4822, Rank-5: 0.6582, Rank-10: 0.7293
=> Enter reranking
=> Results after reranking:
mAP: 0.3922
CMC curve: Rank-1: 0.4653, Rank-5: 0.6616, Rank-10: 0.7140
=> Improvement:
mAP improvement: 0.0928 (+30.99%)
Rank-1 improvement: -0.0169 (-3.51%)
2025-05-29 03:14:58,856 DeMo.train INFO: Validation Results - Epoch: 28
2025-05-29 03:14:58,857 DeMo.train INFO: mAP: 39.2%
2025-05-29 03:14:58,857 DeMo.train INFO: CMC curve, Rank-1  :46.5%
2025-05-29 03:14:58,857 DeMo.train INFO: CMC curve, Rank-5  :66.2%
2025-05-29 03:14:58,857 DeMo.train INFO: CMC curve, Rank-10 :71.4%
2025-05-29 03:14:58,857 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:14:59,437 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:14:59,437 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:14:59,437 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3107
CMC curve: Rank-1: 0.4788, Rank-5: 0.6785, Rank-10: 0.7580
=> Enter reranking
=> Results after reranking:
mAP: 0.4022
CMC curve: Rank-1: 0.4907, Rank-5: 0.6531, Rank-10: 0.7090
=> Improvement:
mAP improvement: 0.0916 (+29.48%)
Rank-1 improvement: 0.0118 (+2.47%)
2025-05-29 03:15:51,142 DeMo.train INFO: Validation Results - Epoch: 28
2025-05-29 03:15:51,143 DeMo.train INFO: mAP: 40.2%
2025-05-29 03:15:51,143 DeMo.train INFO: CMC curve, Rank-1  :49.1%
2025-05-29 03:15:51,143 DeMo.train INFO: CMC curve, Rank-5  :65.3%
2025-05-29 03:15:51,143 DeMo.train INFO: CMC curve, Rank-10 :70.9%
2025-05-29 03:15:51,143 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:15:51,661 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:15:51,661 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:15:51,661 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:15:51,661 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:15:51,661 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:15:51,661 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:16:09,696 DeMo.train INFO: Epoch[29] Iteration[10/16] Loss: 4.712, Acc: 0.994, Base Lr: 1.32e-04
2025-05-29 03:16:13,594 DeMo.train INFO: Epoch 29 done. Time per batch: 1.567[s] Speed: 40.9[samples/s]
2025-05-29 03:16:13,597 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:16:13,597 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:16:13,597 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2583
CMC curve: Rank-1: 0.4501, Rank-5: 0.6497, Rank-10: 0.7174
=> Enter reranking
=> Results after reranking:
mAP: 0.3463
CMC curve: Rank-1: 0.4755, Rank-5: 0.6176, Rank-10: 0.6802
=> Improvement:
mAP improvement: 0.0881 (+34.09%)
Rank-1 improvement: 0.0254 (+5.64%)
2025-05-29 03:17:00,056 DeMo.train INFO: Validation Results - Epoch: 29
2025-05-29 03:17:00,056 DeMo.train INFO: mAP: 34.6%
2025-05-29 03:17:00,057 DeMo.train INFO: CMC curve, Rank-1  :47.5%
2025-05-29 03:17:00,057 DeMo.train INFO: CMC curve, Rank-5  :61.8%
2025-05-29 03:17:00,057 DeMo.train INFO: CMC curve, Rank-10 :68.0%
2025-05-29 03:17:00,057 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:17:00,149 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:17:00,149 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:17:00,149 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3083
CMC curve: Rank-1: 0.4839, Rank-5: 0.6751, Rank-10: 0.7411
=> Enter reranking
=> Results after reranking:
mAP: 0.4086
CMC curve: Rank-1: 0.5025, Rank-5: 0.6717, Rank-10: 0.7242
=> Improvement:
mAP improvement: 0.1003 (+32.53%)
Rank-1 improvement: 0.0186 (+3.85%)
2025-05-29 03:17:55,584 DeMo.train INFO: Validation Results - Epoch: 29
2025-05-29 03:17:55,585 DeMo.train INFO: mAP: 40.9%
2025-05-29 03:17:55,585 DeMo.train INFO: CMC curve, Rank-1  :50.3%
2025-05-29 03:17:55,585 DeMo.train INFO: CMC curve, Rank-5  :67.2%
2025-05-29 03:17:55,585 DeMo.train INFO: CMC curve, Rank-10 :72.4%
2025-05-29 03:17:55,585 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:17:55,661 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:17:55,661 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:17:55,662 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3190
CMC curve: Rank-1: 0.4907, Rank-5: 0.6853, Rank-10: 0.7597
=> Enter reranking
=> Results after reranking:
mAP: 0.4143
CMC curve: Rank-1: 0.5127, Rank-5: 0.6650, Rank-10: 0.7293
=> Improvement:
mAP improvement: 0.0953 (+29.89%)
Rank-1 improvement: 0.0220 (+4.48%)
2025-05-29 03:18:48,372 DeMo.train INFO: Validation Results - Epoch: 29
2025-05-29 03:18:48,372 DeMo.train INFO: mAP: 41.4%
2025-05-29 03:18:48,372 DeMo.train INFO: CMC curve, Rank-1  :51.3%
2025-05-29 03:18:48,372 DeMo.train INFO: CMC curve, Rank-5  :66.5%
2025-05-29 03:18:48,372 DeMo.train INFO: CMC curve, Rank-10 :72.9%
2025-05-29 03:18:48,372 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:18:48,593 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:18:48,593 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:18:48,593 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:18:48,593 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:18:48,593 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:18:48,593 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:19:06,553 DeMo.train INFO: Epoch[30] Iteration[10/16] Loss: 4.677, Acc: 0.998, Base Lr: 1.21e-04
2025-05-29 03:19:12,155 DeMo.train INFO: Epoch 30 done. Time per batch: 1.683[s] Speed: 38.0[samples/s]
2025-05-29 03:19:12,159 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:19:12,159 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:19:12,159 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2603
CMC curve: Rank-1: 0.4518, Rank-5: 0.6464, Rank-10: 0.7174
=> Enter reranking
=> Results after reranking:
mAP: 0.3498
CMC curve: Rank-1: 0.4670, Rank-5: 0.6142, Rank-10: 0.6650
=> Improvement:
mAP improvement: 0.0894 (+34.36%)
Rank-1 improvement: 0.0152 (+3.37%)
2025-05-29 03:19:51,801 DeMo.train INFO: Validation Results - Epoch: 30
2025-05-29 03:19:51,802 DeMo.train INFO: mAP: 35.0%
2025-05-29 03:19:51,802 DeMo.train INFO: CMC curve, Rank-1  :46.7%
2025-05-29 03:19:51,802 DeMo.train INFO: CMC curve, Rank-5  :61.4%
2025-05-29 03:19:51,802 DeMo.train INFO: CMC curve, Rank-10 :66.5%
2025-05-29 03:19:51,802 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:19:52,603 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:19:52,604 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:19:52,604 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2989
CMC curve: Rank-1: 0.4738, Rank-5: 0.6667, Rank-10: 0.7513
=> Enter reranking
=> Results after reranking:
mAP: 0.3856
CMC curve: Rank-1: 0.4822, Rank-5: 0.6464, Rank-10: 0.7090
=> Improvement:
mAP improvement: 0.0867 (+28.99%)
Rank-1 improvement: 0.0085 (+1.79%)
2025-05-29 03:20:45,942 DeMo.train INFO: Validation Results - Epoch: 30
2025-05-29 03:20:45,942 DeMo.train INFO: mAP: 38.6%
2025-05-29 03:20:45,943 DeMo.train INFO: CMC curve, Rank-1  :48.2%
2025-05-29 03:20:45,943 DeMo.train INFO: CMC curve, Rank-5  :64.6%
2025-05-29 03:20:45,943 DeMo.train INFO: CMC curve, Rank-10 :70.9%
2025-05-29 03:20:45,943 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:20:45,949 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:20:45,949 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:20:45,949 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3110
CMC curve: Rank-1: 0.4839, Rank-5: 0.6768, Rank-10: 0.7563
=> Enter reranking
=> Results after reranking:
mAP: 0.3983
CMC curve: Rank-1: 0.4839, Rank-5: 0.6464, Rank-10: 0.7124
=> Improvement:
mAP improvement: 0.0872 (+28.04%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 03:21:36,130 DeMo.train INFO: Validation Results - Epoch: 30
2025-05-29 03:21:36,130 DeMo.train INFO: mAP: 39.8%
2025-05-29 03:21:36,130 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-05-29 03:21:36,130 DeMo.train INFO: CMC curve, Rank-5  :64.6%
2025-05-29 03:21:36,130 DeMo.train INFO: CMC curve, Rank-10 :71.2%
2025-05-29 03:21:36,130 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:21:36,479 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:21:36,479 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:21:36,479 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:21:36,480 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:21:36,480 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:21:36,480 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:21:54,521 DeMo.train INFO: Epoch[31] Iteration[10/16] Loss: 4.656, Acc: 0.998, Base Lr: 1.11e-04
2025-05-29 03:21:56,925 DeMo.train INFO: Epoch 31 done. Time per batch: 1.460[s] Speed: 43.8[samples/s]
2025-05-29 03:21:56,928 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:21:56,928 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:21:56,928 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2625
CMC curve: Rank-1: 0.4619, Rank-5: 0.6464, Rank-10: 0.7124
=> Enter reranking
=> Results after reranking:
mAP: 0.3508
CMC curve: Rank-1: 0.4653, Rank-5: 0.6294, Rank-10: 0.6853
=> Improvement:
mAP improvement: 0.0884 (+33.66%)
Rank-1 improvement: 0.0034 (+0.73%)
2025-05-29 03:22:57,945 DeMo.train INFO: Validation Results - Epoch: 31
2025-05-29 03:22:57,946 DeMo.train INFO: mAP: 35.1%
2025-05-29 03:22:57,946 DeMo.train INFO: CMC curve, Rank-1  :46.5%
2025-05-29 03:22:57,946 DeMo.train INFO: CMC curve, Rank-5  :62.9%
2025-05-29 03:22:57,946 DeMo.train INFO: CMC curve, Rank-10 :68.5%
2025-05-29 03:22:57,946 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:22:58,745 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:22:58,745 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:22:58,745 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2974
CMC curve: Rank-1: 0.4772, Rank-5: 0.6734, Rank-10: 0.7496
=> Enter reranking
=> Results after reranking:
mAP: 0.3856
CMC curve: Rank-1: 0.4873, Rank-5: 0.6565, Rank-10: 0.7208
=> Improvement:
mAP improvement: 0.0883 (+29.68%)
Rank-1 improvement: 0.0102 (+2.13%)
2025-05-29 03:23:51,932 DeMo.train INFO: Validation Results - Epoch: 31
2025-05-29 03:23:51,932 DeMo.train INFO: mAP: 38.6%
2025-05-29 03:23:51,933 DeMo.train INFO: CMC curve, Rank-1  :48.7%
2025-05-29 03:23:51,933 DeMo.train INFO: CMC curve, Rank-5  :65.7%
2025-05-29 03:23:51,933 DeMo.train INFO: CMC curve, Rank-10 :72.1%
2025-05-29 03:23:51,933 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:23:51,939 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:23:51,939 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:23:51,939 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3097
CMC curve: Rank-1: 0.4907, Rank-5: 0.6819, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.3926
CMC curve: Rank-1: 0.4890, Rank-5: 0.6599, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.0830 (+26.80%)
Rank-1 improvement: -0.0017 (-0.34%)
2025-05-29 03:24:48,907 DeMo.train INFO: Validation Results - Epoch: 31
2025-05-29 03:24:48,907 DeMo.train INFO: mAP: 39.3%
2025-05-29 03:24:48,907 DeMo.train INFO: CMC curve, Rank-1  :48.9%
2025-05-29 03:24:48,907 DeMo.train INFO: CMC curve, Rank-5  :66.0%
2025-05-29 03:24:48,907 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 03:24:48,907 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:24:49,453 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:24:49,454 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:24:49,454 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:24:49,454 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:24:49,454 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:24:49,454 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:25:07,639 DeMo.train INFO: Epoch[32] Iteration[10/16] Loss: 4.630, Acc: 0.994, Base Lr: 1.01e-04
2025-05-29 03:25:13,262 DeMo.train INFO: Epoch 32 done. Time per batch: 1.701[s] Speed: 37.6[samples/s]
2025-05-29 03:25:13,265 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:25:13,266 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:25:13,266 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2596
CMC curve: Rank-1: 0.4467, Rank-5: 0.6514, Rank-10: 0.7140
=> Enter reranking
=> Results after reranking:
mAP: 0.3480
CMC curve: Rank-1: 0.4704, Rank-5: 0.6328, Rank-10: 0.6937
=> Improvement:
mAP improvement: 0.0885 (+34.08%)
Rank-1 improvement: 0.0237 (+5.30%)
2025-05-29 03:26:02,349 DeMo.train INFO: Validation Results - Epoch: 32
2025-05-29 03:26:02,349 DeMo.train INFO: mAP: 34.8%
2025-05-29 03:26:02,349 DeMo.train INFO: CMC curve, Rank-1  :47.0%
2025-05-29 03:26:02,349 DeMo.train INFO: CMC curve, Rank-5  :63.3%
2025-05-29 03:26:02,349 DeMo.train INFO: CMC curve, Rank-10 :69.4%
2025-05-29 03:26:02,349 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:26:03,449 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:26:03,450 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:26:03,450 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3015
CMC curve: Rank-1: 0.4788, Rank-5: 0.6684, Rank-10: 0.7462
=> Enter reranking
=> Results after reranking:
mAP: 0.3920
CMC curve: Rank-1: 0.4958, Rank-5: 0.6548, Rank-10: 0.7174
=> Improvement:
mAP improvement: 0.0905 (+30.01%)
Rank-1 improvement: 0.0169 (+3.53%)
2025-05-29 03:26:48,153 DeMo.train INFO: Validation Results - Epoch: 32
2025-05-29 03:26:48,153 DeMo.train INFO: mAP: 39.2%
2025-05-29 03:26:48,153 DeMo.train INFO: CMC curve, Rank-1  :49.6%
2025-05-29 03:26:48,153 DeMo.train INFO: CMC curve, Rank-5  :65.5%
2025-05-29 03:26:48,153 DeMo.train INFO: CMC curve, Rank-10 :71.7%
2025-05-29 03:26:48,153 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:26:48,590 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:26:48,590 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:26:48,590 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3117
CMC curve: Rank-1: 0.4839, Rank-5: 0.6768, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.4008
CMC curve: Rank-1: 0.4941, Rank-5: 0.6548, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.0891 (+28.60%)
Rank-1 improvement: 0.0102 (+2.10%)
2025-05-29 03:27:43,835 DeMo.train INFO: Validation Results - Epoch: 32
2025-05-29 03:27:43,835 DeMo.train INFO: mAP: 40.1%
2025-05-29 03:27:43,835 DeMo.train INFO: CMC curve, Rank-1  :49.4%
2025-05-29 03:27:43,835 DeMo.train INFO: CMC curve, Rank-5  :65.5%
2025-05-29 03:27:43,835 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 03:27:43,836 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:27:45,018 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:27:45,018 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:27:45,018 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:27:45,019 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:27:45,019 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:27:45,019 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:27:52,666 DeMo.train INFO: Epoch[33] Iteration[10/16] Loss: 4.615, Acc: 1.000, Base Lr: 9.10e-05
2025-05-29 03:27:57,384 DeMo.train INFO: Epoch 33 done. Time per batch: 0.883[s] Speed: 72.5[samples/s]
2025-05-29 03:27:57,387 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:27:57,388 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:27:57,388 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2619
CMC curve: Rank-1: 0.4535, Rank-5: 0.6548, Rank-10: 0.7208
=> Enter reranking
=> Results after reranking:
mAP: 0.3465
CMC curve: Rank-1: 0.4772, Rank-5: 0.6210, Rank-10: 0.6819
=> Improvement:
mAP improvement: 0.0846 (+32.31%)
Rank-1 improvement: 0.0237 (+5.22%)
2025-05-29 03:28:49,524 DeMo.train INFO: Validation Results - Epoch: 33
2025-05-29 03:28:49,524 DeMo.train INFO: mAP: 34.7%
2025-05-29 03:28:49,525 DeMo.train INFO: CMC curve, Rank-1  :47.7%
2025-05-29 03:28:49,525 DeMo.train INFO: CMC curve, Rank-5  :62.1%
2025-05-29 03:28:49,525 DeMo.train INFO: CMC curve, Rank-10 :68.2%
2025-05-29 03:28:49,525 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:28:50,604 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:28:50,604 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:28:50,604 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2913
CMC curve: Rank-1: 0.4653, Rank-5: 0.6582, Rank-10: 0.7293
=> Enter reranking
=> Results after reranking:
mAP: 0.3736
CMC curve: Rank-1: 0.4856, Rank-5: 0.6261, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.0823 (+28.25%)
Rank-1 improvement: 0.0203 (+4.36%)
2025-05-29 03:29:37,315 DeMo.train INFO: Validation Results - Epoch: 33
2025-05-29 03:29:37,315 DeMo.train INFO: mAP: 37.4%
2025-05-29 03:29:37,316 DeMo.train INFO: CMC curve, Rank-1  :48.6%
2025-05-29 03:29:37,316 DeMo.train INFO: CMC curve, Rank-5  :62.6%
2025-05-29 03:29:37,316 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 03:29:37,316 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:29:38,541 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:29:38,541 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:29:38,541 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3021
CMC curve: Rank-1: 0.4822, Rank-5: 0.6751, Rank-10: 0.7411
=> Enter reranking
=> Results after reranking:
mAP: 0.3867
CMC curve: Rank-1: 0.4772, Rank-5: 0.6396, Rank-10: 0.7124
=> Improvement:
mAP improvement: 0.0846 (+27.99%)
Rank-1 improvement: -0.0051 (-1.05%)
2025-05-29 03:30:30,201 DeMo.train INFO: Validation Results - Epoch: 33
2025-05-29 03:30:30,201 DeMo.train INFO: mAP: 38.7%
2025-05-29 03:30:30,201 DeMo.train INFO: CMC curve, Rank-1  :47.7%
2025-05-29 03:30:30,202 DeMo.train INFO: CMC curve, Rank-5  :64.0%
2025-05-29 03:30:30,202 DeMo.train INFO: CMC curve, Rank-10 :71.2%
2025-05-29 03:30:30,202 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:30:31,266 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:30:31,266 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:30:31,267 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:30:31,267 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:30:31,267 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:30:31,267 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:30:49,332 DeMo.train INFO: Epoch[34] Iteration[10/16] Loss: 4.512, Acc: 0.998, Base Lr: 8.15e-05
2025-05-29 03:30:52,354 DeMo.train INFO: Epoch 34 done. Time per batch: 1.406[s] Speed: 45.5[samples/s]
2025-05-29 03:30:52,358 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:30:52,358 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:30:52,358 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2646
CMC curve: Rank-1: 0.4569, Rank-5: 0.6582, Rank-10: 0.7174
=> Enter reranking
=> Results after reranking:
mAP: 0.3569
CMC curve: Rank-1: 0.4873, Rank-5: 0.6277, Rank-10: 0.6887
=> Improvement:
mAP improvement: 0.0923 (+34.89%)
Rank-1 improvement: 0.0305 (+6.67%)
2025-05-29 03:31:45,580 DeMo.train INFO: Validation Results - Epoch: 34
2025-05-29 03:31:45,580 DeMo.train INFO: mAP: 35.7%
2025-05-29 03:31:45,580 DeMo.train INFO: CMC curve, Rank-1  :48.7%
2025-05-29 03:31:45,581 DeMo.train INFO: CMC curve, Rank-5  :62.8%
2025-05-29 03:31:45,581 DeMo.train INFO: CMC curve, Rank-10 :68.9%
2025-05-29 03:31:45,581 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:31:46,345 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:31:46,345 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:31:46,345 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2924
CMC curve: Rank-1: 0.4704, Rank-5: 0.6582, Rank-10: 0.7343
=> Enter reranking
=> Results after reranking:
mAP: 0.3734
CMC curve: Rank-1: 0.4704, Rank-5: 0.6379, Rank-10: 0.7157
=> Improvement:
mAP improvement: 0.0810 (+27.69%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 03:32:41,091 DeMo.train INFO: Validation Results - Epoch: 34
2025-05-29 03:32:41,092 DeMo.train INFO: mAP: 37.3%
2025-05-29 03:32:41,092 DeMo.train INFO: CMC curve, Rank-1  :47.0%
2025-05-29 03:32:41,092 DeMo.train INFO: CMC curve, Rank-5  :63.8%
2025-05-29 03:32:41,092 DeMo.train INFO: CMC curve, Rank-10 :71.6%
2025-05-29 03:32:41,092 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:32:41,599 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:32:41,599 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:32:41,599 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3045
CMC curve: Rank-1: 0.4839, Rank-5: 0.6701, Rank-10: 0.7462
=> Enter reranking
=> Results after reranking:
mAP: 0.3921
CMC curve: Rank-1: 0.4721, Rank-5: 0.6447, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.0876 (+28.78%)
Rank-1 improvement: -0.0118 (-2.45%)
2025-05-29 03:33:35,333 DeMo.train INFO: Validation Results - Epoch: 34
2025-05-29 03:33:35,333 DeMo.train INFO: mAP: 39.2%
2025-05-29 03:33:35,333 DeMo.train INFO: CMC curve, Rank-1  :47.2%
2025-05-29 03:33:35,333 DeMo.train INFO: CMC curve, Rank-5  :64.5%
2025-05-29 03:33:35,334 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 03:33:35,334 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:33:36,373 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:33:36,373 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:33:36,373 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:33:36,373 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:33:36,373 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:33:36,373 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:33:54,403 DeMo.train INFO: Epoch[35] Iteration[10/16] Loss: 4.519, Acc: 0.998, Base Lr: 7.24e-05
2025-05-29 03:33:59,925 DeMo.train INFO: Epoch 35 done. Time per batch: 1.682[s] Speed: 38.0[samples/s]
2025-05-29 03:33:59,929 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:33:59,929 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:33:59,929 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2662
CMC curve: Rank-1: 0.4636, Rank-5: 0.6650, Rank-10: 0.7191
=> Enter reranking
=> Results after reranking:
mAP: 0.3635
CMC curve: Rank-1: 0.4788, Rank-5: 0.6430, Rank-10: 0.6920
=> Improvement:
mAP improvement: 0.0972 (+36.52%)
Rank-1 improvement: 0.0152 (+3.28%)
2025-05-29 03:34:49,103 DeMo.train INFO: Validation Results - Epoch: 35
2025-05-29 03:34:49,103 DeMo.train INFO: mAP: 36.3%
2025-05-29 03:34:49,104 DeMo.train INFO: CMC curve, Rank-1  :47.9%
2025-05-29 03:34:49,104 DeMo.train INFO: CMC curve, Rank-5  :64.3%
2025-05-29 03:34:49,104 DeMo.train INFO: CMC curve, Rank-10 :69.2%
2025-05-29 03:34:49,104 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:34:49,200 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:34:49,200 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:34:49,200 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2978
CMC curve: Rank-1: 0.4755, Rank-5: 0.6599, Rank-10: 0.7394
=> Enter reranking
=> Results after reranking:
mAP: 0.3848
CMC curve: Rank-1: 0.4755, Rank-5: 0.6413, Rank-10: 0.7140
=> Improvement:
mAP improvement: 0.0870 (+29.21%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 03:35:39,727 DeMo.train INFO: Validation Results - Epoch: 35
2025-05-29 03:35:39,727 DeMo.train INFO: mAP: 38.5%
2025-05-29 03:35:39,727 DeMo.train INFO: CMC curve, Rank-1  :47.5%
2025-05-29 03:35:39,728 DeMo.train INFO: CMC curve, Rank-5  :64.1%
2025-05-29 03:35:39,728 DeMo.train INFO: CMC curve, Rank-10 :71.4%
2025-05-29 03:35:39,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:35:39,996 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:35:39,996 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:35:39,996 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3104
CMC curve: Rank-1: 0.4941, Rank-5: 0.6751, Rank-10: 0.7563
=> Enter reranking
=> Results after reranking:
mAP: 0.3991
CMC curve: Rank-1: 0.4772, Rank-5: 0.6447, Rank-10: 0.7124
=> Improvement:
mAP improvement: 0.0888 (+28.59%)
Rank-1 improvement: -0.0169 (-3.42%)
2025-05-29 03:36:28,223 DeMo.train INFO: Validation Results - Epoch: 35
2025-05-29 03:36:28,223 DeMo.train INFO: mAP: 39.9%
2025-05-29 03:36:28,223 DeMo.train INFO: CMC curve, Rank-1  :47.7%
2025-05-29 03:36:28,223 DeMo.train INFO: CMC curve, Rank-5  :64.5%
2025-05-29 03:36:28,223 DeMo.train INFO: CMC curve, Rank-10 :71.2%
2025-05-29 03:36:28,223 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:36:28,431 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:36:28,431 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:36:28,431 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:36:28,431 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:36:28,431 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:36:28,431 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:36:43,811 DeMo.train INFO: Epoch[36] Iteration[10/16] Loss: 4.499, Acc: 0.998, Base Lr: 6.37e-05
2025-05-29 03:36:49,361 DeMo.train INFO: Epoch 36 done. Time per batch: 1.495[s] Speed: 42.8[samples/s]
2025-05-29 03:36:49,365 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:36:49,365 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:36:49,365 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2648
CMC curve: Rank-1: 0.4619, Rank-5: 0.6616, Rank-10: 0.7208
=> Enter reranking
=> Results after reranking:
mAP: 0.3603
CMC curve: Rank-1: 0.4805, Rank-5: 0.6345, Rank-10: 0.6937
=> Improvement:
mAP improvement: 0.0956 (+36.10%)
Rank-1 improvement: 0.0186 (+4.03%)
2025-05-29 03:37:39,508 DeMo.train INFO: Validation Results - Epoch: 36
2025-05-29 03:37:39,508 DeMo.train INFO: mAP: 36.0%
2025-05-29 03:37:39,508 DeMo.train INFO: CMC curve, Rank-1  :48.1%
2025-05-29 03:37:39,508 DeMo.train INFO: CMC curve, Rank-5  :63.5%
2025-05-29 03:37:39,508 DeMo.train INFO: CMC curve, Rank-10 :69.4%
2025-05-29 03:37:39,509 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:37:40,788 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:37:40,788 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:37:40,788 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2968
CMC curve: Rank-1: 0.4721, Rank-5: 0.6599, Rank-10: 0.7327
=> Enter reranking
=> Results after reranking:
mAP: 0.3847
CMC curve: Rank-1: 0.4738, Rank-5: 0.6362, Rank-10: 0.7090
=> Improvement:
mAP improvement: 0.0879 (+29.61%)
Rank-1 improvement: 0.0017 (+0.36%)
2025-05-29 03:38:29,824 DeMo.train INFO: Validation Results - Epoch: 36
2025-05-29 03:38:29,824 DeMo.train INFO: mAP: 38.5%
2025-05-29 03:38:29,825 DeMo.train INFO: CMC curve, Rank-1  :47.4%
2025-05-29 03:38:29,825 DeMo.train INFO: CMC curve, Rank-5  :63.6%
2025-05-29 03:38:29,825 DeMo.train INFO: CMC curve, Rank-10 :70.9%
2025-05-29 03:38:29,825 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:38:31,211 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:38:31,212 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:38:31,212 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3102
CMC curve: Rank-1: 0.4856, Rank-5: 0.6802, Rank-10: 0.7530
=> Enter reranking
=> Results after reranking:
mAP: 0.3971
CMC curve: Rank-1: 0.4653, Rank-5: 0.6531, Rank-10: 0.7140
=> Improvement:
mAP improvement: 0.0869 (+28.02%)
Rank-1 improvement: -0.0203 (-4.18%)
2025-05-29 03:39:16,657 DeMo.train INFO: Validation Results - Epoch: 36
2025-05-29 03:39:16,657 DeMo.train INFO: mAP: 39.7%
2025-05-29 03:39:16,657 DeMo.train INFO: CMC curve, Rank-1  :46.5%
2025-05-29 03:39:16,658 DeMo.train INFO: CMC curve, Rank-5  :65.3%
2025-05-29 03:39:16,658 DeMo.train INFO: CMC curve, Rank-10 :71.4%
2025-05-29 03:39:16,658 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:39:17,812 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:39:17,812 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:39:17,812 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:39:17,813 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:39:17,813 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:39:17,813 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:39:34,400 DeMo.train INFO: Epoch[37] Iteration[10/16] Loss: 4.447, Acc: 0.998, Base Lr: 5.55e-05
2025-05-29 03:39:39,291 DeMo.train INFO: Epoch 37 done. Time per batch: 1.534[s] Speed: 41.7[samples/s]
2025-05-29 03:39:39,295 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:39:39,295 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:39:39,295 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2650
CMC curve: Rank-1: 0.4602, Rank-5: 0.6599, Rank-10: 0.7191
=> Enter reranking
=> Results after reranking:
mAP: 0.3673
CMC curve: Rank-1: 0.4924, Rank-5: 0.6413, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.1023 (+38.62%)
Rank-1 improvement: 0.0321 (+6.99%)
2025-05-29 03:40:35,884 DeMo.train INFO: Validation Results - Epoch: 37
2025-05-29 03:40:35,885 DeMo.train INFO: mAP: 36.7%
2025-05-29 03:40:35,885 DeMo.train INFO: CMC curve, Rank-1  :49.2%
2025-05-29 03:40:35,885 DeMo.train INFO: CMC curve, Rank-5  :64.1%
2025-05-29 03:40:35,885 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 03:40:35,885 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:40:36,839 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:40:36,840 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:40:36,840 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2952
CMC curve: Rank-1: 0.4619, Rank-5: 0.6548, Rank-10: 0.7276
=> Enter reranking
=> Results after reranking:
mAP: 0.3788
CMC curve: Rank-1: 0.4670, Rank-5: 0.6413, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.0836 (+28.33%)
Rank-1 improvement: 0.0051 (+1.10%)
2025-05-29 03:41:28,403 DeMo.train INFO: Validation Results - Epoch: 37
2025-05-29 03:41:28,403 DeMo.train INFO: mAP: 37.9%
2025-05-29 03:41:28,403 DeMo.train INFO: CMC curve, Rank-1  :46.7%
2025-05-29 03:41:28,403 DeMo.train INFO: CMC curve, Rank-5  :64.1%
2025-05-29 03:41:28,403 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 03:41:28,404 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:41:29,415 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:41:29,415 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:41:29,415 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3079
CMC curve: Rank-1: 0.4788, Rank-5: 0.6684, Rank-10: 0.7360
=> Enter reranking
=> Results after reranking:
mAP: 0.3916
CMC curve: Rank-1: 0.4636, Rank-5: 0.6379, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.0836 (+27.15%)
Rank-1 improvement: -0.0152 (-3.18%)
2025-05-29 03:42:15,556 DeMo.train INFO: Validation Results - Epoch: 37
2025-05-29 03:42:15,556 DeMo.train INFO: mAP: 39.2%
2025-05-29 03:42:15,556 DeMo.train INFO: CMC curve, Rank-1  :46.4%
2025-05-29 03:42:15,557 DeMo.train INFO: CMC curve, Rank-5  :63.8%
2025-05-29 03:42:15,557 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 03:42:15,557 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:42:16,122 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:42:16,122 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:42:16,122 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:42:16,123 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:42:16,123 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:42:16,123 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:42:32,828 DeMo.train INFO: Epoch[38] Iteration[10/16] Loss: 4.444, Acc: 0.997, Base Lr: 4.77e-05
2025-05-29 03:42:37,706 DeMo.train INFO: Epoch 38 done. Time per batch: 1.542[s] Speed: 41.5[samples/s]
2025-05-29 03:42:37,709 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:42:37,709 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:42:37,709 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2654
CMC curve: Rank-1: 0.4569, Rank-5: 0.6667, Rank-10: 0.7208
=> Enter reranking
=> Results after reranking:
mAP: 0.3681
CMC curve: Rank-1: 0.4890, Rank-5: 0.6396, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.1027 (+38.70%)
Rank-1 improvement: 0.0321 (+7.04%)
2025-05-29 03:43:32,665 DeMo.train INFO: Validation Results - Epoch: 38
2025-05-29 03:43:32,665 DeMo.train INFO: mAP: 36.8%
2025-05-29 03:43:32,665 DeMo.train INFO: CMC curve, Rank-1  :48.9%
2025-05-29 03:43:32,665 DeMo.train INFO: CMC curve, Rank-5  :64.0%
2025-05-29 03:43:32,665 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 03:43:32,665 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:43:33,752 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:43:33,752 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:43:33,752 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2982
CMC curve: Rank-1: 0.4653, Rank-5: 0.6531, Rank-10: 0.7293
=> Enter reranking
=> Results after reranking:
mAP: 0.3843
CMC curve: Rank-1: 0.4687, Rank-5: 0.6362, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.0861 (+28.88%)
Rank-1 improvement: 0.0034 (+0.73%)
2025-05-29 03:44:31,434 DeMo.train INFO: Validation Results - Epoch: 38
2025-05-29 03:44:31,434 DeMo.train INFO: mAP: 38.4%
2025-05-29 03:44:31,434 DeMo.train INFO: CMC curve, Rank-1  :46.9%
2025-05-29 03:44:31,435 DeMo.train INFO: CMC curve, Rank-5  :63.6%
2025-05-29 03:44:31,435 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 03:44:31,435 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:44:31,441 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:44:31,441 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:44:31,441 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3113
CMC curve: Rank-1: 0.4822, Rank-5: 0.6650, Rank-10: 0.7496
=> Enter reranking
=> Results after reranking:
mAP: 0.3945
CMC curve: Rank-1: 0.4602, Rank-5: 0.6413, Rank-10: 0.7039
=> Improvement:
mAP improvement: 0.0832 (+26.74%)
Rank-1 improvement: -0.0220 (-4.56%)
2025-05-29 03:45:24,840 DeMo.train INFO: Validation Results - Epoch: 38
2025-05-29 03:45:24,840 DeMo.train INFO: mAP: 39.4%
2025-05-29 03:45:24,840 DeMo.train INFO: CMC curve, Rank-1  :46.0%
2025-05-29 03:45:24,840 DeMo.train INFO: CMC curve, Rank-5  :64.1%
2025-05-29 03:45:24,840 DeMo.train INFO: CMC curve, Rank-10 :70.4%
2025-05-29 03:45:24,840 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:45:26,204 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:45:26,205 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:45:26,205 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:45:26,205 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:45:26,205 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:45:26,205 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:45:42,512 DeMo.train INFO: Epoch[39] Iteration[10/16] Loss: 4.471, Acc: 0.995, Base Lr: 4.05e-05
2025-05-29 03:45:47,387 DeMo.train INFO: Epoch 39 done. Time per batch: 1.513[s] Speed: 42.3[samples/s]
2025-05-29 03:45:47,391 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:45:47,391 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:45:47,391 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2675
CMC curve: Rank-1: 0.4535, Rank-5: 0.6548, Rank-10: 0.7208
=> Enter reranking
=> Results after reranking:
mAP: 0.3688
CMC curve: Rank-1: 0.4941, Rank-5: 0.6497, Rank-10: 0.7039
=> Improvement:
mAP improvement: 0.1014 (+37.90%)
Rank-1 improvement: 0.0406 (+8.96%)
2025-05-29 03:46:41,106 DeMo.train INFO: Validation Results - Epoch: 39
2025-05-29 03:46:41,106 DeMo.train INFO: mAP: 36.9%
2025-05-29 03:46:41,106 DeMo.train INFO: CMC curve, Rank-1  :49.4%
2025-05-29 03:46:41,106 DeMo.train INFO: CMC curve, Rank-5  :65.0%
2025-05-29 03:46:41,106 DeMo.train INFO: CMC curve, Rank-10 :70.4%
2025-05-29 03:46:41,106 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:46:41,987 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:46:41,988 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:46:41,988 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3037
CMC curve: Rank-1: 0.4738, Rank-5: 0.6701, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.3882
CMC curve: Rank-1: 0.4653, Rank-5: 0.6311, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.0845 (+27.84%)
Rank-1 improvement: -0.0085 (-1.79%)
2025-05-29 03:47:32,596 DeMo.train INFO: Validation Results - Epoch: 39
2025-05-29 03:47:32,596 DeMo.train INFO: mAP: 38.8%
2025-05-29 03:47:32,596 DeMo.train INFO: CMC curve, Rank-1  :46.5%
2025-05-29 03:47:32,597 DeMo.train INFO: CMC curve, Rank-5  :63.1%
2025-05-29 03:47:32,597 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 03:47:32,597 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:47:32,603 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:47:32,604 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:47:32,604 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3159
CMC curve: Rank-1: 0.4924, Rank-5: 0.6819, Rank-10: 0.7580
=> Enter reranking
=> Results after reranking:
mAP: 0.4010
CMC curve: Rank-1: 0.4890, Rank-5: 0.6481, Rank-10: 0.7174
=> Improvement:
mAP improvement: 0.0851 (+26.94%)
Rank-1 improvement: -0.0034 (-0.69%)
2025-05-29 03:48:29,165 DeMo.train INFO: Validation Results - Epoch: 39
2025-05-29 03:48:29,165 DeMo.train INFO: mAP: 40.1%
2025-05-29 03:48:29,165 DeMo.train INFO: CMC curve, Rank-1  :48.9%
2025-05-29 03:48:29,165 DeMo.train INFO: CMC curve, Rank-5  :64.8%
2025-05-29 03:48:29,165 DeMo.train INFO: CMC curve, Rank-10 :71.7%
2025-05-29 03:48:29,165 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:48:29,611 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:48:29,611 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:48:29,611 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:48:29,611 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:48:29,611 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:48:29,611 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:48:46,045 DeMo.train INFO: Epoch[40] Iteration[10/16] Loss: 4.432, Acc: 0.998, Base Lr: 3.37e-05
2025-05-29 03:48:50,930 DeMo.train INFO: Epoch 40 done. Time per batch: 1.523[s] Speed: 42.0[samples/s]
2025-05-29 03:48:50,933 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:48:50,933 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:48:50,933 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2674
CMC curve: Rank-1: 0.4518, Rank-5: 0.6599, Rank-10: 0.7208
=> Enter reranking
=> Results after reranking:
mAP: 0.3679
CMC curve: Rank-1: 0.4856, Rank-5: 0.6447, Rank-10: 0.6971
=> Improvement:
mAP improvement: 0.1005 (+37.59%)
Rank-1 improvement: 0.0338 (+7.49%)
2025-05-29 03:49:41,440 DeMo.train INFO: Validation Results - Epoch: 40
2025-05-29 03:49:41,441 DeMo.train INFO: mAP: 36.8%
2025-05-29 03:49:41,441 DeMo.train INFO: CMC curve, Rank-1  :48.6%
2025-05-29 03:49:41,441 DeMo.train INFO: CMC curve, Rank-5  :64.5%
2025-05-29 03:49:41,441 DeMo.train INFO: CMC curve, Rank-10 :69.7%
2025-05-29 03:49:41,441 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:49:41,794 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:49:41,794 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:49:41,795 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3060
CMC curve: Rank-1: 0.4738, Rank-5: 0.6684, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.3938
CMC curve: Rank-1: 0.4772, Rank-5: 0.6311, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.0878 (+28.68%)
Rank-1 improvement: 0.0034 (+0.71%)
2025-05-29 03:50:31,452 DeMo.train INFO: Validation Results - Epoch: 40
2025-05-29 03:50:31,452 DeMo.train INFO: mAP: 39.4%
2025-05-29 03:50:31,452 DeMo.train INFO: CMC curve, Rank-1  :47.7%
2025-05-29 03:50:31,452 DeMo.train INFO: CMC curve, Rank-5  :63.1%
2025-05-29 03:50:31,452 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 03:50:31,453 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:50:32,467 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:50:32,468 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:50:32,468 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3188
CMC curve: Rank-1: 0.4941, Rank-5: 0.6717, Rank-10: 0.7580
=> Enter reranking
=> Results after reranking:
mAP: 0.4112
CMC curve: Rank-1: 0.4873, Rank-5: 0.6548, Rank-10: 0.7225
=> Improvement:
mAP improvement: 0.0924 (+28.98%)
Rank-1 improvement: -0.0068 (-1.37%)
2025-05-29 03:51:21,971 DeMo.train INFO: Validation Results - Epoch: 40
2025-05-29 03:51:21,972 DeMo.train INFO: mAP: 41.1%
2025-05-29 03:51:21,972 DeMo.train INFO: CMC curve, Rank-1  :48.7%
2025-05-29 03:51:21,972 DeMo.train INFO: CMC curve, Rank-5  :65.5%
2025-05-29 03:51:21,972 DeMo.train INFO: CMC curve, Rank-10 :72.3%
2025-05-29 03:51:21,972 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:51:21,978 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:51:21,978 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:51:21,978 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:51:21,978 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:51:21,978 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:51:21,978 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:51:30,762 DeMo.train INFO: Epoch[41] Iteration[10/16] Loss: 4.383, Acc: 0.995, Base Lr: 2.76e-05
2025-05-29 03:51:33,400 DeMo.train INFO: Epoch 41 done. Time per batch: 0.816[s] Speed: 78.4[samples/s]
2025-05-29 03:51:33,404 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:51:33,404 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:51:33,404 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2666
CMC curve: Rank-1: 0.4450, Rank-5: 0.6667, Rank-10: 0.7191
=> Enter reranking
=> Results after reranking:
mAP: 0.3690
CMC curve: Rank-1: 0.4788, Rank-5: 0.6497, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.1024 (+38.42%)
Rank-1 improvement: 0.0338 (+7.60%)
2025-05-29 03:52:26,498 DeMo.train INFO: Validation Results - Epoch: 41
2025-05-29 03:52:26,498 DeMo.train INFO: mAP: 36.9%
2025-05-29 03:52:26,498 DeMo.train INFO: CMC curve, Rank-1  :47.9%
2025-05-29 03:52:26,498 DeMo.train INFO: CMC curve, Rank-5  :65.0%
2025-05-29 03:52:26,498 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 03:52:26,498 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:52:27,742 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:52:27,743 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:52:27,743 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3076
CMC curve: Rank-1: 0.4738, Rank-5: 0.6633, Rank-10: 0.7462
=> Enter reranking
=> Results after reranking:
mAP: 0.3928
CMC curve: Rank-1: 0.4738, Rank-5: 0.6328, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.0852 (+27.71%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 03:53:24,273 DeMo.train INFO: Validation Results - Epoch: 41
2025-05-29 03:53:24,273 DeMo.train INFO: mAP: 39.3%
2025-05-29 03:53:24,273 DeMo.train INFO: CMC curve, Rank-1  :47.4%
2025-05-29 03:53:24,273 DeMo.train INFO: CMC curve, Rank-5  :63.3%
2025-05-29 03:53:24,274 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 03:53:24,274 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:53:25,305 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:53:25,306 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:53:25,306 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3192
CMC curve: Rank-1: 0.5008, Rank-5: 0.6734, Rank-10: 0.7563
=> Enter reranking
=> Results after reranking:
mAP: 0.4058
CMC curve: Rank-1: 0.4975, Rank-5: 0.6514, Rank-10: 0.7242
=> Improvement:
mAP improvement: 0.0867 (+27.15%)
Rank-1 improvement: -0.0034 (-0.68%)
2025-05-29 03:54:14,555 DeMo.train INFO: Validation Results - Epoch: 41
2025-05-29 03:54:14,555 DeMo.train INFO: mAP: 40.6%
2025-05-29 03:54:14,555 DeMo.train INFO: CMC curve, Rank-1  :49.7%
2025-05-29 03:54:14,555 DeMo.train INFO: CMC curve, Rank-5  :65.1%
2025-05-29 03:54:14,556 DeMo.train INFO: CMC curve, Rank-10 :72.4%
2025-05-29 03:54:14,556 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:54:15,011 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:54:15,011 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:54:15,011 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:54:15,011 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:54:15,011 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:54:15,011 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:54:32,911 DeMo.train INFO: Epoch[42] Iteration[10/16] Loss: 4.397, Acc: 0.998, Base Lr: 2.20e-05
2025-05-29 03:54:35,344 DeMo.train INFO: Epoch 42 done. Time per batch: 1.452[s] Speed: 44.1[samples/s]
2025-05-29 03:54:35,347 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:54:35,347 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:54:35,348 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2662
CMC curve: Rank-1: 0.4450, Rank-5: 0.6717, Rank-10: 0.7191
=> Enter reranking
=> Results after reranking:
mAP: 0.3681
CMC curve: Rank-1: 0.4822, Rank-5: 0.6565, Rank-10: 0.7124
=> Improvement:
mAP improvement: 0.1019 (+38.27%)
Rank-1 improvement: 0.0372 (+8.37%)
2025-05-29 03:55:22,812 DeMo.train INFO: Validation Results - Epoch: 42
2025-05-29 03:55:22,812 DeMo.train INFO: mAP: 36.8%
2025-05-29 03:55:22,812 DeMo.train INFO: CMC curve, Rank-1  :48.2%
2025-05-29 03:55:22,812 DeMo.train INFO: CMC curve, Rank-5  :65.7%
2025-05-29 03:55:22,812 DeMo.train INFO: CMC curve, Rank-10 :71.2%
2025-05-29 03:55:22,812 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:55:24,158 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:55:24,158 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:55:24,158 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3047
CMC curve: Rank-1: 0.4772, Rank-5: 0.6717, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.3911
CMC curve: Rank-1: 0.4755, Rank-5: 0.6379, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.0864 (+28.37%)
Rank-1 improvement: -0.0017 (-0.35%)
2025-05-29 03:56:20,020 DeMo.train INFO: Validation Results - Epoch: 42
2025-05-29 03:56:20,021 DeMo.train INFO: mAP: 39.1%
2025-05-29 03:56:20,021 DeMo.train INFO: CMC curve, Rank-1  :47.5%
2025-05-29 03:56:20,021 DeMo.train INFO: CMC curve, Rank-5  :63.8%
2025-05-29 03:56:20,021 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 03:56:20,021 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:56:20,027 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:56:20,027 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:56:20,027 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3167
CMC curve: Rank-1: 0.4958, Rank-5: 0.6734, Rank-10: 0.7580
=> Enter reranking
=> Results after reranking:
mAP: 0.3997
CMC curve: Rank-1: 0.4788, Rank-5: 0.6464, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.0830 (+26.20%)
Rank-1 improvement: -0.0169 (-3.41%)
2025-05-29 03:57:16,789 DeMo.train INFO: Validation Results - Epoch: 42
2025-05-29 03:57:16,789 DeMo.train INFO: mAP: 40.0%
2025-05-29 03:57:16,790 DeMo.train INFO: CMC curve, Rank-1  :47.9%
2025-05-29 03:57:16,790 DeMo.train INFO: CMC curve, Rank-5  :64.6%
2025-05-29 03:57:16,790 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 03:57:16,790 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:57:17,822 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:57:17,822 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 03:57:17,822 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 03:57:17,822 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 03:57:17,822 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 03:57:17,823 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:57:35,810 DeMo.train INFO: Epoch[43] Iteration[10/16] Loss: 4.377, Acc: 0.997, Base Lr: 1.70e-05
2025-05-29 03:57:41,395 DeMo.train INFO: Epoch 43 done. Time per batch: 1.684[s] Speed: 38.0[samples/s]
2025-05-29 03:57:41,398 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:57:41,398 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 03:57:41,399 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2667
CMC curve: Rank-1: 0.4433, Rank-5: 0.6717, Rank-10: 0.7191
=> Enter reranking
=> Results after reranking:
mAP: 0.3719
CMC curve: Rank-1: 0.4856, Rank-5: 0.6531, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.1053 (+39.47%)
Rank-1 improvement: 0.0423 (+9.54%)
2025-05-29 03:58:24,258 DeMo.train INFO: Validation Results - Epoch: 43
2025-05-29 03:58:24,258 DeMo.train INFO: mAP: 37.2%
2025-05-29 03:58:24,258 DeMo.train INFO: CMC curve, Rank-1  :48.6%
2025-05-29 03:58:24,258 DeMo.train INFO: CMC curve, Rank-5  :65.3%
2025-05-29 03:58:24,258 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 03:58:24,258 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:58:25,360 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:58:25,360 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 03:58:25,361 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3025
CMC curve: Rank-1: 0.4805, Rank-5: 0.6650, Rank-10: 0.7428
=> Enter reranking
=> Results after reranking:
mAP: 0.3878
CMC curve: Rank-1: 0.4839, Rank-5: 0.6345, Rank-10: 0.6954
=> Improvement:
mAP improvement: 0.0853 (+28.20%)
Rank-1 improvement: 0.0034 (+0.70%)
2025-05-29 03:59:18,716 DeMo.train INFO: Validation Results - Epoch: 43
2025-05-29 03:59:18,716 DeMo.train INFO: mAP: 38.8%
2025-05-29 03:59:18,716 DeMo.train INFO: CMC curve, Rank-1  :48.4%
2025-05-29 03:59:18,716 DeMo.train INFO: CMC curve, Rank-5  :63.5%
2025-05-29 03:59:18,716 DeMo.train INFO: CMC curve, Rank-10 :69.5%
2025-05-29 03:59:18,716 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:59:18,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 03:59:18,728 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 03:59:18,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3153
CMC curve: Rank-1: 0.4941, Rank-5: 0.6701, Rank-10: 0.7563
=> Enter reranking
=> Results after reranking:
mAP: 0.3977
CMC curve: Rank-1: 0.4687, Rank-5: 0.6464, Rank-10: 0.7056
=> Improvement:
mAP improvement: 0.0825 (+26.16%)
Rank-1 improvement: -0.0254 (-5.14%)
2025-05-29 04:00:08,810 DeMo.train INFO: Validation Results - Epoch: 43
2025-05-29 04:00:08,810 DeMo.train INFO: mAP: 39.8%
2025-05-29 04:00:08,810 DeMo.train INFO: CMC curve, Rank-1  :46.9%
2025-05-29 04:00:08,810 DeMo.train INFO: CMC curve, Rank-5  :64.6%
2025-05-29 04:00:08,810 DeMo.train INFO: CMC curve, Rank-10 :70.6%
2025-05-29 04:00:08,810 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:00:09,774 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:00:09,775 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 04:00:09,775 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 04:00:09,775 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 04:00:09,775 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 04:00:09,775 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:00:21,450 DeMo.train INFO: Epoch[44] Iteration[10/16] Loss: 4.363, Acc: 0.998, Base Lr: 1.26e-05
2025-05-29 04:00:27,038 DeMo.train INFO: Epoch 44 done. Time per batch: 1.233[s] Speed: 51.9[samples/s]
2025-05-29 04:00:27,041 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:00:27,041 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 04:00:27,041 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2668
CMC curve: Rank-1: 0.4450, Rank-5: 0.6667, Rank-10: 0.7174
=> Enter reranking
=> Results after reranking:
mAP: 0.3693
CMC curve: Rank-1: 0.4941, Rank-5: 0.6548, Rank-10: 0.7005
=> Improvement:
mAP improvement: 0.1025 (+38.40%)
Rank-1 improvement: 0.0491 (+11.03%)
2025-05-29 04:01:15,368 DeMo.train INFO: Validation Results - Epoch: 44
2025-05-29 04:01:15,368 DeMo.train INFO: mAP: 36.9%
2025-05-29 04:01:15,368 DeMo.train INFO: CMC curve, Rank-1  :49.4%
2025-05-29 04:01:15,368 DeMo.train INFO: CMC curve, Rank-5  :65.5%
2025-05-29 04:01:15,369 DeMo.train INFO: CMC curve, Rank-10 :70.1%
2025-05-29 04:01:15,369 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:01:16,826 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:01:16,826 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 04:01:16,827 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2992
CMC curve: Rank-1: 0.4755, Rank-5: 0.6701, Rank-10: 0.7411
=> Enter reranking
=> Results after reranking:
mAP: 0.3818
CMC curve: Rank-1: 0.4755, Rank-5: 0.6261, Rank-10: 0.6954
=> Improvement:
mAP improvement: 0.0827 (+27.64%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 04:02:10,377 DeMo.train INFO: Validation Results - Epoch: 44
2025-05-29 04:02:10,378 DeMo.train INFO: mAP: 38.2%
2025-05-29 04:02:10,378 DeMo.train INFO: CMC curve, Rank-1  :47.5%
2025-05-29 04:02:10,378 DeMo.train INFO: CMC curve, Rank-5  :62.6%
2025-05-29 04:02:10,378 DeMo.train INFO: CMC curve, Rank-10 :69.5%
2025-05-29 04:02:10,378 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:02:11,371 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:02:11,372 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 04:02:11,372 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3117
CMC curve: Rank-1: 0.4890, Rank-5: 0.6734, Rank-10: 0.7547
=> Enter reranking
=> Results after reranking:
mAP: 0.3940
CMC curve: Rank-1: 0.4772, Rank-5: 0.6430, Rank-10: 0.7039
=> Improvement:
mAP improvement: 0.0824 (+26.42%)
Rank-1 improvement: -0.0118 (-2.42%)
2025-05-29 04:03:00,523 DeMo.train INFO: Validation Results - Epoch: 44
2025-05-29 04:03:00,523 DeMo.train INFO: mAP: 39.4%
2025-05-29 04:03:00,523 DeMo.train INFO: CMC curve, Rank-1  :47.7%
2025-05-29 04:03:00,523 DeMo.train INFO: CMC curve, Rank-5  :64.3%
2025-05-29 04:03:00,523 DeMo.train INFO: CMC curve, Rank-10 :70.4%
2025-05-29 04:03:00,523 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:03:00,876 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:03:00,876 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 04:03:00,876 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 04:03:00,876 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 04:03:00,876 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 04:03:00,876 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:03:18,675 DeMo.train INFO: Epoch[45] Iteration[10/16] Loss: 4.385, Acc: 1.000, Base Lr: 8.91e-06
2025-05-29 04:03:21,099 DeMo.train INFO: Epoch 45 done. Time per batch: 1.444[s] Speed: 44.3[samples/s]
2025-05-29 04:03:21,102 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:03:21,102 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 04:03:21,102 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2677
CMC curve: Rank-1: 0.4501, Rank-5: 0.6667, Rank-10: 0.7174
=> Enter reranking
=> Results after reranking:
mAP: 0.3739
CMC curve: Rank-1: 0.5093, Rank-5: 0.6565, Rank-10: 0.7039
=> Improvement:
mAP improvement: 0.1061 (+39.64%)
Rank-1 improvement: 0.0592 (+13.16%)
2025-05-29 04:04:13,515 DeMo.train INFO: Validation Results - Epoch: 45
2025-05-29 04:04:13,516 DeMo.train INFO: mAP: 37.4%
2025-05-29 04:04:13,516 DeMo.train INFO: CMC curve, Rank-1  :50.9%
2025-05-29 04:04:13,516 DeMo.train INFO: CMC curve, Rank-5  :65.7%
2025-05-29 04:04:13,516 DeMo.train INFO: CMC curve, Rank-10 :70.4%
2025-05-29 04:04:13,516 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:04:14,498 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:04:14,498 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 04:04:14,499 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3005
CMC curve: Rank-1: 0.4755, Rank-5: 0.6633, Rank-10: 0.7462
=> Enter reranking
=> Results after reranking:
mAP: 0.3820
CMC curve: Rank-1: 0.4738, Rank-5: 0.6261, Rank-10: 0.6988
=> Improvement:
mAP improvement: 0.0815 (+27.12%)
Rank-1 improvement: -0.0017 (-0.36%)
2025-05-29 04:05:07,299 DeMo.train INFO: Validation Results - Epoch: 45
2025-05-29 04:05:07,299 DeMo.train INFO: mAP: 38.2%
2025-05-29 04:05:07,299 DeMo.train INFO: CMC curve, Rank-1  :47.4%
2025-05-29 04:05:07,299 DeMo.train INFO: CMC curve, Rank-5  :62.6%
2025-05-29 04:05:07,299 DeMo.train INFO: CMC curve, Rank-10 :69.9%
2025-05-29 04:05:07,299 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:05:07,761 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:05:07,762 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 04:05:07,762 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3130
CMC curve: Rank-1: 0.4924, Rank-5: 0.6768, Rank-10: 0.7580
=> Enter reranking
=> Results after reranking:
mAP: 0.3947
CMC curve: Rank-1: 0.4755, Rank-5: 0.6379, Rank-10: 0.7107
=> Improvement:
mAP improvement: 0.0817 (+26.10%)
Rank-1 improvement: -0.0169 (-3.44%)
2025-05-29 04:06:04,951 DeMo.train INFO: Validation Results - Epoch: 45
2025-05-29 04:06:04,951 DeMo.train INFO: mAP: 39.5%
2025-05-29 04:06:04,951 DeMo.train INFO: CMC curve, Rank-1  :47.5%
2025-05-29 04:06:04,951 DeMo.train INFO: CMC curve, Rank-5  :63.8%
2025-05-29 04:06:04,951 DeMo.train INFO: CMC curve, Rank-10 :71.1%
2025-05-29 04:06:04,951 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:06:05,337 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:06:05,337 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 04:06:05,338 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 04:06:05,338 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 04:06:05,338 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 04:06:05,338 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:06:23,156 DeMo.train INFO: Epoch[46] Iteration[10/16] Loss: 4.414, Acc: 0.998, Base Lr: 5.84e-06
2025-05-29 04:06:28,761 DeMo.train INFO: Epoch 46 done. Time per batch: 1.673[s] Speed: 38.3[samples/s]
2025-05-29 04:06:28,764 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:06:28,764 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 04:06:28,765 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2682
CMC curve: Rank-1: 0.4518, Rank-5: 0.6684, Rank-10: 0.7157
=> Enter reranking
=> Results after reranking:
mAP: 0.3731
CMC curve: Rank-1: 0.4958, Rank-5: 0.6582, Rank-10: 0.7039
=> Improvement:
mAP improvement: 0.1049 (+39.13%)
Rank-1 improvement: 0.0440 (+9.74%)
2025-05-29 04:07:17,261 DeMo.train INFO: Validation Results - Epoch: 46
2025-05-29 04:07:17,261 DeMo.train INFO: mAP: 37.3%
2025-05-29 04:07:17,261 DeMo.train INFO: CMC curve, Rank-1  :49.6%
2025-05-29 04:07:17,261 DeMo.train INFO: CMC curve, Rank-5  :65.8%
2025-05-29 04:07:17,261 DeMo.train INFO: CMC curve, Rank-10 :70.4%
2025-05-29 04:07:17,261 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:07:18,757 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:07:18,757 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 04:07:18,757 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3008
CMC curve: Rank-1: 0.4721, Rank-5: 0.6650, Rank-10: 0.7462
=> Enter reranking
=> Results after reranking:
mAP: 0.3847
CMC curve: Rank-1: 0.4772, Rank-5: 0.6413, Rank-10: 0.7090
=> Improvement:
mAP improvement: 0.0839 (+27.90%)
Rank-1 improvement: 0.0051 (+1.08%)
2025-05-29 04:08:02,809 DeMo.train INFO: Validation Results - Epoch: 46
2025-05-29 04:08:02,809 DeMo.train INFO: mAP: 38.5%
2025-05-29 04:08:02,809 DeMo.train INFO: CMC curve, Rank-1  :47.7%
2025-05-29 04:08:02,809 DeMo.train INFO: CMC curve, Rank-5  :64.1%
2025-05-29 04:08:02,809 DeMo.train INFO: CMC curve, Rank-10 :70.9%
2025-05-29 04:08:02,809 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:08:03,291 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:08:03,292 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 04:08:03,292 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3142
CMC curve: Rank-1: 0.4907, Rank-5: 0.6819, Rank-10: 0.7580
=> Enter reranking
=> Results after reranking:
mAP: 0.4002
CMC curve: Rank-1: 0.4805, Rank-5: 0.6464, Rank-10: 0.7124
=> Improvement:
mAP improvement: 0.0860 (+27.36%)
Rank-1 improvement: -0.0102 (-2.07%)
2025-05-29 04:08:56,848 DeMo.train INFO: Validation Results - Epoch: 46
2025-05-29 04:08:56,848 DeMo.train INFO: mAP: 40.0%
2025-05-29 04:08:56,848 DeMo.train INFO: CMC curve, Rank-1  :48.1%
2025-05-29 04:08:56,848 DeMo.train INFO: CMC curve, Rank-5  :64.6%
2025-05-29 04:08:56,848 DeMo.train INFO: CMC curve, Rank-10 :71.2%
2025-05-29 04:08:56,848 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:08:58,203 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:08:58,204 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 04:08:58,204 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 04:08:58,204 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 04:08:58,204 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 04:08:58,204 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:09:06,950 DeMo.train INFO: Epoch[47] Iteration[10/16] Loss: 4.342, Acc: 0.994, Base Lr: 3.45e-06
2025-05-29 04:09:09,725 DeMo.train INFO: Epoch 47 done. Time per batch: 0.823[s] Speed: 77.8[samples/s]
2025-05-29 04:09:09,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:09:09,728 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 04:09:09,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2682
CMC curve: Rank-1: 0.4518, Rank-5: 0.6684, Rank-10: 0.7157
=> Enter reranking
=> Results after reranking:
mAP: 0.3724
CMC curve: Rank-1: 0.4975, Rank-5: 0.6531, Rank-10: 0.7039
=> Improvement:
mAP improvement: 0.1041 (+38.82%)
Rank-1 improvement: 0.0457 (+10.11%)
2025-05-29 04:10:04,837 DeMo.train INFO: Validation Results - Epoch: 47
2025-05-29 04:10:04,838 DeMo.train INFO: mAP: 37.2%
2025-05-29 04:10:04,838 DeMo.train INFO: CMC curve, Rank-1  :49.7%
2025-05-29 04:10:04,838 DeMo.train INFO: CMC curve, Rank-5  :65.3%
2025-05-29 04:10:04,838 DeMo.train INFO: CMC curve, Rank-10 :70.4%
2025-05-29 04:10:04,838 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:10:06,150 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:10:06,151 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 04:10:06,151 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3034
CMC curve: Rank-1: 0.4805, Rank-5: 0.6701, Rank-10: 0.7445
=> Enter reranking
=> Results after reranking:
mAP: 0.3904
CMC curve: Rank-1: 0.4805, Rank-5: 0.6328, Rank-10: 0.7039
=> Improvement:
mAP improvement: 0.0870 (+28.68%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-29 04:10:53,597 DeMo.train INFO: Validation Results - Epoch: 47
2025-05-29 04:10:53,597 DeMo.train INFO: mAP: 39.0%
2025-05-29 04:10:53,597 DeMo.train INFO: CMC curve, Rank-1  :48.1%
2025-05-29 04:10:53,598 DeMo.train INFO: CMC curve, Rank-5  :63.3%
2025-05-29 04:10:53,598 DeMo.train INFO: CMC curve, Rank-10 :70.4%
2025-05-29 04:10:53,598 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:10:53,738 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:10:53,739 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 04:10:53,739 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3158
CMC curve: Rank-1: 0.4941, Rank-5: 0.6768, Rank-10: 0.7580
=> Enter reranking
=> Results after reranking:
mAP: 0.4037
CMC curve: Rank-1: 0.4856, Rank-5: 0.6548, Rank-10: 0.7174
=> Improvement:
mAP improvement: 0.0879 (+27.84%)
Rank-1 improvement: -0.0085 (-1.71%)
2025-05-29 04:11:47,411 DeMo.train INFO: Validation Results - Epoch: 47
2025-05-29 04:11:47,412 DeMo.train INFO: mAP: 40.4%
2025-05-29 04:11:47,412 DeMo.train INFO: CMC curve, Rank-1  :48.6%
2025-05-29 04:11:47,412 DeMo.train INFO: CMC curve, Rank-5  :65.5%
2025-05-29 04:11:47,412 DeMo.train INFO: CMC curve, Rank-10 :71.7%
2025-05-29 04:11:47,412 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:11:48,563 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:11:48,563 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 04:11:48,563 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 04:11:48,564 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 04:11:48,564 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 04:11:48,564 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:12:06,397 DeMo.train INFO: Epoch[48] Iteration[10/16] Loss: 4.381, Acc: 1.000, Base Lr: 1.73e-06
2025-05-29 04:12:11,080 DeMo.train INFO: Epoch 48 done. Time per batch: 1.608[s] Speed: 39.8[samples/s]
2025-05-29 04:12:11,083 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:12:11,083 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 04:12:11,083 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2686
CMC curve: Rank-1: 0.4518, Rank-5: 0.6684, Rank-10: 0.7174
=> Enter reranking
=> Results after reranking:
mAP: 0.3740
CMC curve: Rank-1: 0.5008, Rank-5: 0.6548, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.1055 (+39.27%)
Rank-1 improvement: 0.0491 (+10.86%)
2025-05-29 04:13:02,087 DeMo.train INFO: Validation Results - Epoch: 48
2025-05-29 04:13:02,087 DeMo.train INFO: mAP: 37.4%
2025-05-29 04:13:02,087 DeMo.train INFO: CMC curve, Rank-1  :50.1%
2025-05-29 04:13:02,087 DeMo.train INFO: CMC curve, Rank-5  :65.5%
2025-05-29 04:13:02,087 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 04:13:02,087 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:13:02,961 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:13:02,961 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 04:13:02,961 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3048
CMC curve: Rank-1: 0.4856, Rank-5: 0.6717, Rank-10: 0.7496
=> Enter reranking
=> Results after reranking:
mAP: 0.3884
CMC curve: Rank-1: 0.4721, Rank-5: 0.6328, Rank-10: 0.7022
=> Improvement:
mAP improvement: 0.0836 (+27.43%)
Rank-1 improvement: -0.0135 (-2.79%)
2025-05-29 04:14:00,520 DeMo.train INFO: Validation Results - Epoch: 48
2025-05-29 04:14:00,520 DeMo.train INFO: mAP: 38.8%
2025-05-29 04:14:00,520 DeMo.train INFO: CMC curve, Rank-1  :47.2%
2025-05-29 04:14:00,520 DeMo.train INFO: CMC curve, Rank-5  :63.3%
2025-05-29 04:14:00,520 DeMo.train INFO: CMC curve, Rank-10 :70.2%
2025-05-29 04:14:00,520 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:14:00,545 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:14:00,545 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 04:14:00,545 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3161
CMC curve: Rank-1: 0.4907, Rank-5: 0.6751, Rank-10: 0.7614
=> Enter reranking
=> Results after reranking:
mAP: 0.4031
CMC curve: Rank-1: 0.4873, Rank-5: 0.6514, Rank-10: 0.7140
=> Improvement:
mAP improvement: 0.0871 (+27.54%)
Rank-1 improvement: -0.0034 (-0.69%)
2025-05-29 04:14:54,703 DeMo.train INFO: Validation Results - Epoch: 48
2025-05-29 04:14:54,704 DeMo.train INFO: mAP: 40.3%
2025-05-29 04:14:54,704 DeMo.train INFO: CMC curve, Rank-1  :48.7%
2025-05-29 04:14:54,704 DeMo.train INFO: CMC curve, Rank-5  :65.1%
2025-05-29 04:14:54,704 DeMo.train INFO: CMC curve, Rank-10 :71.4%
2025-05-29 04:14:54,704 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:14:54,790 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:14:54,790 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 04:14:54,790 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 04:14:54,790 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 04:14:54,790 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 04:14:54,790 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:15:12,590 DeMo.train INFO: Epoch[49] Iteration[10/16] Loss: 4.355, Acc: 1.000, Base Lr: 6.95e-07
2025-05-29 04:15:18,242 DeMo.train INFO: Epoch 49 done. Time per batch: 1.675[s] Speed: 38.2[samples/s]
2025-05-29 04:15:18,246 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:15:18,246 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 04:15:18,246 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2686
CMC curve: Rank-1: 0.4518, Rank-5: 0.6684, Rank-10: 0.7174
=> Enter reranking
=> Results after reranking:
mAP: 0.3743
CMC curve: Rank-1: 0.5025, Rank-5: 0.6548, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.1056 (+39.32%)
Rank-1 improvement: 0.0508 (+11.24%)
2025-05-29 04:16:07,429 DeMo.train INFO: Validation Results - Epoch: 49
2025-05-29 04:16:07,429 DeMo.train INFO: mAP: 37.4%
2025-05-29 04:16:07,429 DeMo.train INFO: CMC curve, Rank-1  :50.3%
2025-05-29 04:16:07,429 DeMo.train INFO: CMC curve, Rank-5  :65.5%
2025-05-29 04:16:07,429 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 04:16:07,429 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:16:08,384 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:16:08,384 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 04:16:08,385 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3028
CMC curve: Rank-1: 0.4788, Rank-5: 0.6667, Rank-10: 0.7513
=> Enter reranking
=> Results after reranking:
mAP: 0.3849
CMC curve: Rank-1: 0.4687, Rank-5: 0.6227, Rank-10: 0.6971
=> Improvement:
mAP improvement: 0.0821 (+27.12%)
Rank-1 improvement: -0.0102 (-2.12%)
2025-05-29 04:16:57,908 DeMo.train INFO: Validation Results - Epoch: 49
2025-05-29 04:16:57,909 DeMo.train INFO: mAP: 38.5%
2025-05-29 04:16:57,909 DeMo.train INFO: CMC curve, Rank-1  :46.9%
2025-05-29 04:16:57,909 DeMo.train INFO: CMC curve, Rank-5  :62.3%
2025-05-29 04:16:57,909 DeMo.train INFO: CMC curve, Rank-10 :69.7%
2025-05-29 04:16:57,909 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:16:58,736 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:16:58,737 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 04:16:58,737 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3157
CMC curve: Rank-1: 0.4924, Rank-5: 0.6768, Rank-10: 0.7614
=> Enter reranking
=> Results after reranking:
mAP: 0.4002
CMC curve: Rank-1: 0.4907, Rank-5: 0.6430, Rank-10: 0.7140
=> Improvement:
mAP improvement: 0.0845 (+26.78%)
Rank-1 improvement: -0.0017 (-0.34%)
2025-05-29 04:17:48,401 DeMo.train INFO: Validation Results - Epoch: 49
2025-05-29 04:17:48,401 DeMo.train INFO: mAP: 40.0%
2025-05-29 04:17:48,401 DeMo.train INFO: CMC curve, Rank-1  :49.1%
2025-05-29 04:17:48,401 DeMo.train INFO: CMC curve, Rank-5  :64.3%
2025-05-29 04:17:48,401 DeMo.train INFO: CMC curve, Rank-10 :71.4%
2025-05-29 04:17:48,401 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:17:48,876 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:17:48,876 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 04:17:48,876 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 04:17:48,876 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 04:17:48,876 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 04:17:48,876 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:18:03,876 DeMo.train INFO: Epoch[50] Iteration[10/16] Loss: 4.373, Acc: 1.000, Base Lr: 3.50e-07
2025-05-29 04:18:09,432 DeMo.train INFO: Epoch 50 done. Time per batch: 1.468[s] Speed: 43.6[samples/s]
2025-05-29 04:18:09,438 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:18:09,438 DeMo.train INFO: Current is the ori feature testing!
2025-05-29 04:18:09,438 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.2686
CMC curve: Rank-1: 0.4518, Rank-5: 0.6684, Rank-10: 0.7174
=> Enter reranking
=> Results after reranking:
mAP: 0.3744
CMC curve: Rank-1: 0.5025, Rank-5: 0.6565, Rank-10: 0.7073
=> Improvement:
mAP improvement: 0.1057 (+39.36%)
Rank-1 improvement: 0.0508 (+11.24%)
2025-05-29 04:18:58,264 DeMo.train INFO: Validation Results - Epoch: 50
2025-05-29 04:18:58,265 DeMo.train INFO: mAP: 37.4%
2025-05-29 04:18:58,265 DeMo.train INFO: CMC curve, Rank-1  :50.3%
2025-05-29 04:18:58,265 DeMo.train INFO: CMC curve, Rank-5  :65.7%
2025-05-29 04:18:58,265 DeMo.train INFO: CMC curve, Rank-10 :70.7%
2025-05-29 04:18:58,265 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:18:58,860 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:18:58,860 DeMo.train INFO: Current is the moe feature testing!
2025-05-29 04:18:58,860 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3024
CMC curve: Rank-1: 0.4772, Rank-5: 0.6734, Rank-10: 0.7496
=> Enter reranking
=> Results after reranking:
mAP: 0.3854
CMC curve: Rank-1: 0.4687, Rank-5: 0.6261, Rank-10: 0.7124
=> Improvement:
mAP improvement: 0.0830 (+27.45%)
Rank-1 improvement: -0.0085 (-1.77%)
2025-05-29 04:19:48,519 DeMo.train INFO: Validation Results - Epoch: 50
2025-05-29 04:19:48,519 DeMo.train INFO: mAP: 38.5%
2025-05-29 04:19:48,520 DeMo.train INFO: CMC curve, Rank-1  :46.9%
2025-05-29 04:19:48,520 DeMo.train INFO: CMC curve, Rank-5  :62.6%
2025-05-29 04:19:48,520 DeMo.train INFO: CMC curve, Rank-10 :71.2%
2025-05-29 04:19:48,520 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:19:48,984 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:19:48,985 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-29 04:19:48,985 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.3151
CMC curve: Rank-1: 0.4941, Rank-5: 0.6819, Rank-10: 0.7597
=> Enter reranking
=> Results after reranking:
mAP: 0.4014
CMC curve: Rank-1: 0.4975, Rank-5: 0.6447, Rank-10: 0.7140
=> Improvement:
mAP improvement: 0.0863 (+27.40%)
Rank-1 improvement: 0.0034 (+0.68%)
2025-05-29 04:20:34,592 DeMo.train INFO: Validation Results - Epoch: 50
2025-05-29 04:20:34,592 DeMo.train INFO: mAP: 40.1%
2025-05-29 04:20:34,593 DeMo.train INFO: CMC curve, Rank-1  :49.7%
2025-05-29 04:20:34,593 DeMo.train INFO: CMC curve, Rank-5  :64.5%
2025-05-29 04:20:34,593 DeMo.train INFO: CMC curve, Rank-10 :71.4%
2025-05-29 04:20:34,593 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:20:35,563 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-29 04:20:35,563 DeMo.train INFO: Best mAP: 41.5%
2025-05-29 04:20:35,563 DeMo.train INFO: Best Rank-1: 50.1%
2025-05-29 04:20:35,563 DeMo.train INFO: Best Rank-5: 68.4%
2025-05-29 04:20:35,564 DeMo.train INFO: Best Rank-10: 73.6%
2025-05-29 04:20:35,564 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
