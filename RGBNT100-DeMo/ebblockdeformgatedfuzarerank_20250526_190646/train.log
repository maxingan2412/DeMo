2025-05-26 19:06:50,267 DeMo INFO: Saving model in the path :./RGBNT100-DeMo/ebblockdeformgatedfuzarerank_20250526_190646
2025-05-26 19:06:50,267 DeMo INFO: Namespace(config_file='configs/RGBNT100/DeMo.yml', fea_cft=0, local_rank=0, opts=['OUTPUT_DIR', './RGBNT100-DeMo/ebblockdeformgatedfuzarerank_20250526_190646'])
2025-05-26 19:06:50,267 DeMo INFO: Loaded configuration file configs/RGBNT100/DeMo.yml
2025-05-26 19:06:50,267 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 0
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: True
  HDM: True
  ATM: True
  HEAD: 8

INPUT:
  SIZE_TRAIN: [ 128, 256 ]
  SIZE_TEST: [ 128, 256 ]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.5 # random erasing
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 16
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('RGBNT100')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.00035
  WARMUP_ITERS: 5
  MAX_EPOCHS: 30
  OPTIMIZER_NAME: 'Adam'
  GAMMA: 0.1
  IMS_PER_BATCH: 128
  EVAL_PERIOD: 1
  SEED: 1111

TEST:
  IMS_PER_BATCH: 128
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'




2025-05-26 19:06:50,268 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: RGBNT100
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [128, 256]
  SIZE_TRAIN: [128, 256]
MODEL:
  ADAPTER: False
  ATM: True
  ATT_DROP_RATE: 0.0
  DEVICE: cuda
  DEVICE_ID: 0
  DIRECT: 0
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  GLOBAL_LOCAL: True
  HDM: True
  HEAD: 8
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  METRIC_LOSS_TYPE: triplet
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
OUTPUT_DIR: ./RGBNT100-DeMo/ebblockdeformgatedfuzarerank_20250526_190646
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 60
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 128
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  MARGIN: 0.3
  MAX_EPOCHS: 30
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1111
  STEPS: (40, 70)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 5
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 128
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGB_IR loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |    50 |     8675 |         8
  query    |    50 |     1715 |         8
  gallery  |    50 |     8575 |         8
  ----------------------------------------
data is ready
using Transformer_type: ViT-B-16 as a backbone
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:8 width: 16
Successfully load ckpt!
_IncompatibleKeys(missing_keys=['visual.triple_dff.fc_atten1.0.weight', 'visual.triple_dff.fc_atten1.1.weight', 'visual.triple_dff.fc_atten1.1.bias', 'visual.triple_dff.fc_atten2.0.weight', 'visual.triple_dff.fc_atten2.1.weight', 'visual.triple_dff.fc_atten2.1.bias', 'visual.triple_dff.fc_atten4.0.weight', 'visual.triple_dff.fc_atten4.1.weight', 'visual.triple_dff.fc_atten4.1.bias', 'visual.triple_dff.input_weight_net.0.weight', 'visual.triple_dff.input_weight_net.0.bias', 'visual.triple_dff.input_weight_net.2.weight', 'visual.triple_dff.input_weight_net.2.bias', 'visual.triple_dff.gate_fc.0.weight', 'visual.triple_dff.gate_enhancement.0.weight', 'visual.triple_dff.gate_enhancement.0.bias', 'visual.triple_dff.fc_redu.0.weight', 'visual.triple_dff.fc_redu.1.weight', 'visual.triple_dff.fc_redu.1.bias', 'visual.triple_dff.residual_fc1.0.weight', 'visual.triple_dff.residual_fc1.1.weight', 'visual.triple_dff.residual_fc1.1.bias', 'visual.triple_dff.residual_fc2.0.weight', 'visual.triple_dff.residual_fc2.1.weight', 'visual.triple_dff.residual_fc2.1.bias', 'visual.triple_dff.residual_fc3.0.weight', 'visual.triple_dff.residual_fc3.1.weight', 'visual.triple_dff.residual_fc3.1.bias', 'visual.triple_dff.residual_fusion.0.weight', 'visual.triple_dff.residual_fusion.1.weight', 'visual.triple_dff.residual_fusion.1.bias', 'visual.triple_dff.fc1.weight', 'visual.triple_dff.fc1.bias', 'visual.triple_dff.fc2.weight', 'visual.triple_dff.fc2.bias', 'visual.triple_dff.fc3.weight', 'visual.triple_dff.fc3.bias', 'visual.triple_dff.attention_fusion.0.weight', 'visual.triple_dff.attention_fusion.0.bias', 'visual.quad_dffs.stage1_triple_dff.fc_atten1.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten1.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten1.1.bias', 'visual.quad_dffs.stage1_triple_dff.fc_atten2.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten2.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten2.1.bias', 'visual.quad_dffs.stage1_triple_dff.fc_atten4.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten4.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten4.1.bias', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.0.weight', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.0.bias', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.2.weight', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.2.bias', 'visual.quad_dffs.stage1_triple_dff.gate_fc.0.weight', 'visual.quad_dffs.stage1_triple_dff.gate_enhancement.0.weight', 'visual.quad_dffs.stage1_triple_dff.gate_enhancement.0.bias', 'visual.quad_dffs.stage1_triple_dff.fc_redu.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_redu.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_redu.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fc1.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc1.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc1.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fc2.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc2.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc2.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fc3.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc3.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc3.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fusion.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fusion.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fusion.1.bias', 'visual.quad_dffs.stage1_triple_dff.fc1.weight', 'visual.quad_dffs.stage1_triple_dff.fc1.bias', 'visual.quad_dffs.stage1_triple_dff.fc2.weight', 'visual.quad_dffs.stage1_triple_dff.fc2.bias', 'visual.quad_dffs.stage1_triple_dff.fc3.weight', 'visual.quad_dffs.stage1_triple_dff.fc3.bias', 'visual.quad_dffs.stage1_triple_dff.attention_fusion.0.weight', 'visual.quad_dffs.stage1_triple_dff.attention_fusion.0.bias', 'visual.quad_dffs.stage1_enhancement.0.weight', 'visual.quad_dffs.stage1_enhancement.0.bias', 'visual.quad_dffs.stage1_enhancement.1.weight', 'visual.quad_dffs.stage1_enhancement.1.bias', 'visual.quad_dffs.stage1_enhancement.3.weight', 'visual.quad_dffs.stage1_enhancement.3.bias', 'visual.quad_dffs.stage1_enhancement.5.weight', 'visual.quad_dffs.stage1_enhancement.5.bias', 'visual.quad_dffs.input4_preprocessing.0.weight', 'visual.quad_dffs.input4_preprocessing.0.bias', 'visual.quad_dffs.input4_preprocessing.1.weight', 'visual.quad_dffs.input4_preprocessing.1.bias', 'visual.quad_dffs.input4_preprocessing.3.weight', 'visual.quad_dffs.input4_preprocessing.3.bias', 'visual.quad_dffs.input4_preprocessing.4.weight', 'visual.quad_dffs.input4_preprocessing.4.bias', 'visual.quad_dffs.cross_stage_attention.0.weight', 'visual.quad_dffs.cross_stage_attention.0.bias', 'visual.quad_dffs.cross_stage_attention.2.weight', 'visual.quad_dffs.cross_stage_attention.2.bias', 'visual.quad_dffs.adaptive_fusion_weight.0.weight', 'visual.quad_dffs.adaptive_fusion_weight.0.bias', 'visual.quad_dffs.adaptive_fusion_weight.2.weight', 'visual.quad_dffs.adaptive_fusion_weight.2.bias', 'visual.quad_dffs.stage2_dff.fc_atten1.0.weight', 'visual.quad_dffs.stage2_dff.fc_atten2.0.weight', 'visual.quad_dffs.stage2_dff.fc_atten3.0.weight', 'visual.quad_dffs.stage2_dff.gate_fc.0.weight', 'visual.quad_dffs.stage2_dff.fc_redu.weight', 'visual.quad_dffs.stage2_dff.residual_fc.weight', 'visual.quad_dffs.stage2_dff.fc1.weight', 'visual.quad_dffs.stage2_dff.fc1.bias', 'visual.quad_dffs.stage2_dff.fc2.weight', 'visual.quad_dffs.stage2_dff.fc2.bias', 'visual.quad_dffs.memory_input1.weight', 'visual.quad_dffs.memory_input4.weight', 'visual.quad_dffs.memory_fusion.0.weight', 'visual.quad_dffs.memory_fusion.1.weight', 'visual.quad_dffs.memory_fusion.1.bias', 'visual.quad_dffs.global_context.0.weight', 'visual.quad_dffs.global_context.0.bias', 'visual.quad_dffs.global_context.2.weight', 'visual.quad_dffs.global_context.2.bias', 'visual.quad_dffs.final_refinement.0.weight', 'visual.quad_dffs.final_refinement.0.bias', 'visual.quad_dffs.final_refinement.1.weight', 'visual.quad_dffs.final_refinement.1.bias', 'visual.quad_dffs.final_refinement.3.weight', 'visual.quad_dffs.final_refinement.3.bias', 'visual.quad_dffs.final_refinement.4.weight', 'visual.quad_dffs.final_refinement.4.bias', 'visual.gated_enhancement.rgb_gating.residual_weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.q_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.k_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.v_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.out_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.out_proj.bias', 'visual.gated_enhancement.rgb_gating.channel_gate.0.weight', 'visual.gated_enhancement.rgb_gating.channel_gate.0.bias', 'visual.gated_enhancement.rgb_gating.channel_gate.2.weight', 'visual.gated_enhancement.rgb_gating.channel_gate.2.bias', 'visual.gated_enhancement.rgb_gating.spatial_gate.0.weight', 'visual.gated_enhancement.rgb_gating.spatial_gate.0.bias', 'visual.gated_enhancement.rgb_gating.spatial_gate.2.weight', 'visual.gated_enhancement.rgb_gating.spatial_gate.2.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.0.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.0.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.1.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.1.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.3.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.3.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.4.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.4.bias', 'visual.gated_enhancement.rgb_gating.adaptive_weight.0.weight', 'visual.gated_enhancement.rgb_gating.adaptive_weight.0.bias', 'visual.gated_enhancement.rgb_gating.adaptive_weight.2.weight', 'visual.gated_enhancement.rgb_gating.adaptive_weight.2.bias', 'visual.gated_enhancement.nir_gating.residual_weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.q_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.k_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.v_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.out_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.out_proj.bias', 'visual.gated_enhancement.nir_gating.channel_gate.0.weight', 'visual.gated_enhancement.nir_gating.channel_gate.0.bias', 'visual.gated_enhancement.nir_gating.channel_gate.2.weight', 'visual.gated_enhancement.nir_gating.channel_gate.2.bias', 'visual.gated_enhancement.nir_gating.spatial_gate.0.weight', 'visual.gated_enhancement.nir_gating.spatial_gate.0.bias', 'visual.gated_enhancement.nir_gating.spatial_gate.2.weight', 'visual.gated_enhancement.nir_gating.spatial_gate.2.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.0.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.0.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.1.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.1.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.3.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.3.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.4.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.4.bias', 'visual.gated_enhancement.nir_gating.adaptive_weight.0.weight', 'visual.gated_enhancement.nir_gating.adaptive_weight.0.bias', 'visual.gated_enhancement.nir_gating.adaptive_weight.2.weight', 'visual.gated_enhancement.nir_gating.adaptive_weight.2.bias', 'visual.gated_enhancement.tir_gating.residual_weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.q_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.k_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.v_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.out_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.out_proj.bias', 'visual.gated_enhancement.tir_gating.channel_gate.0.weight', 'visual.gated_enhancement.tir_gating.channel_gate.0.bias', 'visual.gated_enhancement.tir_gating.channel_gate.2.weight', 'visual.gated_enhancement.tir_gating.channel_gate.2.bias', 'visual.gated_enhancement.tir_gating.spatial_gate.0.weight', 'visual.gated_enhancement.tir_gating.spatial_gate.0.bias', 'visual.gated_enhancement.tir_gating.spatial_gate.2.weight', 'visual.gated_enhancement.tir_gating.spatial_gate.2.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.0.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.0.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.1.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.1.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.3.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.3.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.4.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.4.bias', 'visual.gated_enhancement.tir_gating.adaptive_weight.0.weight', 'visual.gated_enhancement.tir_gating.adaptive_weight.0.bias', 'visual.gated_enhancement.tir_gating.adaptive_weight.2.weight', 'visual.gated_enhancement.tir_gating.adaptive_weight.2.bias', 'visual.gated_enhancement.global_coordination.interaction_net.0.weight', 'visual.gated_enhancement.global_coordination.interaction_net.0.bias', 'visual.gated_enhancement.global_coordination.interaction_net.1.weight', 'visual.gated_enhancement.global_coordination.interaction_net.1.bias', 'visual.gated_enhancement.global_coordination.interaction_net.3.weight', 'visual.gated_enhancement.global_coordination.interaction_net.3.bias', 'visual.gated_enhancement.global_coordination.interaction_net.4.weight', 'visual.gated_enhancement.global_coordination.interaction_net.4.bias', 'visual.gated_enhancement.global_coordination.balance_net.0.weight', 'visual.gated_enhancement.global_coordination.balance_net.0.bias', 'visual.gated_enhancement.global_coordination.balance_net.2.weight', 'visual.gated_enhancement.global_coordination.balance_net.2.bias', 'visual.gated_enhancement.global_coordination.global_gate.0.weight', 'visual.gated_enhancement.global_coordination.global_gate.0.bias', 'visual.gated_enhancement.global_coordination.global_gate.2.weight', 'visual.gated_enhancement.global_coordination.global_gate.2.bias'], unexpected_keys=[])
Loading pretrained model from CLIP
camera number is : 8
combineway: ebblockdeform
2025-05-26 19:06:57,686 DeMo INFO: combineway: ebblockdeform
===========Building DeMo===========
2025-05-26 19:06:57,737 DeMo INFO: DeMo(
  (BACKBONE): build_transformer_new(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (triple_dff): TripleInputDirectDFF(
        (avg_pool1): AdaptiveAvgPool1d(output_size=1)
        (avg_pool2): AdaptiveAvgPool1d(output_size=2)
        (avg_pool4): AdaptiveAvgPool1d(output_size=4)
        (fc_atten1): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
        (fc_atten2): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
        (fc_atten4): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
        (input_weight_net): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=768, out_features=3, bias=True)
          (3): Softmax(dim=-1)
        )
        (gate_fc): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): Sigmoid()
        )
        (gate_enhancement): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=True)
          (1): Tanh()
        )
        (fc_redu): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
        )
        (residual_fc1): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (residual_fc2): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (residual_fc3): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (residual_fusion): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (fc1): Linear(in_features=768, out_features=1, bias=True)
        (fc2): Linear(in_features=768, out_features=1, bias=True)
        (fc3): Linear(in_features=768, out_features=1, bias=True)
        (attention_fusion): Sequential(
          (0): Linear(in_features=3, out_features=1, bias=True)
          (1): Sigmoid()
        )
      )
      (quad_dffs): QuadInputHierarchicalDFF(
        (stage1_triple_dff): TripleInputDirectDFF(
          (avg_pool1): AdaptiveAvgPool1d(output_size=1)
          (avg_pool2): AdaptiveAvgPool1d(output_size=2)
          (avg_pool4): AdaptiveAvgPool1d(output_size=4)
          (fc_atten1): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
            (2): Sigmoid()
          )
          (fc_atten2): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
            (2): Sigmoid()
          )
          (fc_atten4): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
            (2): Sigmoid()
          )
          (input_weight_net): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=3, bias=True)
            (3): Softmax(dim=-1)
          )
          (gate_fc): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): Sigmoid()
          )
          (gate_enhancement): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=True)
            (1): Tanh()
          )
          (fc_redu): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
          )
          (residual_fc1): Sequential(
            (0): Linear(in_features=768, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (residual_fc2): Sequential(
            (0): Linear(in_features=768, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (residual_fc3): Sequential(
            (0): Linear(in_features=768, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (residual_fusion): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (fc1): Linear(in_features=768, out_features=1, bias=True)
          (fc2): Linear(in_features=768, out_features=1, bias=True)
          (fc3): Linear(in_features=768, out_features=1, bias=True)
          (attention_fusion): Sequential(
            (0): Linear(in_features=3, out_features=1, bias=True)
            (1): Sigmoid()
          )
        )
        (stage1_enhancement): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
          (3): Linear(in_features=768, out_features=192, bias=True)
          (4): ReLU(inplace=True)
          (5): Linear(in_features=192, out_features=768, bias=True)
          (6): Sigmoid()
        )
        (input4_preprocessing): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
          (3): Linear(in_features=768, out_features=768, bias=True)
          (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (cross_stage_attention): Sequential(
          (0): Linear(in_features=768, out_features=96, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=96, out_features=768, bias=True)
          (3): Sigmoid()
        )
        (adaptive_fusion_weight): Sequential(
          (0): Linear(in_features=1536, out_features=192, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=192, out_features=2, bias=True)
          (3): Softmax(dim=-1)
        )
        (stage2_dff): InnovativeDFF(
          (avg_pool1): AdaptiveAvgPool1d(output_size=1)
          (avg_pool2): AdaptiveAvgPool1d(output_size=2)
          (avg_pool3): AdaptiveAvgPool1d(output_size=4)
          (fc_atten1): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (fc_atten2): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (fc_atten3): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (gate_fc): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (fc_redu): Linear(in_features=1536, out_features=768, bias=False)
          (residual_fc): Linear(in_features=768, out_features=768, bias=False)
          (fc1): Linear(in_features=768, out_features=1, bias=True)
          (fc2): Linear(in_features=768, out_features=1, bias=True)
          (nonlin): Sigmoid()
        )
        (memory_input1): Linear(in_features=768, out_features=768, bias=False)
        (memory_input4): Linear(in_features=768, out_features=768, bias=False)
        (memory_fusion): Sequential(
          (0): Linear(in_features=1536, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (global_context): Sequential(
          (0): Linear(in_features=768, out_features=384, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=384, out_features=768, bias=True)
          (3): Sigmoid()
        )
        (final_refinement): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
          (3): Linear(in_features=768, out_features=768, bias=True)
          (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
      (gated_enhancement): GatedModalityEnhancement(
        (rgb_gating): ModalityGatingUnit(
          (cross_modal_attention): CrossModalAttentionGate(
            (q_proj): Linear(in_features=768, out_features=768, bias=False)
            (k_proj): Linear(in_features=768, out_features=768, bias=False)
            (v_proj): Linear(in_features=768, out_features=768, bias=False)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (channel_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=768, bias=True)
            (3): Sigmoid()
          )
          (spatial_gate): Sequential(
            (0): Linear(in_features=1536, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=1, bias=True)
            (3): Sigmoid()
          )
          (feature_fusion): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (adaptive_weight): Sequential(
            (0): Linear(in_features=1536, out_features=384, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=384, out_features=2, bias=True)
            (3): Softmax(dim=-1)
          )
        )
        (nir_gating): ModalityGatingUnit(
          (cross_modal_attention): CrossModalAttentionGate(
            (q_proj): Linear(in_features=768, out_features=768, bias=False)
            (k_proj): Linear(in_features=768, out_features=768, bias=False)
            (v_proj): Linear(in_features=768, out_features=768, bias=False)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (channel_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=768, bias=True)
            (3): Sigmoid()
          )
          (spatial_gate): Sequential(
            (0): Linear(in_features=1536, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=1, bias=True)
            (3): Sigmoid()
          )
          (feature_fusion): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (adaptive_weight): Sequential(
            (0): Linear(in_features=1536, out_features=384, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=384, out_features=2, bias=True)
            (3): Softmax(dim=-1)
          )
        )
        (tir_gating): ModalityGatingUnit(
          (cross_modal_attention): CrossModalAttentionGate(
            (q_proj): Linear(in_features=768, out_features=768, bias=False)
            (k_proj): Linear(in_features=768, out_features=768, bias=False)
            (v_proj): Linear(in_features=768, out_features=768, bias=False)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (channel_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=768, bias=True)
            (3): Sigmoid()
          )
          (spatial_gate): Sequential(
            (0): Linear(in_features=1536, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=1, bias=True)
            (3): Sigmoid()
          )
          (feature_fusion): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (adaptive_weight): Sequential(
            (0): Linear(in_features=1536, out_features=384, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=384, out_features=2, bias=True)
            (3): Softmax(dim=-1)
          )
        )
        (global_coordination): GlobalCoordinationGate(
          (interaction_net): Sequential(
            (0): Linear(in_features=2304, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (balance_net): Sequential(
            (0): Linear(in_features=4608, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=3, bias=True)
            (3): Softmax(dim=-1)
          )
          (global_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=1, bias=True)
            (3): Sigmoid()
          )
        )
      )
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (generalFusion): GeneralFusion(
    (r): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (n): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (t): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (rn): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (rt): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (nt): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (rnt): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (moe): MoM(
      (experts): ModuleList(
        (0): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (1): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (2): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (3): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (4): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (5): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (6): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (7): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
      )
      (gating_network): GatingNetwork(
        (gate): CrossAttention(
          (linear_re): Sequential(
            (0): Linear(in_features=3584, out_features=512, bias=True)
            (1): QuickGELU()
            (2): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (q_): Linear(in_features=512, out_features=512, bias=False)
          (k_): Linear(in_features=512, out_features=512, bias=False)
        )
      )
    )
    (ebblock_r): EBlock(
      (extra_conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
      (conv1): Conv2d(512, 1024, kernel_size=(1, 1), stride=(1, 1))
      (branches): ModuleList(
        (0): Branch(
          (branch): Sequential(
            (0): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
          )
        )
        (1): Branch(
          (branch): Sequential(
            (0): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(4, 4), dilation=(4, 4), groups=1024)
          )
        )
        (2): Branch(
          (branch): Sequential(
            (0): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(9, 9), dilation=(9, 9), groups=1024)
          )
        )
      )
      (sca): Sequential(
        (0): AdaptiveAvgPool2d(output_size=1)
        (1): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      )
      (sg1): SimpleGate()
      (conv3): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      (norm1): LayerNorm2d()
      (norm2): LayerNorm2d()
      (freq): FreMLP(
        (process1): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(1, 1))
          (1): LeakyReLU(negative_slope=0.1, inplace=True)
          (2): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1))
        )
      )
    )
    (ebblock_n): EBlock(
      (extra_conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
      (conv1): Conv2d(512, 1024, kernel_size=(1, 1), stride=(1, 1))
      (branches): ModuleList(
        (0): Branch(
          (branch): Sequential(
            (0): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
          )
        )
        (1): Branch(
          (branch): Sequential(
            (0): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(4, 4), dilation=(4, 4), groups=1024)
          )
        )
        (2): Branch(
          (branch): Sequential(
            (0): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(9, 9), dilation=(9, 9), groups=1024)
          )
        )
      )
      (sca): Sequential(
        (0): AdaptiveAvgPool2d(output_size=1)
        (1): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      )
      (sg1): SimpleGate()
      (conv3): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      (norm1): LayerNorm2d()
      (norm2): LayerNorm2d()
      (freq): FreMLP(
        (process1): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(1, 1))
          (1): LeakyReLU(negative_slope=0.1, inplace=True)
          (2): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1))
        )
      )
    )
    (ebblock_t): EBlock(
      (extra_conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
      (conv1): Conv2d(512, 1024, kernel_size=(1, 1), stride=(1, 1))
      (branches): ModuleList(
        (0): Branch(
          (branch): Sequential(
            (0): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
          )
        )
        (1): Branch(
          (branch): Sequential(
            (0): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(4, 4), dilation=(4, 4), groups=1024)
          )
        )
        (2): Branch(
          (branch): Sequential(
            (0): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(9, 9), dilation=(9, 9), groups=1024)
          )
        )
      )
      (sca): Sequential(
        (0): AdaptiveAvgPool2d(output_size=1)
        (1): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      )
      (sg1): SimpleGate()
      (conv3): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      (norm1): LayerNorm2d()
      (norm2): LayerNorm2d()
      (freq): FreMLP(
        (process1): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(1, 1))
          (1): LeakyReLU(negative_slope=0.1, inplace=True)
          (2): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1))
        )
      )
    )
    (deformselect): DAttentionBaseline(
      (conv_offset): Sequential(
        (0): Conv2d(1536, 512, kernel_size=(1, 1), stride=(1, 1))
        (1): GELU(approximate='none')
        (2): Conv2d(512, 512, kernel_size=(4, 4), stride=(2, 2), groups=512)
        (3): GELU(approximate='none')
        (4): Conv2d(512, 2, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (proj_q): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      (proj_k): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      (proj_v): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      (proj_out): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
      (proj_drop): Dropout(p=0.0, inplace=False)
      (attn_drop): Dropout(p=0.0, inplace=False)
    )
  )
  (classifier_moe): Linear(in_features=3584, out_features=50, bias=False)
  (bottleneck_moe): BatchNorm1d(3584, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_r): Linear(in_features=512, out_features=50, bias=False)
  (bottleneck_r): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_n): Linear(in_features=512, out_features=50, bias=False)
  (bottleneck_n): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_t): Linear(in_features=512, out_features=50, bias=False)
  (bottleneck_t): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-05-26 19:06:57,740 DeMo INFO: number of parameters:223.709256
using soft triplet loss for training
label smooth on, numclasses: 50
2025-05-26 19:06:57,852 DeMo.train INFO: start training
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/ma1/work/demorelated/DeMo/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
2025-05-26 19:07:32,151 DeMo.train INFO: Epoch[1] Iteration[10/65] Loss: 10.792, Acc: 0.079, Base Lr: 9.80e-05
2025-05-26 19:07:45,704 DeMo.train INFO: Epoch[1] Iteration[20/65] Loss: 9.265, Acc: 0.131, Base Lr: 9.80e-05
2025-05-26 19:07:58,835 DeMo.train INFO: Epoch[1] Iteration[30/65] Loss: 8.621, Acc: 0.208, Base Lr: 9.80e-05
2025-05-26 19:08:11,985 DeMo.train INFO: Epoch[1] Iteration[40/65] Loss: 8.194, Acc: 0.289, Base Lr: 9.80e-05
2025-05-26 19:08:25,164 DeMo.train INFO: Epoch[1] Iteration[50/65] Loss: 7.860, Acc: 0.344, Base Lr: 9.80e-05
2025-05-26 19:08:38,305 DeMo.train INFO: Epoch[1] Iteration[60/65] Loss: 7.595, Acc: 0.392, Base Lr: 9.80e-05
2025-05-26 19:08:42,361 DeMo.train INFO: Epoch 1 done. Time per batch: 1.648[s] Speed: 77.7[samples/s]
2025-05-26 19:08:42,366 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:08:42,366 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 19:08:42,366 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6400
CMC curve: Rank-1: 0.8688, Rank-5: 0.8933, Rank-10: 0.9079
=> Enter reranking
=> Results after reranking:
mAP: 0.6538
CMC curve: Rank-1: 0.8810, Rank-5: 0.8875, Rank-10: 0.8962
=> Improvement:
mAP improvement: 0.0138 (+2.16%)
Rank-1 improvement: 0.0122 (+1.41%)
2025-05-26 19:11:48,083 DeMo.train INFO: Validation Results - Epoch: 1
2025-05-26 19:11:48,084 DeMo.train INFO: mAP: 65.4%
2025-05-26 19:11:48,084 DeMo.train INFO: CMC curve, Rank-1  :88.1%
2025-05-26 19:11:48,084 DeMo.train INFO: CMC curve, Rank-5  :88.7%
2025-05-26 19:11:48,084 DeMo.train INFO: CMC curve, Rank-10 :89.6%
2025-05-26 19:11:48,084 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:11:48,092 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:11:48,092 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 19:11:48,092 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/home/ma1/work/demorelated/DeMo/utils/reranking.py:40: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1420.)
  distmat.addmm_(1, -2, feat, feat.t())
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6412
CMC curve: Rank-1: 0.8350, Rank-5: 0.8536, Rank-10: 0.8741
=> Enter reranking
=> Results after reranking:
mAP: 0.6529
CMC curve: Rank-1: 0.8571, Rank-5: 0.8630, Rank-10: 0.8706
=> Improvement:
mAP improvement: 0.0118 (+1.83%)
Rank-1 improvement: 0.0222 (+2.65%)
2025-05-26 19:14:54,149 DeMo.train INFO: Validation Results - Epoch: 1
2025-05-26 19:14:54,150 DeMo.train INFO: mAP: 65.3%
2025-05-26 19:14:54,150 DeMo.train INFO: CMC curve, Rank-1  :85.7%
2025-05-26 19:14:54,150 DeMo.train INFO: CMC curve, Rank-5  :86.3%
2025-05-26 19:14:54,150 DeMo.train INFO: CMC curve, Rank-10 :87.1%
2025-05-26 19:14:54,150 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:14:54,167 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:14:54,167 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 19:14:54,167 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6666
CMC curve: Rank-1: 0.8758, Rank-5: 0.8939, Rank-10: 0.9061
=> Enter reranking
=> Results after reranking:
mAP: 0.6743
CMC curve: Rank-1: 0.8822, Rank-5: 0.8880, Rank-10: 0.8921
=> Improvement:
mAP improvement: 0.0076 (+1.15%)
Rank-1 improvement: 0.0064 (+0.73%)
2025-05-26 19:18:03,643 DeMo.train INFO: Validation Results - Epoch: 1
2025-05-26 19:18:03,643 DeMo.train INFO: mAP: 67.4%
2025-05-26 19:18:03,644 DeMo.train INFO: CMC curve, Rank-1  :88.2%
2025-05-26 19:18:03,644 DeMo.train INFO: CMC curve, Rank-5  :88.8%
2025-05-26 19:18:03,644 DeMo.train INFO: CMC curve, Rank-10 :89.2%
2025-05-26 19:18:03,644 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:18:11,538 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:18:11,539 DeMo.train INFO: Best mAP: 67.4%
2025-05-26 19:18:11,539 DeMo.train INFO: Best Rank-1: 88.2%
2025-05-26 19:18:11,539 DeMo.train INFO: Best Rank-5: 88.8%
2025-05-26 19:18:11,539 DeMo.train INFO: Best Rank-10: 89.2%
2025-05-26 19:18:11,539 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:18:29,063 DeMo.train INFO: Epoch[2] Iteration[10/65] Loss: 5.864, Acc: 0.525, Base Lr: 1.61e-04
2025-05-26 19:18:42,281 DeMo.train INFO: Epoch[2] Iteration[20/65] Loss: 5.462, Acc: 0.559, Base Lr: 1.61e-04
2025-05-26 19:18:55,425 DeMo.train INFO: Epoch[2] Iteration[30/65] Loss: 5.231, Acc: 0.557, Base Lr: 1.61e-04
2025-05-26 19:19:08,602 DeMo.train INFO: Epoch[2] Iteration[40/65] Loss: 4.982, Acc: 0.595, Base Lr: 1.61e-04
2025-05-26 19:19:21,772 DeMo.train INFO: Epoch[2] Iteration[50/65] Loss: 4.820, Acc: 0.638, Base Lr: 1.61e-04
2025-05-26 19:19:34,956 DeMo.train INFO: Epoch[2] Iteration[60/65] Loss: 4.626, Acc: 0.681, Base Lr: 1.61e-04
2025-05-26 19:19:37,720 DeMo.train INFO: Epoch 2 done. Time per batch: 1.390[s] Speed: 92.1[samples/s]
2025-05-26 19:19:37,733 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:19:37,733 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 19:19:37,733 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6647
CMC curve: Rank-1: 0.8496, Rank-5: 0.8682, Rank-10: 0.8851
=> Enter reranking
=> Results after reranking:
mAP: 0.6688
CMC curve: Rank-1: 0.8466, Rank-5: 0.8554, Rank-10: 0.8729
=> Improvement:
mAP improvement: 0.0040 (+0.61%)
Rank-1 improvement: -0.0029 (-0.34%)
2025-05-26 19:22:43,442 DeMo.train INFO: Validation Results - Epoch: 2
2025-05-26 19:22:43,443 DeMo.train INFO: mAP: 66.9%
2025-05-26 19:22:43,443 DeMo.train INFO: CMC curve, Rank-1  :84.7%
2025-05-26 19:22:43,443 DeMo.train INFO: CMC curve, Rank-5  :85.5%
2025-05-26 19:22:43,443 DeMo.train INFO: CMC curve, Rank-10 :87.3%
2025-05-26 19:22:43,443 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:22:43,956 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:22:43,957 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 19:22:43,957 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6912
CMC curve: Rank-1: 0.8787, Rank-5: 0.9015, Rank-10: 0.9120
=> Enter reranking
=> Results after reranking:
mAP: 0.6988
CMC curve: Rank-1: 0.8840, Rank-5: 0.8945, Rank-10: 0.9003
=> Improvement:
mAP improvement: 0.0075 (+1.09%)
Rank-1 improvement: 0.0052 (+0.60%)
2025-05-26 19:25:50,880 DeMo.train INFO: Validation Results - Epoch: 2
2025-05-26 19:25:50,881 DeMo.train INFO: mAP: 69.9%
2025-05-26 19:25:50,881 DeMo.train INFO: CMC curve, Rank-1  :88.4%
2025-05-26 19:25:50,881 DeMo.train INFO: CMC curve, Rank-5  :89.4%
2025-05-26 19:25:50,881 DeMo.train INFO: CMC curve, Rank-10 :90.0%
2025-05-26 19:25:50,881 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:25:50,895 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:25:50,895 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 19:25:50,895 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6806
CMC curve: Rank-1: 0.8571, Rank-5: 0.8816, Rank-10: 0.9015
=> Enter reranking
=> Results after reranking:
mAP: 0.6866
CMC curve: Rank-1: 0.8676, Rank-5: 0.8805, Rank-10: 0.8968
=> Improvement:
mAP improvement: 0.0061 (+0.89%)
Rank-1 improvement: 0.0105 (+1.22%)
2025-05-26 19:29:04,359 DeMo.train INFO: Validation Results - Epoch: 2
2025-05-26 19:29:04,360 DeMo.train INFO: mAP: 68.7%
2025-05-26 19:29:04,360 DeMo.train INFO: CMC curve, Rank-1  :86.8%
2025-05-26 19:29:04,360 DeMo.train INFO: CMC curve, Rank-5  :88.0%
2025-05-26 19:29:04,360 DeMo.train INFO: CMC curve, Rank-10 :89.7%
2025-05-26 19:29:04,360 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:29:12,464 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:29:12,464 DeMo.train INFO: Best mAP: 68.7%
2025-05-26 19:29:12,464 DeMo.train INFO: Best Rank-1: 86.8%
2025-05-26 19:29:12,464 DeMo.train INFO: Best Rank-5: 88.0%
2025-05-26 19:29:12,464 DeMo.train INFO: Best Rank-10: 89.7%
2025-05-26 19:29:12,464 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:29:29,384 DeMo.train INFO: Epoch[3] Iteration[10/65] Loss: 3.331, Acc: 0.786, Base Lr: 2.24e-04
2025-05-26 19:29:42,509 DeMo.train INFO: Epoch[3] Iteration[20/65] Loss: 3.108, Acc: 0.840, Base Lr: 2.24e-04
2025-05-26 19:29:55,619 DeMo.train INFO: Epoch[3] Iteration[30/65] Loss: 2.878, Acc: 0.866, Base Lr: 2.24e-04
2025-05-26 19:30:08,758 DeMo.train INFO: Epoch[3] Iteration[40/65] Loss: 2.722, Acc: 0.885, Base Lr: 2.24e-04
2025-05-26 19:30:21,934 DeMo.train INFO: Epoch[3] Iteration[50/65] Loss: 2.604, Acc: 0.895, Base Lr: 2.24e-04
2025-05-26 19:30:35,054 DeMo.train INFO: Epoch[3] Iteration[60/65] Loss: 2.541, Acc: 0.905, Base Lr: 2.24e-04
2025-05-26 19:30:39,135 DeMo.train INFO: Epoch 3 done. Time per batch: 1.376[s] Speed: 93.0[samples/s]
2025-05-26 19:30:39,147 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:30:39,148 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 19:30:39,148 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6884
CMC curve: Rank-1: 0.8437, Rank-5: 0.8595, Rank-10: 0.8770
=> Enter reranking
=> Results after reranking:
mAP: 0.6927
CMC curve: Rank-1: 0.8519, Rank-5: 0.8571, Rank-10: 0.8647
=> Improvement:
mAP improvement: 0.0043 (+0.63%)
Rank-1 improvement: 0.0082 (+0.97%)
2025-05-26 19:33:42,468 DeMo.train INFO: Validation Results - Epoch: 3
2025-05-26 19:33:42,468 DeMo.train INFO: mAP: 69.3%
2025-05-26 19:33:42,468 DeMo.train INFO: CMC curve, Rank-1  :85.2%
2025-05-26 19:33:42,468 DeMo.train INFO: CMC curve, Rank-5  :85.7%
2025-05-26 19:33:42,469 DeMo.train INFO: CMC curve, Rank-10 :86.5%
2025-05-26 19:33:42,469 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:33:43,772 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:33:43,772 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 19:33:43,772 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7046
CMC curve: Rank-1: 0.8851, Rank-5: 0.8997, Rank-10: 0.9050
=> Enter reranking
=> Results after reranking:
mAP: 0.7115
CMC curve: Rank-1: 0.8945, Rank-5: 0.9020, Rank-10: 0.9055
=> Improvement:
mAP improvement: 0.0069 (+0.98%)
Rank-1 improvement: 0.0093 (+1.05%)
2025-05-26 19:36:50,480 DeMo.train INFO: Validation Results - Epoch: 3
2025-05-26 19:36:50,481 DeMo.train INFO: mAP: 71.2%
2025-05-26 19:36:50,481 DeMo.train INFO: CMC curve, Rank-1  :89.4%
2025-05-26 19:36:50,481 DeMo.train INFO: CMC curve, Rank-5  :90.2%
2025-05-26 19:36:50,481 DeMo.train INFO: CMC curve, Rank-10 :90.6%
2025-05-26 19:36:50,481 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:36:50,497 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:36:50,497 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 19:36:50,497 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6978
CMC curve: Rank-1: 0.8566, Rank-5: 0.8781, Rank-10: 0.8927
=> Enter reranking
=> Results after reranking:
mAP: 0.7021
CMC curve: Rank-1: 0.8624, Rank-5: 0.8682, Rank-10: 0.8764
=> Improvement:
mAP improvement: 0.0043 (+0.62%)
Rank-1 improvement: 0.0058 (+0.68%)
2025-05-26 19:39:56,079 DeMo.train INFO: Validation Results - Epoch: 3
2025-05-26 19:39:56,080 DeMo.train INFO: mAP: 70.2%
2025-05-26 19:39:56,080 DeMo.train INFO: CMC curve, Rank-1  :86.2%
2025-05-26 19:39:56,080 DeMo.train INFO: CMC curve, Rank-5  :86.8%
2025-05-26 19:39:56,080 DeMo.train INFO: CMC curve, Rank-10 :87.6%
2025-05-26 19:39:56,080 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:40:04,143 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:40:04,143 DeMo.train INFO: Best mAP: 70.2%
2025-05-26 19:40:04,143 DeMo.train INFO: Best Rank-1: 86.2%
2025-05-26 19:40:04,143 DeMo.train INFO: Best Rank-5: 86.8%
2025-05-26 19:40:04,143 DeMo.train INFO: Best Rank-10: 87.6%
2025-05-26 19:40:04,143 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:40:21,770 DeMo.train INFO: Epoch[4] Iteration[10/65] Loss: 2.142, Acc: 0.887, Base Lr: 2.87e-04
2025-05-26 19:40:34,926 DeMo.train INFO: Epoch[4] Iteration[20/65] Loss: 1.874, Acc: 0.938, Base Lr: 2.87e-04
2025-05-26 19:40:48,079 DeMo.train INFO: Epoch[4] Iteration[30/65] Loss: 1.757, Acc: 0.948, Base Lr: 2.87e-04
2025-05-26 19:41:01,222 DeMo.train INFO: Epoch[4] Iteration[40/65] Loss: 1.661, Acc: 0.961, Base Lr: 2.87e-04
2025-05-26 19:41:14,323 DeMo.train INFO: Epoch[4] Iteration[50/65] Loss: 1.592, Acc: 0.964, Base Lr: 2.87e-04
2025-05-26 19:41:27,414 DeMo.train INFO: Epoch[4] Iteration[60/65] Loss: 1.531, Acc: 0.970, Base Lr: 2.87e-04
2025-05-26 19:41:30,189 DeMo.train INFO: Epoch 4 done. Time per batch: 1.388[s] Speed: 92.2[samples/s]
2025-05-26 19:41:30,202 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:41:30,202 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 19:41:30,203 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7759
CMC curve: Rank-1: 0.9096, Rank-5: 0.9306, Rank-10: 0.9423
=> Enter reranking
=> Results after reranking:
mAP: 0.7860
CMC curve: Rank-1: 0.9190, Rank-5: 0.9300, Rank-10: 0.9347
=> Improvement:
mAP improvement: 0.0100 (+1.29%)
Rank-1 improvement: 0.0093 (+1.03%)
2025-05-26 19:44:34,449 DeMo.train INFO: Validation Results - Epoch: 4
2025-05-26 19:44:34,449 DeMo.train INFO: mAP: 78.6%
2025-05-26 19:44:34,450 DeMo.train INFO: CMC curve, Rank-1  :91.9%
2025-05-26 19:44:34,450 DeMo.train INFO: CMC curve, Rank-5  :93.0%
2025-05-26 19:44:34,450 DeMo.train INFO: CMC curve, Rank-10 :93.5%
2025-05-26 19:44:34,450 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:44:35,135 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:44:35,135 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 19:44:35,135 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7828
CMC curve: Rank-1: 0.9271, Rank-5: 0.9405, Rank-10: 0.9440
=> Enter reranking
=> Results after reranking:
mAP: 0.7865
CMC curve: Rank-1: 0.9248, Rank-5: 0.9289, Rank-10: 0.9312
=> Improvement:
mAP improvement: 0.0037 (+0.48%)
Rank-1 improvement: -0.0023 (-0.25%)
2025-05-26 19:47:42,607 DeMo.train INFO: Validation Results - Epoch: 4
2025-05-26 19:47:42,607 DeMo.train INFO: mAP: 78.7%
2025-05-26 19:47:42,608 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 19:47:42,608 DeMo.train INFO: CMC curve, Rank-5  :92.9%
2025-05-26 19:47:42,608 DeMo.train INFO: CMC curve, Rank-10 :93.1%
2025-05-26 19:47:42,608 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:47:42,622 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:47:42,622 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 19:47:42,622 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7812
CMC curve: Rank-1: 0.9178, Rank-5: 0.9359, Rank-10: 0.9446
=> Enter reranking
=> Results after reranking:
mAP: 0.7901
CMC curve: Rank-1: 0.9236, Rank-5: 0.9324, Rank-10: 0.9376
=> Improvement:
mAP improvement: 0.0089 (+1.14%)
Rank-1 improvement: 0.0058 (+0.64%)
2025-05-26 19:50:47,521 DeMo.train INFO: Validation Results - Epoch: 4
2025-05-26 19:50:47,522 DeMo.train INFO: mAP: 79.0%
2025-05-26 19:50:47,522 DeMo.train INFO: CMC curve, Rank-1  :92.4%
2025-05-26 19:50:47,522 DeMo.train INFO: CMC curve, Rank-5  :93.2%
2025-05-26 19:50:47,522 DeMo.train INFO: CMC curve, Rank-10 :93.8%
2025-05-26 19:50:47,522 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:50:55,661 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:50:55,662 DeMo.train INFO: Best mAP: 79.0%
2025-05-26 19:50:55,662 DeMo.train INFO: Best Rank-1: 92.4%
2025-05-26 19:50:55,662 DeMo.train INFO: Best Rank-5: 93.2%
2025-05-26 19:50:55,662 DeMo.train INFO: Best Rank-10: 93.8%
2025-05-26 19:50:55,662 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:51:12,243 DeMo.train INFO: Epoch[5] Iteration[10/65] Loss: 1.182, Acc: 0.995, Base Lr: 3.27e-04
2025-05-26 19:51:25,526 DeMo.train INFO: Epoch[5] Iteration[20/65] Loss: 1.181, Acc: 0.995, Base Lr: 3.27e-04
2025-05-26 19:51:38,645 DeMo.train INFO: Epoch[5] Iteration[30/65] Loss: 1.138, Acc: 0.990, Base Lr: 3.27e-04
2025-05-26 19:51:52,094 DeMo.train INFO: Epoch[5] Iteration[40/65] Loss: 1.115, Acc: 0.980, Base Lr: 3.27e-04
2025-05-26 19:52:05,205 DeMo.train INFO: Epoch[5] Iteration[50/65] Loss: 1.090, Acc: 0.982, Base Lr: 3.27e-04
2025-05-26 19:52:18,380 DeMo.train INFO: Epoch[5] Iteration[60/65] Loss: 1.068, Acc: 0.985, Base Lr: 3.27e-04
2025-05-26 19:52:22,445 DeMo.train INFO: Epoch 5 done. Time per batch: 1.378[s] Speed: 92.9[samples/s]
2025-05-26 19:52:22,457 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:52:22,457 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 19:52:22,457 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7754
CMC curve: Rank-1: 0.9131, Rank-5: 0.9306, Rank-10: 0.9370
=> Enter reranking
=> Results after reranking:
mAP: 0.7816
CMC curve: Rank-1: 0.9102, Rank-5: 0.9166, Rank-10: 0.9219
=> Improvement:
mAP improvement: 0.0062 (+0.81%)
Rank-1 improvement: -0.0029 (-0.32%)
2025-05-26 19:55:30,834 DeMo.train INFO: Validation Results - Epoch: 5
2025-05-26 19:55:30,835 DeMo.train INFO: mAP: 78.2%
2025-05-26 19:55:30,835 DeMo.train INFO: CMC curve, Rank-1  :91.0%
2025-05-26 19:55:30,835 DeMo.train INFO: CMC curve, Rank-5  :91.7%
2025-05-26 19:55:30,835 DeMo.train INFO: CMC curve, Rank-10 :92.2%
2025-05-26 19:55:30,835 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:55:31,433 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:55:31,433 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 19:55:31,433 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7781
CMC curve: Rank-1: 0.9207, Rank-5: 0.9300, Rank-10: 0.9411
=> Enter reranking
=> Results after reranking:
mAP: 0.7795
CMC curve: Rank-1: 0.9032, Rank-5: 0.9079, Rank-10: 0.9178
=> Improvement:
mAP improvement: 0.0014 (+0.18%)
Rank-1 improvement: -0.0175 (-1.90%)
2025-05-26 19:58:37,565 DeMo.train INFO: Validation Results - Epoch: 5
2025-05-26 19:58:37,565 DeMo.train INFO: mAP: 78.0%
2025-05-26 19:58:37,565 DeMo.train INFO: CMC curve, Rank-1  :90.3%
2025-05-26 19:58:37,565 DeMo.train INFO: CMC curve, Rank-5  :90.8%
2025-05-26 19:58:37,565 DeMo.train INFO: CMC curve, Rank-10 :91.8%
2025-05-26 19:58:37,566 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:58:37,579 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 19:58:37,579 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 19:58:37,579 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7800
CMC curve: Rank-1: 0.9207, Rank-5: 0.9318, Rank-10: 0.9394
=> Enter reranking
=> Results after reranking:
mAP: 0.7854
CMC curve: Rank-1: 0.9143, Rank-5: 0.9201, Rank-10: 0.9248
=> Improvement:
mAP improvement: 0.0054 (+0.69%)
Rank-1 improvement: -0.0064 (-0.70%)
2025-05-26 20:01:44,200 DeMo.train INFO: Validation Results - Epoch: 5
2025-05-26 20:01:44,200 DeMo.train INFO: mAP: 78.5%
2025-05-26 20:01:44,200 DeMo.train INFO: CMC curve, Rank-1  :91.4%
2025-05-26 20:01:44,201 DeMo.train INFO: CMC curve, Rank-5  :92.0%
2025-05-26 20:01:44,201 DeMo.train INFO: CMC curve, Rank-10 :92.5%
2025-05-26 20:01:44,201 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:01:44,237 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:01:44,237 DeMo.train INFO: Best mAP: 79.0%
2025-05-26 20:01:44,237 DeMo.train INFO: Best Rank-1: 92.4%
2025-05-26 20:01:44,237 DeMo.train INFO: Best Rank-5: 93.2%
2025-05-26 20:01:44,237 DeMo.train INFO: Best Rank-10: 93.8%
2025-05-26 20:01:44,237 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:02:01,435 DeMo.train INFO: Epoch[6] Iteration[10/65] Loss: 0.959, Acc: 0.979, Base Lr: 3.17e-04
2025-05-26 20:02:14,520 DeMo.train INFO: Epoch[6] Iteration[20/65] Loss: 0.931, Acc: 0.984, Base Lr: 3.17e-04
2025-05-26 20:02:27,634 DeMo.train INFO: Epoch[6] Iteration[30/65] Loss: 0.918, Acc: 0.989, Base Lr: 3.17e-04
2025-05-26 20:02:40,837 DeMo.train INFO: Epoch[6] Iteration[40/65] Loss: 0.903, Acc: 0.991, Base Lr: 3.17e-04
2025-05-26 20:02:53,919 DeMo.train INFO: Epoch[6] Iteration[50/65] Loss: 0.892, Acc: 0.993, Base Lr: 3.17e-04
2025-05-26 20:03:07,043 DeMo.train INFO: Epoch[6] Iteration[60/65] Loss: 0.882, Acc: 0.994, Base Lr: 3.17e-04
2025-05-26 20:03:11,115 DeMo.train INFO: Epoch 6 done. Time per batch: 1.379[s] Speed: 92.8[samples/s]
2025-05-26 20:03:11,127 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:03:11,127 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 20:03:11,128 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7821
CMC curve: Rank-1: 0.9166, Rank-5: 0.9300, Rank-10: 0.9359
=> Enter reranking
=> Results after reranking:
mAP: 0.7905
CMC curve: Rank-1: 0.9283, Rank-5: 0.9294, Rank-10: 0.9318
=> Improvement:
mAP improvement: 0.0084 (+1.08%)
Rank-1 improvement: 0.0117 (+1.27%)
2025-05-26 20:06:18,122 DeMo.train INFO: Validation Results - Epoch: 6
2025-05-26 20:06:18,123 DeMo.train INFO: mAP: 79.1%
2025-05-26 20:06:18,123 DeMo.train INFO: CMC curve, Rank-1  :92.8%
2025-05-26 20:06:18,123 DeMo.train INFO: CMC curve, Rank-5  :92.9%
2025-05-26 20:06:18,123 DeMo.train INFO: CMC curve, Rank-10 :93.2%
2025-05-26 20:06:18,123 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:06:19,703 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:06:19,703 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 20:06:19,703 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7761
CMC curve: Rank-1: 0.9125, Rank-5: 0.9265, Rank-10: 0.9370
=> Enter reranking
=> Results after reranking:
mAP: 0.7801
CMC curve: Rank-1: 0.9125, Rank-5: 0.9160, Rank-10: 0.9242
=> Improvement:
mAP improvement: 0.0040 (+0.51%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-26 20:09:27,298 DeMo.train INFO: Validation Results - Epoch: 6
2025-05-26 20:09:27,298 DeMo.train INFO: mAP: 78.0%
2025-05-26 20:09:27,299 DeMo.train INFO: CMC curve, Rank-1  :91.3%
2025-05-26 20:09:27,299 DeMo.train INFO: CMC curve, Rank-5  :91.6%
2025-05-26 20:09:27,299 DeMo.train INFO: CMC curve, Rank-10 :92.4%
2025-05-26 20:09:27,299 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:09:27,313 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:09:27,313 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 20:09:27,313 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7870
CMC curve: Rank-1: 0.9219, Rank-5: 0.9341, Rank-10: 0.9399
=> Enter reranking
=> Results after reranking:
mAP: 0.7933
CMC curve: Rank-1: 0.9271, Rank-5: 0.9294, Rank-10: 0.9306
=> Improvement:
mAP improvement: 0.0063 (+0.80%)
Rank-1 improvement: 0.0052 (+0.57%)
2025-05-26 20:12:33,052 DeMo.train INFO: Validation Results - Epoch: 6
2025-05-26 20:12:33,053 DeMo.train INFO: mAP: 79.3%
2025-05-26 20:12:33,053 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 20:12:33,053 DeMo.train INFO: CMC curve, Rank-5  :92.9%
2025-05-26 20:12:33,053 DeMo.train INFO: CMC curve, Rank-10 :93.1%
2025-05-26 20:12:33,053 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:12:41,375 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:12:41,375 DeMo.train INFO: Best mAP: 79.3%
2025-05-26 20:12:41,375 DeMo.train INFO: Best Rank-1: 92.7%
2025-05-26 20:12:41,375 DeMo.train INFO: Best Rank-5: 92.9%
2025-05-26 20:12:41,375 DeMo.train INFO: Best Rank-10: 93.1%
2025-05-26 20:12:41,375 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:12:58,018 DeMo.train INFO: Epoch[7] Iteration[10/65] Loss: 0.839, Acc: 0.999, Base Lr: 3.05e-04
2025-05-26 20:13:11,137 DeMo.train INFO: Epoch[7] Iteration[20/65] Loss: 0.835, Acc: 0.999, Base Lr: 3.05e-04
2025-05-26 20:13:24,221 DeMo.train INFO: Epoch[7] Iteration[30/65] Loss: 0.834, Acc: 0.999, Base Lr: 3.05e-04
2025-05-26 20:13:37,414 DeMo.train INFO: Epoch[7] Iteration[40/65] Loss: 0.830, Acc: 1.000, Base Lr: 3.05e-04
2025-05-26 20:13:50,516 DeMo.train INFO: Epoch[7] Iteration[50/65] Loss: 0.828, Acc: 1.000, Base Lr: 3.05e-04
2025-05-26 20:14:03,600 DeMo.train INFO: Epoch[7] Iteration[60/65] Loss: 0.826, Acc: 1.000, Base Lr: 3.05e-04
2025-05-26 20:14:07,677 DeMo.train INFO: Epoch 7 done. Time per batch: 1.370[s] Speed: 93.4[samples/s]
2025-05-26 20:14:07,691 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:14:07,691 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 20:14:07,691 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7825
CMC curve: Rank-1: 0.9184, Rank-5: 0.9324, Rank-10: 0.9382
=> Enter reranking
=> Results after reranking:
mAP: 0.7899
CMC curve: Rank-1: 0.9271, Rank-5: 0.9347, Rank-10: 0.9370
=> Improvement:
mAP improvement: 0.0074 (+0.95%)
Rank-1 improvement: 0.0087 (+0.95%)
2025-05-26 20:17:14,805 DeMo.train INFO: Validation Results - Epoch: 7
2025-05-26 20:17:14,805 DeMo.train INFO: mAP: 79.0%
2025-05-26 20:17:14,805 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 20:17:14,806 DeMo.train INFO: CMC curve, Rank-5  :93.5%
2025-05-26 20:17:14,806 DeMo.train INFO: CMC curve, Rank-10 :93.7%
2025-05-26 20:17:14,806 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:17:15,632 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:17:15,632 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 20:17:15,632 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7676
CMC curve: Rank-1: 0.9114, Rank-5: 0.9254, Rank-10: 0.9329
=> Enter reranking
=> Results after reranking:
mAP: 0.7730
CMC curve: Rank-1: 0.9108, Rank-5: 0.9160, Rank-10: 0.9207
=> Improvement:
mAP improvement: 0.0053 (+0.70%)
Rank-1 improvement: -0.0006 (-0.06%)
2025-05-26 20:20:24,238 DeMo.train INFO: Validation Results - Epoch: 7
2025-05-26 20:20:24,239 DeMo.train INFO: mAP: 77.3%
2025-05-26 20:20:24,239 DeMo.train INFO: CMC curve, Rank-1  :91.1%
2025-05-26 20:20:24,239 DeMo.train INFO: CMC curve, Rank-5  :91.6%
2025-05-26 20:20:24,239 DeMo.train INFO: CMC curve, Rank-10 :92.1%
2025-05-26 20:20:24,239 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:20:24,253 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:20:24,254 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 20:20:24,254 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7859
CMC curve: Rank-1: 0.9259, Rank-5: 0.9388, Rank-10: 0.9434
=> Enter reranking
=> Results after reranking:
mAP: 0.7912
CMC curve: Rank-1: 0.9236, Rank-5: 0.9283, Rank-10: 0.9289
=> Improvement:
mAP improvement: 0.0053 (+0.68%)
Rank-1 improvement: -0.0023 (-0.25%)
2025-05-26 20:23:30,739 DeMo.train INFO: Validation Results - Epoch: 7
2025-05-26 20:23:30,739 DeMo.train INFO: mAP: 79.1%
2025-05-26 20:23:30,740 DeMo.train INFO: CMC curve, Rank-1  :92.4%
2025-05-26 20:23:30,740 DeMo.train INFO: CMC curve, Rank-5  :92.8%
2025-05-26 20:23:30,740 DeMo.train INFO: CMC curve, Rank-10 :92.9%
2025-05-26 20:23:30,740 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:23:31,462 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:23:31,463 DeMo.train INFO: Best mAP: 79.3%
2025-05-26 20:23:31,463 DeMo.train INFO: Best Rank-1: 92.7%
2025-05-26 20:23:31,463 DeMo.train INFO: Best Rank-5: 92.9%
2025-05-26 20:23:31,463 DeMo.train INFO: Best Rank-10: 93.1%
2025-05-26 20:23:31,463 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:23:47,681 DeMo.train INFO: Epoch[8] Iteration[10/65] Loss: 0.816, Acc: 1.000, Base Lr: 2.92e-04
2025-05-26 20:24:00,850 DeMo.train INFO: Epoch[8] Iteration[20/65] Loss: 0.813, Acc: 1.000, Base Lr: 2.92e-04
2025-05-26 20:24:13,988 DeMo.train INFO: Epoch[8] Iteration[30/65] Loss: 0.811, Acc: 1.000, Base Lr: 2.92e-04
2025-05-26 20:24:27,120 DeMo.train INFO: Epoch[8] Iteration[40/65] Loss: 0.808, Acc: 1.000, Base Lr: 2.92e-04
2025-05-26 20:24:40,208 DeMo.train INFO: Epoch[8] Iteration[50/65] Loss: 0.804, Acc: 1.000, Base Lr: 2.92e-04
2025-05-26 20:24:53,325 DeMo.train INFO: Epoch[8] Iteration[60/65] Loss: 0.803, Acc: 1.000, Base Lr: 2.92e-04
2025-05-26 20:24:57,421 DeMo.train INFO: Epoch 8 done. Time per batch: 1.364[s] Speed: 93.8[samples/s]
2025-05-26 20:24:57,434 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:24:57,434 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 20:24:57,434 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7837
CMC curve: Rank-1: 0.9190, Rank-5: 0.9306, Rank-10: 0.9399
=> Enter reranking
=> Results after reranking:
mAP: 0.7914
CMC curve: Rank-1: 0.9265, Rank-5: 0.9306, Rank-10: 0.9329
=> Improvement:
mAP improvement: 0.0077 (+0.98%)
Rank-1 improvement: 0.0076 (+0.82%)
2025-05-26 20:28:04,158 DeMo.train INFO: Validation Results - Epoch: 8
2025-05-26 20:28:04,159 DeMo.train INFO: mAP: 79.1%
2025-05-26 20:28:04,159 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 20:28:04,159 DeMo.train INFO: CMC curve, Rank-5  :93.1%
2025-05-26 20:28:04,159 DeMo.train INFO: CMC curve, Rank-10 :93.3%
2025-05-26 20:28:04,159 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:28:05,481 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:28:05,481 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 20:28:05,481 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7693
CMC curve: Rank-1: 0.9143, Rank-5: 0.9259, Rank-10: 0.9359
=> Enter reranking
=> Results after reranking:
mAP: 0.7735
CMC curve: Rank-1: 0.9067, Rank-5: 0.9114, Rank-10: 0.9201
=> Improvement:
mAP improvement: 0.0042 (+0.54%)
Rank-1 improvement: -0.0076 (-0.83%)
2025-05-26 20:31:13,406 DeMo.train INFO: Validation Results - Epoch: 8
2025-05-26 20:31:13,406 DeMo.train INFO: mAP: 77.3%
2025-05-26 20:31:13,407 DeMo.train INFO: CMC curve, Rank-1  :90.7%
2025-05-26 20:31:13,407 DeMo.train INFO: CMC curve, Rank-5  :91.1%
2025-05-26 20:31:13,407 DeMo.train INFO: CMC curve, Rank-10 :92.0%
2025-05-26 20:31:13,407 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:31:13,423 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:31:13,423 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 20:31:13,423 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7868
CMC curve: Rank-1: 0.9248, Rank-5: 0.9353, Rank-10: 0.9411
=> Enter reranking
=> Results after reranking:
mAP: 0.7926
CMC curve: Rank-1: 0.9277, Rank-5: 0.9312, Rank-10: 0.9335
=> Improvement:
mAP improvement: 0.0058 (+0.74%)
Rank-1 improvement: 0.0029 (+0.32%)
2025-05-26 20:34:17,832 DeMo.train INFO: Validation Results - Epoch: 8
2025-05-26 20:34:17,832 DeMo.train INFO: mAP: 79.3%
2025-05-26 20:34:17,832 DeMo.train INFO: CMC curve, Rank-1  :92.8%
2025-05-26 20:34:17,832 DeMo.train INFO: CMC curve, Rank-5  :93.1%
2025-05-26 20:34:17,833 DeMo.train INFO: CMC curve, Rank-10 :93.4%
2025-05-26 20:34:17,833 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:34:18,193 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:34:18,193 DeMo.train INFO: Best mAP: 79.3%
2025-05-26 20:34:18,193 DeMo.train INFO: Best Rank-1: 92.7%
2025-05-26 20:34:18,194 DeMo.train INFO: Best Rank-5: 92.9%
2025-05-26 20:34:18,194 DeMo.train INFO: Best Rank-10: 93.1%
2025-05-26 20:34:18,194 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:34:34,850 DeMo.train INFO: Epoch[9] Iteration[10/65] Loss: 0.798, Acc: 0.999, Base Lr: 2.78e-04
2025-05-26 20:34:47,992 DeMo.train INFO: Epoch[9] Iteration[20/65] Loss: 0.795, Acc: 1.000, Base Lr: 2.78e-04
2025-05-26 20:35:01,210 DeMo.train INFO: Epoch[9] Iteration[30/65] Loss: 0.797, Acc: 1.000, Base Lr: 2.78e-04
2025-05-26 20:35:14,437 DeMo.train INFO: Epoch[9] Iteration[40/65] Loss: 0.795, Acc: 1.000, Base Lr: 2.78e-04
2025-05-26 20:35:27,671 DeMo.train INFO: Epoch[9] Iteration[50/65] Loss: 0.795, Acc: 1.000, Base Lr: 2.78e-04
2025-05-26 20:35:40,823 DeMo.train INFO: Epoch[9] Iteration[60/65] Loss: 0.793, Acc: 1.000, Base Lr: 2.78e-04
2025-05-26 20:35:44,917 DeMo.train INFO: Epoch 9 done. Time per batch: 1.377[s] Speed: 93.0[samples/s]
2025-05-26 20:35:44,930 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:35:44,930 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 20:35:44,930 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7883
CMC curve: Rank-1: 0.9236, Rank-5: 0.9312, Rank-10: 0.9376
=> Enter reranking
=> Results after reranking:
mAP: 0.7946
CMC curve: Rank-1: 0.9259, Rank-5: 0.9300, Rank-10: 0.9324
=> Improvement:
mAP improvement: 0.0063 (+0.80%)
Rank-1 improvement: 0.0023 (+0.25%)
2025-05-26 20:38:47,105 DeMo.train INFO: Validation Results - Epoch: 9
2025-05-26 20:38:47,106 DeMo.train INFO: mAP: 79.5%
2025-05-26 20:38:47,106 DeMo.train INFO: CMC curve, Rank-1  :92.6%
2025-05-26 20:38:47,106 DeMo.train INFO: CMC curve, Rank-5  :93.0%
2025-05-26 20:38:47,106 DeMo.train INFO: CMC curve, Rank-10 :93.2%
2025-05-26 20:38:47,106 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:38:48,734 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:38:48,734 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 20:38:48,734 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7667
CMC curve: Rank-1: 0.9166, Rank-5: 0.9312, Rank-10: 0.9382
=> Enter reranking
=> Results after reranking:
mAP: 0.7716
CMC curve: Rank-1: 0.9120, Rank-5: 0.9160, Rank-10: 0.9248
=> Improvement:
mAP improvement: 0.0049 (+0.64%)
Rank-1 improvement: -0.0047 (-0.51%)
2025-05-26 20:41:51,677 DeMo.train INFO: Validation Results - Epoch: 9
2025-05-26 20:41:51,677 DeMo.train INFO: mAP: 77.2%
2025-05-26 20:41:51,677 DeMo.train INFO: CMC curve, Rank-1  :91.2%
2025-05-26 20:41:51,677 DeMo.train INFO: CMC curve, Rank-5  :91.6%
2025-05-26 20:41:51,677 DeMo.train INFO: CMC curve, Rank-10 :92.5%
2025-05-26 20:41:51,678 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:41:51,692 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:41:51,692 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 20:41:51,692 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7903
CMC curve: Rank-1: 0.9236, Rank-5: 0.9341, Rank-10: 0.9417
=> Enter reranking
=> Results after reranking:
mAP: 0.7960
CMC curve: Rank-1: 0.9318, Rank-5: 0.9353, Rank-10: 0.9382
=> Improvement:
mAP improvement: 0.0057 (+0.73%)
Rank-1 improvement: 0.0082 (+0.88%)
2025-05-26 20:44:54,944 DeMo.train INFO: Validation Results - Epoch: 9
2025-05-26 20:44:54,945 DeMo.train INFO: mAP: 79.6%
2025-05-26 20:44:54,945 DeMo.train INFO: CMC curve, Rank-1  :93.2%
2025-05-26 20:44:54,945 DeMo.train INFO: CMC curve, Rank-5  :93.5%
2025-05-26 20:44:54,945 DeMo.train INFO: CMC curve, Rank-10 :93.8%
2025-05-26 20:44:54,945 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:45:03,586 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:45:03,586 DeMo.train INFO: Best mAP: 79.6%
2025-05-26 20:45:03,586 DeMo.train INFO: Best Rank-1: 93.2%
2025-05-26 20:45:03,586 DeMo.train INFO: Best Rank-5: 93.5%
2025-05-26 20:45:03,586 DeMo.train INFO: Best Rank-10: 93.8%
2025-05-26 20:45:03,586 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:45:20,101 DeMo.train INFO: Epoch[10] Iteration[10/65] Loss: 0.782, Acc: 1.000, Base Lr: 2.63e-04
2025-05-26 20:45:33,186 DeMo.train INFO: Epoch[10] Iteration[20/65] Loss: 0.781, Acc: 1.000, Base Lr: 2.63e-04
2025-05-26 20:45:46,261 DeMo.train INFO: Epoch[10] Iteration[30/65] Loss: 0.780, Acc: 1.000, Base Lr: 2.63e-04
2025-05-26 20:45:59,345 DeMo.train INFO: Epoch[10] Iteration[40/65] Loss: 0.778, Acc: 1.000, Base Lr: 2.63e-04
2025-05-26 20:46:12,425 DeMo.train INFO: Epoch[10] Iteration[50/65] Loss: 0.776, Acc: 1.000, Base Lr: 2.63e-04
2025-05-26 20:46:25,578 DeMo.train INFO: Epoch[10] Iteration[60/65] Loss: 0.776, Acc: 1.000, Base Lr: 2.63e-04
2025-05-26 20:46:29,662 DeMo.train INFO: Epoch 10 done. Time per batch: 1.366[s] Speed: 93.7[samples/s]
2025-05-26 20:46:29,676 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:46:29,676 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 20:46:29,676 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7893
CMC curve: Rank-1: 0.9219, Rank-5: 0.9312, Rank-10: 0.9376
=> Enter reranking
=> Results after reranking:
mAP: 0.7962
CMC curve: Rank-1: 0.9248, Rank-5: 0.9294, Rank-10: 0.9359
=> Improvement:
mAP improvement: 0.0070 (+0.88%)
Rank-1 improvement: 0.0029 (+0.32%)
2025-05-26 20:49:31,089 DeMo.train INFO: Validation Results - Epoch: 10
2025-05-26 20:49:31,089 DeMo.train INFO: mAP: 79.6%
2025-05-26 20:49:31,089 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 20:49:31,089 DeMo.train INFO: CMC curve, Rank-5  :92.9%
2025-05-26 20:49:31,089 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 20:49:31,089 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:49:32,109 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:49:32,109 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 20:49:32,109 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7709
CMC curve: Rank-1: 0.9079, Rank-5: 0.9184, Rank-10: 0.9254
=> Enter reranking
=> Results after reranking:
mAP: 0.7759
CMC curve: Rank-1: 0.9120, Rank-5: 0.9155, Rank-10: 0.9201
=> Improvement:
mAP improvement: 0.0050 (+0.64%)
Rank-1 improvement: 0.0041 (+0.45%)
2025-05-26 20:52:34,278 DeMo.train INFO: Validation Results - Epoch: 10
2025-05-26 20:52:34,278 DeMo.train INFO: mAP: 77.6%
2025-05-26 20:52:34,278 DeMo.train INFO: CMC curve, Rank-1  :91.2%
2025-05-26 20:52:34,279 DeMo.train INFO: CMC curve, Rank-5  :91.5%
2025-05-26 20:52:34,279 DeMo.train INFO: CMC curve, Rank-10 :92.0%
2025-05-26 20:52:34,279 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:52:34,292 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:52:34,292 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 20:52:34,292 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7919
CMC curve: Rank-1: 0.9242, Rank-5: 0.9353, Rank-10: 0.9417
=> Enter reranking
=> Results after reranking:
mAP: 0.7977
CMC curve: Rank-1: 0.9277, Rank-5: 0.9329, Rank-10: 0.9359
=> Improvement:
mAP improvement: 0.0058 (+0.73%)
Rank-1 improvement: 0.0035 (+0.38%)
2025-05-26 20:55:39,174 DeMo.train INFO: Validation Results - Epoch: 10
2025-05-26 20:55:39,175 DeMo.train INFO: mAP: 79.8%
2025-05-26 20:55:39,175 DeMo.train INFO: CMC curve, Rank-1  :92.8%
2025-05-26 20:55:39,175 DeMo.train INFO: CMC curve, Rank-5  :93.3%
2025-05-26 20:55:39,175 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 20:55:39,175 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:55:47,197 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:55:47,197 DeMo.train INFO: Best mAP: 79.8%
2025-05-26 20:55:47,197 DeMo.train INFO: Best Rank-1: 92.8%
2025-05-26 20:55:47,197 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 20:55:47,197 DeMo.train INFO: Best Rank-10: 93.6%
2025-05-26 20:55:47,197 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:56:03,741 DeMo.train INFO: Epoch[11] Iteration[10/65] Loss: 0.779, Acc: 1.000, Base Lr: 2.46e-04
2025-05-26 20:56:16,806 DeMo.train INFO: Epoch[11] Iteration[20/65] Loss: 0.777, Acc: 1.000, Base Lr: 2.46e-04
2025-05-26 20:56:29,963 DeMo.train INFO: Epoch[11] Iteration[30/65] Loss: 0.773, Acc: 1.000, Base Lr: 2.46e-04
2025-05-26 20:56:43,051 DeMo.train INFO: Epoch[11] Iteration[40/65] Loss: 0.772, Acc: 1.000, Base Lr: 2.46e-04
2025-05-26 20:56:56,137 DeMo.train INFO: Epoch[11] Iteration[50/65] Loss: 0.771, Acc: 1.000, Base Lr: 2.46e-04
2025-05-26 20:57:09,272 DeMo.train INFO: Epoch[11] Iteration[60/65] Loss: 0.770, Acc: 1.000, Base Lr: 2.46e-04
2025-05-26 20:57:13,357 DeMo.train INFO: Epoch 11 done. Time per batch: 1.368[s] Speed: 93.6[samples/s]
2025-05-26 20:57:13,369 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 20:57:13,369 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 20:57:13,369 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7892
CMC curve: Rank-1: 0.9213, Rank-5: 0.9312, Rank-10: 0.9364
=> Enter reranking
=> Results after reranking:
mAP: 0.7958
CMC curve: Rank-1: 0.9265, Rank-5: 0.9318, Rank-10: 0.9353
=> Improvement:
mAP improvement: 0.0066 (+0.84%)
Rank-1 improvement: 0.0052 (+0.57%)
2025-05-26 21:00:15,028 DeMo.train INFO: Validation Results - Epoch: 11
2025-05-26 21:00:15,029 DeMo.train INFO: mAP: 79.6%
2025-05-26 21:00:15,029 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 21:00:15,029 DeMo.train INFO: CMC curve, Rank-5  :93.2%
2025-05-26 21:00:15,029 DeMo.train INFO: CMC curve, Rank-10 :93.5%
2025-05-26 21:00:15,029 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:00:16,619 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:00:16,620 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 21:00:16,620 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7689
CMC curve: Rank-1: 0.9096, Rank-5: 0.9190, Rank-10: 0.9236
=> Enter reranking
=> Results after reranking:
mAP: 0.7741
CMC curve: Rank-1: 0.9120, Rank-5: 0.9149, Rank-10: 0.9195
=> Improvement:
mAP improvement: 0.0053 (+0.68%)
Rank-1 improvement: 0.0023 (+0.26%)
2025-05-26 21:03:18,779 DeMo.train INFO: Validation Results - Epoch: 11
2025-05-26 21:03:18,780 DeMo.train INFO: mAP: 77.4%
2025-05-26 21:03:18,780 DeMo.train INFO: CMC curve, Rank-1  :91.2%
2025-05-26 21:03:18,780 DeMo.train INFO: CMC curve, Rank-5  :91.5%
2025-05-26 21:03:18,780 DeMo.train INFO: CMC curve, Rank-10 :92.0%
2025-05-26 21:03:18,780 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:03:18,794 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:03:18,795 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 21:03:18,795 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7916
CMC curve: Rank-1: 0.9213, Rank-5: 0.9329, Rank-10: 0.9405
=> Enter reranking
=> Results after reranking:
mAP: 0.7968
CMC curve: Rank-1: 0.9219, Rank-5: 0.9283, Rank-10: 0.9329
=> Improvement:
mAP improvement: 0.0052 (+0.66%)
Rank-1 improvement: 0.0006 (+0.06%)
2025-05-26 21:06:22,446 DeMo.train INFO: Validation Results - Epoch: 11
2025-05-26 21:06:22,446 DeMo.train INFO: mAP: 79.7%
2025-05-26 21:06:22,446 DeMo.train INFO: CMC curve, Rank-1  :92.2%
2025-05-26 21:06:22,446 DeMo.train INFO: CMC curve, Rank-5  :92.8%
2025-05-26 21:06:22,447 DeMo.train INFO: CMC curve, Rank-10 :93.3%
2025-05-26 21:06:22,447 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:06:22,908 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:06:22,908 DeMo.train INFO: Best mAP: 79.8%
2025-05-26 21:06:22,909 DeMo.train INFO: Best Rank-1: 92.8%
2025-05-26 21:06:22,909 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 21:06:22,909 DeMo.train INFO: Best Rank-10: 93.6%
2025-05-26 21:06:22,909 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:06:39,805 DeMo.train INFO: Epoch[12] Iteration[10/65] Loss: 0.771, Acc: 1.000, Base Lr: 2.29e-04
2025-05-26 21:06:52,871 DeMo.train INFO: Epoch[12] Iteration[20/65] Loss: 0.770, Acc: 1.000, Base Lr: 2.29e-04
2025-05-26 21:07:05,907 DeMo.train INFO: Epoch[12] Iteration[30/65] Loss: 0.768, Acc: 1.000, Base Lr: 2.29e-04
2025-05-26 21:07:19,038 DeMo.train INFO: Epoch[12] Iteration[40/65] Loss: 0.766, Acc: 1.000, Base Lr: 2.29e-04
2025-05-26 21:07:32,120 DeMo.train INFO: Epoch[12] Iteration[50/65] Loss: 0.765, Acc: 1.000, Base Lr: 2.29e-04
2025-05-26 21:07:45,215 DeMo.train INFO: Epoch[12] Iteration[60/65] Loss: 0.765, Acc: 1.000, Base Lr: 2.29e-04
2025-05-26 21:07:49,296 DeMo.train INFO: Epoch 12 done. Time per batch: 1.371[s] Speed: 93.3[samples/s]
2025-05-26 21:07:49,309 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:07:49,309 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 21:07:49,309 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7887
CMC curve: Rank-1: 0.9213, Rank-5: 0.9300, Rank-10: 0.9388
=> Enter reranking
=> Results after reranking:
mAP: 0.7953
CMC curve: Rank-1: 0.9289, Rank-5: 0.9335, Rank-10: 0.9382
=> Improvement:
mAP improvement: 0.0065 (+0.83%)
Rank-1 improvement: 0.0076 (+0.82%)
2025-05-26 21:10:50,823 DeMo.train INFO: Validation Results - Epoch: 12
2025-05-26 21:10:50,823 DeMo.train INFO: mAP: 79.5%
2025-05-26 21:10:50,824 DeMo.train INFO: CMC curve, Rank-1  :92.9%
2025-05-26 21:10:50,824 DeMo.train INFO: CMC curve, Rank-5  :93.4%
2025-05-26 21:10:50,824 DeMo.train INFO: CMC curve, Rank-10 :93.8%
2025-05-26 21:10:50,824 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:10:51,344 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:10:51,345 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 21:10:51,345 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7688
CMC curve: Rank-1: 0.9120, Rank-5: 0.9213, Rank-10: 0.9277
=> Enter reranking
=> Results after reranking:
mAP: 0.7736
CMC curve: Rank-1: 0.9108, Rank-5: 0.9125, Rank-10: 0.9184
=> Improvement:
mAP improvement: 0.0047 (+0.62%)
Rank-1 improvement: -0.0012 (-0.13%)
2025-05-26 21:13:54,097 DeMo.train INFO: Validation Results - Epoch: 12
2025-05-26 21:13:54,097 DeMo.train INFO: mAP: 77.4%
2025-05-26 21:13:54,098 DeMo.train INFO: CMC curve, Rank-1  :91.1%
2025-05-26 21:13:54,098 DeMo.train INFO: CMC curve, Rank-5  :91.3%
2025-05-26 21:13:54,098 DeMo.train INFO: CMC curve, Rank-10 :91.8%
2025-05-26 21:13:54,098 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:13:54,112 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:13:54,112 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 21:13:54,112 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7914
CMC curve: Rank-1: 0.9230, Rank-5: 0.9335, Rank-10: 0.9417
=> Enter reranking
=> Results after reranking:
mAP: 0.7968
CMC curve: Rank-1: 0.9242, Rank-5: 0.9306, Rank-10: 0.9347
=> Improvement:
mAP improvement: 0.0054 (+0.69%)
Rank-1 improvement: 0.0012 (+0.13%)
2025-05-26 21:16:58,144 DeMo.train INFO: Validation Results - Epoch: 12
2025-05-26 21:16:58,145 DeMo.train INFO: mAP: 79.7%
2025-05-26 21:16:58,145 DeMo.train INFO: CMC curve, Rank-1  :92.4%
2025-05-26 21:16:58,145 DeMo.train INFO: CMC curve, Rank-5  :93.1%
2025-05-26 21:16:58,145 DeMo.train INFO: CMC curve, Rank-10 :93.5%
2025-05-26 21:16:58,145 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:16:58,484 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:16:58,485 DeMo.train INFO: Best mAP: 79.8%
2025-05-26 21:16:58,485 DeMo.train INFO: Best Rank-1: 92.8%
2025-05-26 21:16:58,485 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 21:16:58,485 DeMo.train INFO: Best Rank-10: 93.6%
2025-05-26 21:16:58,485 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:17:15,008 DeMo.train INFO: Epoch[13] Iteration[10/65] Loss: 0.768, Acc: 1.000, Base Lr: 2.12e-04
2025-05-26 21:17:28,102 DeMo.train INFO: Epoch[13] Iteration[20/65] Loss: 0.766, Acc: 1.000, Base Lr: 2.12e-04
2025-05-26 21:17:41,191 DeMo.train INFO: Epoch[13] Iteration[30/65] Loss: 0.765, Acc: 1.000, Base Lr: 2.12e-04
2025-05-26 21:17:54,302 DeMo.train INFO: Epoch[13] Iteration[40/65] Loss: 0.764, Acc: 1.000, Base Lr: 2.12e-04
2025-05-26 21:18:07,624 DeMo.train INFO: Epoch[13] Iteration[50/65] Loss: 0.763, Acc: 1.000, Base Lr: 2.12e-04
2025-05-26 21:18:20,685 DeMo.train INFO: Epoch[13] Iteration[60/65] Loss: 0.762, Acc: 1.000, Base Lr: 2.12e-04
2025-05-26 21:18:23,497 DeMo.train INFO: Epoch 13 done. Time per batch: 1.371[s] Speed: 93.4[samples/s]
2025-05-26 21:18:23,512 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:18:23,512 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 21:18:23,512 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7882
CMC curve: Rank-1: 0.9195, Rank-5: 0.9300, Rank-10: 0.9376
=> Enter reranking
=> Results after reranking:
mAP: 0.7947
CMC curve: Rank-1: 0.9277, Rank-5: 0.9335, Rank-10: 0.9359
=> Improvement:
mAP improvement: 0.0065 (+0.82%)
Rank-1 improvement: 0.0082 (+0.89%)
2025-05-26 21:21:25,747 DeMo.train INFO: Validation Results - Epoch: 13
2025-05-26 21:21:25,748 DeMo.train INFO: mAP: 79.5%
2025-05-26 21:21:25,748 DeMo.train INFO: CMC curve, Rank-1  :92.8%
2025-05-26 21:21:25,748 DeMo.train INFO: CMC curve, Rank-5  :93.4%
2025-05-26 21:21:25,748 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 21:21:25,748 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:21:26,355 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:21:26,355 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 21:21:26,355 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7708
CMC curve: Rank-1: 0.9067, Rank-5: 0.9190, Rank-10: 0.9271
=> Enter reranking
=> Results after reranking:
mAP: 0.7759
CMC curve: Rank-1: 0.9055, Rank-5: 0.9096, Rank-10: 0.9155
=> Improvement:
mAP improvement: 0.0051 (+0.66%)
Rank-1 improvement: -0.0012 (-0.13%)
2025-05-26 21:24:29,175 DeMo.train INFO: Validation Results - Epoch: 13
2025-05-26 21:24:29,175 DeMo.train INFO: mAP: 77.6%
2025-05-26 21:24:29,175 DeMo.train INFO: CMC curve, Rank-1  :90.6%
2025-05-26 21:24:29,175 DeMo.train INFO: CMC curve, Rank-5  :91.0%
2025-05-26 21:24:29,175 DeMo.train INFO: CMC curve, Rank-10 :91.5%
2025-05-26 21:24:29,175 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:24:29,190 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:24:29,190 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 21:24:29,191 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7910
CMC curve: Rank-1: 0.9242, Rank-5: 0.9341, Rank-10: 0.9411
=> Enter reranking
=> Results after reranking:
mAP: 0.7965
CMC curve: Rank-1: 0.9224, Rank-5: 0.9283, Rank-10: 0.9335
=> Improvement:
mAP improvement: 0.0055 (+0.69%)
Rank-1 improvement: -0.0017 (-0.19%)
2025-05-26 21:27:33,318 DeMo.train INFO: Validation Results - Epoch: 13
2025-05-26 21:27:33,318 DeMo.train INFO: mAP: 79.6%
2025-05-26 21:27:33,319 DeMo.train INFO: CMC curve, Rank-1  :92.2%
2025-05-26 21:27:33,319 DeMo.train INFO: CMC curve, Rank-5  :92.8%
2025-05-26 21:27:33,319 DeMo.train INFO: CMC curve, Rank-10 :93.4%
2025-05-26 21:27:33,319 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:27:33,349 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:27:33,350 DeMo.train INFO: Best mAP: 79.8%
2025-05-26 21:27:33,350 DeMo.train INFO: Best Rank-1: 92.8%
2025-05-26 21:27:33,350 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 21:27:33,350 DeMo.train INFO: Best Rank-10: 93.6%
2025-05-26 21:27:33,350 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:27:50,724 DeMo.train INFO: Epoch[14] Iteration[10/65] Loss: 0.759, Acc: 1.000, Base Lr: 1.93e-04
2025-05-26 21:28:03,790 DeMo.train INFO: Epoch[14] Iteration[20/65] Loss: 0.759, Acc: 1.000, Base Lr: 1.93e-04
2025-05-26 21:28:16,819 DeMo.train INFO: Epoch[14] Iteration[30/65] Loss: 0.759, Acc: 1.000, Base Lr: 1.93e-04
2025-05-26 21:28:29,919 DeMo.train INFO: Epoch[14] Iteration[40/65] Loss: 0.759, Acc: 1.000, Base Lr: 1.93e-04
2025-05-26 21:28:42,992 DeMo.train INFO: Epoch[14] Iteration[50/65] Loss: 0.758, Acc: 1.000, Base Lr: 1.93e-04
2025-05-26 21:28:56,045 DeMo.train INFO: Epoch[14] Iteration[60/65] Loss: 0.757, Acc: 1.000, Base Lr: 1.93e-04
2025-05-26 21:28:58,820 DeMo.train INFO: Epoch 14 done. Time per batch: 1.379[s] Speed: 92.9[samples/s]
2025-05-26 21:28:58,834 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:28:58,834 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 21:28:58,834 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7892
CMC curve: Rank-1: 0.9195, Rank-5: 0.9283, Rank-10: 0.9359
=> Enter reranking
=> Results after reranking:
mAP: 0.7963
CMC curve: Rank-1: 0.9265, Rank-5: 0.9300, Rank-10: 0.9359
=> Improvement:
mAP improvement: 0.0071 (+0.90%)
Rank-1 improvement: 0.0070 (+0.76%)
2025-05-26 21:32:00,625 DeMo.train INFO: Validation Results - Epoch: 14
2025-05-26 21:32:00,625 DeMo.train INFO: mAP: 79.6%
2025-05-26 21:32:00,625 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 21:32:00,625 DeMo.train INFO: CMC curve, Rank-5  :93.0%
2025-05-26 21:32:00,626 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 21:32:00,626 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:32:01,621 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:32:01,621 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 21:32:01,621 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7715
CMC curve: Rank-1: 0.9044, Rank-5: 0.9178, Rank-10: 0.9277
=> Enter reranking
=> Results after reranking:
mAP: 0.7772
CMC curve: Rank-1: 0.9166, Rank-5: 0.9213, Rank-10: 0.9248
=> Improvement:
mAP improvement: 0.0057 (+0.74%)
Rank-1 improvement: 0.0122 (+1.35%)
2025-05-26 21:35:04,909 DeMo.train INFO: Validation Results - Epoch: 14
2025-05-26 21:35:04,909 DeMo.train INFO: mAP: 77.7%
2025-05-26 21:35:04,909 DeMo.train INFO: CMC curve, Rank-1  :91.7%
2025-05-26 21:35:04,910 DeMo.train INFO: CMC curve, Rank-5  :92.1%
2025-05-26 21:35:04,910 DeMo.train INFO: CMC curve, Rank-10 :92.5%
2025-05-26 21:35:04,910 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:35:04,924 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:35:04,924 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 21:35:04,924 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7921
CMC curve: Rank-1: 0.9224, Rank-5: 0.9335, Rank-10: 0.9417
=> Enter reranking
=> Results after reranking:
mAP: 0.7978
CMC curve: Rank-1: 0.9254, Rank-5: 0.9289, Rank-10: 0.9359
=> Improvement:
mAP improvement: 0.0057 (+0.72%)
Rank-1 improvement: 0.0029 (+0.32%)
2025-05-26 21:38:09,282 DeMo.train INFO: Validation Results - Epoch: 14
2025-05-26 21:38:09,283 DeMo.train INFO: mAP: 79.8%
2025-05-26 21:38:09,283 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 21:38:09,283 DeMo.train INFO: CMC curve, Rank-5  :92.9%
2025-05-26 21:38:09,283 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 21:38:09,283 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:38:17,427 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:38:17,427 DeMo.train INFO: Best mAP: 79.8%
2025-05-26 21:38:17,427 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 21:38:17,427 DeMo.train INFO: Best Rank-5: 92.9%
2025-05-26 21:38:17,428 DeMo.train INFO: Best Rank-10: 93.6%
2025-05-26 21:38:17,428 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:38:34,015 DeMo.train INFO: Epoch[15] Iteration[10/65] Loss: 0.761, Acc: 1.000, Base Lr: 1.75e-04
2025-05-26 21:38:47,207 DeMo.train INFO: Epoch[15] Iteration[20/65] Loss: 0.759, Acc: 1.000, Base Lr: 1.75e-04
2025-05-26 21:39:00,298 DeMo.train INFO: Epoch[15] Iteration[30/65] Loss: 0.757, Acc: 1.000, Base Lr: 1.75e-04
2025-05-26 21:39:13,396 DeMo.train INFO: Epoch[15] Iteration[40/65] Loss: 0.756, Acc: 1.000, Base Lr: 1.75e-04
2025-05-26 21:39:26,440 DeMo.train INFO: Epoch[15] Iteration[50/65] Loss: 0.756, Acc: 1.000, Base Lr: 1.75e-04
2025-05-26 21:39:39,584 DeMo.train INFO: Epoch[15] Iteration[60/65] Loss: 0.755, Acc: 1.000, Base Lr: 1.75e-04
2025-05-26 21:39:42,362 DeMo.train INFO: Epoch 15 done. Time per batch: 1.370[s] Speed: 93.4[samples/s]
2025-05-26 21:39:42,376 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:39:42,376 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 21:39:42,376 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7876
CMC curve: Rank-1: 0.9184, Rank-5: 0.9318, Rank-10: 0.9388
=> Enter reranking
=> Results after reranking:
mAP: 0.7950
CMC curve: Rank-1: 0.9265, Rank-5: 0.9329, Rank-10: 0.9399
=> Improvement:
mAP improvement: 0.0074 (+0.95%)
Rank-1 improvement: 0.0082 (+0.89%)
2025-05-26 21:42:45,771 DeMo.train INFO: Validation Results - Epoch: 15
2025-05-26 21:42:45,771 DeMo.train INFO: mAP: 79.5%
2025-05-26 21:42:45,771 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 21:42:45,771 DeMo.train INFO: CMC curve, Rank-5  :93.3%
2025-05-26 21:42:45,771 DeMo.train INFO: CMC curve, Rank-10 :94.0%
2025-05-26 21:42:45,771 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:42:47,186 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:42:47,187 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 21:42:47,187 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7705
CMC curve: Rank-1: 0.9079, Rank-5: 0.9184, Rank-10: 0.9248
=> Enter reranking
=> Results after reranking:
mAP: 0.7757
CMC curve: Rank-1: 0.9090, Rank-5: 0.9131, Rank-10: 0.9155
=> Improvement:
mAP improvement: 0.0052 (+0.67%)
Rank-1 improvement: 0.0012 (+0.13%)
2025-05-26 21:45:50,246 DeMo.train INFO: Validation Results - Epoch: 15
2025-05-26 21:45:50,246 DeMo.train INFO: mAP: 77.6%
2025-05-26 21:45:50,247 DeMo.train INFO: CMC curve, Rank-1  :90.9%
2025-05-26 21:45:50,247 DeMo.train INFO: CMC curve, Rank-5  :91.3%
2025-05-26 21:45:50,247 DeMo.train INFO: CMC curve, Rank-10 :91.5%
2025-05-26 21:45:50,247 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:45:50,261 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:45:50,262 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 21:45:50,262 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7904
CMC curve: Rank-1: 0.9259, Rank-5: 0.9341, Rank-10: 0.9417
=> Enter reranking
=> Results after reranking:
mAP: 0.7963
CMC curve: Rank-1: 0.9271, Rank-5: 0.9335, Rank-10: 0.9394
=> Improvement:
mAP improvement: 0.0059 (+0.75%)
Rank-1 improvement: 0.0012 (+0.13%)
2025-05-26 21:48:56,386 DeMo.train INFO: Validation Results - Epoch: 15
2025-05-26 21:48:56,386 DeMo.train INFO: mAP: 79.6%
2025-05-26 21:48:56,386 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 21:48:56,386 DeMo.train INFO: CMC curve, Rank-5  :93.4%
2025-05-26 21:48:56,386 DeMo.train INFO: CMC curve, Rank-10 :93.9%
2025-05-26 21:48:56,387 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:48:56,888 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:48:56,888 DeMo.train INFO: Best mAP: 79.8%
2025-05-26 21:48:56,888 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 21:48:56,888 DeMo.train INFO: Best Rank-5: 92.9%
2025-05-26 21:48:56,888 DeMo.train INFO: Best Rank-10: 93.6%
2025-05-26 21:48:56,889 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:49:13,172 DeMo.train INFO: Epoch[16] Iteration[10/65] Loss: 0.756, Acc: 1.000, Base Lr: 1.57e-04
2025-05-26 21:49:26,295 DeMo.train INFO: Epoch[16] Iteration[20/65] Loss: 0.757, Acc: 1.000, Base Lr: 1.57e-04
2025-05-26 21:49:39,353 DeMo.train INFO: Epoch[16] Iteration[30/65] Loss: 0.754, Acc: 1.000, Base Lr: 1.57e-04
2025-05-26 21:49:52,435 DeMo.train INFO: Epoch[16] Iteration[40/65] Loss: 0.754, Acc: 1.000, Base Lr: 1.57e-04
2025-05-26 21:50:05,595 DeMo.train INFO: Epoch[16] Iteration[50/65] Loss: 0.754, Acc: 1.000, Base Lr: 1.57e-04
2025-05-26 21:50:18,629 DeMo.train INFO: Epoch[16] Iteration[60/65] Loss: 0.754, Acc: 1.000, Base Lr: 1.57e-04
2025-05-26 21:50:22,698 DeMo.train INFO: Epoch 16 done. Time per batch: 1.362[s] Speed: 94.0[samples/s]
2025-05-26 21:50:22,713 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:50:22,713 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 21:50:22,713 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7889
CMC curve: Rank-1: 0.9178, Rank-5: 0.9318, Rank-10: 0.9388
=> Enter reranking
=> Results after reranking:
mAP: 0.7957
CMC curve: Rank-1: 0.9265, Rank-5: 0.9335, Rank-10: 0.9376
=> Improvement:
mAP improvement: 0.0069 (+0.87%)
Rank-1 improvement: 0.0087 (+0.95%)
2025-05-26 21:53:25,068 DeMo.train INFO: Validation Results - Epoch: 16
2025-05-26 21:53:25,068 DeMo.train INFO: mAP: 79.6%
2025-05-26 21:53:25,068 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 21:53:25,069 DeMo.train INFO: CMC curve, Rank-5  :93.4%
2025-05-26 21:53:25,069 DeMo.train INFO: CMC curve, Rank-10 :93.8%
2025-05-26 21:53:25,069 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:53:25,691 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:53:25,692 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 21:53:25,692 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7570
CMC curve: Rank-1: 0.9207, Rank-5: 0.9399, Rank-10: 0.9475
=> Enter reranking
=> Results after reranking:
mAP: 0.7629
CMC curve: Rank-1: 0.9143, Rank-5: 0.9230, Rank-10: 0.9300
=> Improvement:
mAP improvement: 0.0059 (+0.78%)
Rank-1 improvement: -0.0064 (-0.70%)
2025-05-26 21:56:28,700 DeMo.train INFO: Validation Results - Epoch: 16
2025-05-26 21:56:28,701 DeMo.train INFO: mAP: 76.3%
2025-05-26 21:56:28,701 DeMo.train INFO: CMC curve, Rank-1  :91.4%
2025-05-26 21:56:28,701 DeMo.train INFO: CMC curve, Rank-5  :92.3%
2025-05-26 21:56:28,701 DeMo.train INFO: CMC curve, Rank-10 :93.0%
2025-05-26 21:56:28,701 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:56:28,717 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:56:28,717 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 21:56:28,717 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7887
CMC curve: Rank-1: 0.9207, Rank-5: 0.9329, Rank-10: 0.9417
=> Enter reranking
=> Results after reranking:
mAP: 0.7943
CMC curve: Rank-1: 0.9254, Rank-5: 0.9300, Rank-10: 0.9359
=> Improvement:
mAP improvement: 0.0056 (+0.71%)
Rank-1 improvement: 0.0047 (+0.51%)
2025-05-26 21:59:33,196 DeMo.train INFO: Validation Results - Epoch: 16
2025-05-26 21:59:33,197 DeMo.train INFO: mAP: 79.4%
2025-05-26 21:59:33,197 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 21:59:33,197 DeMo.train INFO: CMC curve, Rank-5  :93.0%
2025-05-26 21:59:33,197 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 21:59:33,197 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:59:33,475 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:59:33,475 DeMo.train INFO: Best mAP: 79.8%
2025-05-26 21:59:33,475 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 21:59:33,475 DeMo.train INFO: Best Rank-5: 92.9%
2025-05-26 21:59:33,475 DeMo.train INFO: Best Rank-10: 93.6%
2025-05-26 21:59:33,475 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 21:59:49,884 DeMo.train INFO: Epoch[17] Iteration[10/65] Loss: 0.763, Acc: 0.999, Base Lr: 1.39e-04
2025-05-26 22:00:03,024 DeMo.train INFO: Epoch[17] Iteration[20/65] Loss: 0.757, Acc: 1.000, Base Lr: 1.39e-04
2025-05-26 22:00:16,191 DeMo.train INFO: Epoch[17] Iteration[30/65] Loss: 0.755, Acc: 1.000, Base Lr: 1.39e-04
2025-05-26 22:00:29,298 DeMo.train INFO: Epoch[17] Iteration[40/65] Loss: 0.755, Acc: 1.000, Base Lr: 1.39e-04
2025-05-26 22:00:42,441 DeMo.train INFO: Epoch[17] Iteration[50/65] Loss: 0.753, Acc: 1.000, Base Lr: 1.39e-04
2025-05-26 22:00:55,625 DeMo.train INFO: Epoch[17] Iteration[60/65] Loss: 0.752, Acc: 1.000, Base Lr: 1.39e-04
2025-05-26 22:00:58,411 DeMo.train INFO: Epoch 17 done. Time per batch: 1.370[s] Speed: 93.4[samples/s]
2025-05-26 22:00:58,423 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:00:58,424 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 22:00:58,424 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7907
CMC curve: Rank-1: 0.9184, Rank-5: 0.9294, Rank-10: 0.9335
=> Enter reranking
=> Results after reranking:
mAP: 0.7968
CMC curve: Rank-1: 0.9242, Rank-5: 0.9277, Rank-10: 0.9312
=> Improvement:
mAP improvement: 0.0061 (+0.78%)
Rank-1 improvement: 0.0058 (+0.63%)
2025-05-26 22:04:03,007 DeMo.train INFO: Validation Results - Epoch: 17
2025-05-26 22:04:03,007 DeMo.train INFO: mAP: 79.7%
2025-05-26 22:04:03,007 DeMo.train INFO: CMC curve, Rank-1  :92.4%
2025-05-26 22:04:03,007 DeMo.train INFO: CMC curve, Rank-5  :92.8%
2025-05-26 22:04:03,007 DeMo.train INFO: CMC curve, Rank-10 :93.1%
2025-05-26 22:04:03,007 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:04:04,505 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:04:04,506 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 22:04:04,506 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7765
CMC curve: Rank-1: 0.9224, Rank-5: 0.9324, Rank-10: 0.9376
=> Enter reranking
=> Results after reranking:
mAP: 0.7828
CMC curve: Rank-1: 0.9300, Rank-5: 0.9324, Rank-10: 0.9364
=> Improvement:
mAP improvement: 0.0063 (+0.81%)
Rank-1 improvement: 0.0076 (+0.82%)
2025-05-26 22:07:14,667 DeMo.train INFO: Validation Results - Epoch: 17
2025-05-26 22:07:14,667 DeMo.train INFO: mAP: 78.3%
2025-05-26 22:07:14,667 DeMo.train INFO: CMC curve, Rank-1  :93.0%
2025-05-26 22:07:14,667 DeMo.train INFO: CMC curve, Rank-5  :93.2%
2025-05-26 22:07:14,667 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 22:07:14,667 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:07:14,681 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:07:14,681 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 22:07:14,681 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7936
CMC curve: Rank-1: 0.9248, Rank-5: 0.9341, Rank-10: 0.9405
=> Enter reranking
=> Results after reranking:
mAP: 0.7989
CMC curve: Rank-1: 0.9254, Rank-5: 0.9329, Rank-10: 0.9399
=> Improvement:
mAP improvement: 0.0053 (+0.67%)
Rank-1 improvement: 0.0006 (+0.06%)
2025-05-26 22:10:24,129 DeMo.train INFO: Validation Results - Epoch: 17
2025-05-26 22:10:24,129 DeMo.train INFO: mAP: 79.9%
2025-05-26 22:10:24,129 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 22:10:24,129 DeMo.train INFO: CMC curve, Rank-5  :93.3%
2025-05-26 22:10:24,130 DeMo.train INFO: CMC curve, Rank-10 :94.0%
2025-05-26 22:10:24,130 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:10:32,183 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:10:32,183 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 22:10:32,183 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 22:10:32,183 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 22:10:32,183 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 22:10:32,183 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:10:49,225 DeMo.train INFO: Epoch[18] Iteration[10/65] Loss: 0.753, Acc: 1.000, Base Lr: 1.21e-04
2025-05-26 22:11:02,508 DeMo.train INFO: Epoch[18] Iteration[20/65] Loss: 0.752, Acc: 1.000, Base Lr: 1.21e-04
2025-05-26 22:11:15,652 DeMo.train INFO: Epoch[18] Iteration[30/65] Loss: 0.750, Acc: 1.000, Base Lr: 1.21e-04
2025-05-26 22:11:28,767 DeMo.train INFO: Epoch[18] Iteration[40/65] Loss: 0.749, Acc: 1.000, Base Lr: 1.21e-04
2025-05-26 22:11:41,927 DeMo.train INFO: Epoch[18] Iteration[50/65] Loss: 0.748, Acc: 1.000, Base Lr: 1.21e-04
2025-05-26 22:11:55,170 DeMo.train INFO: Epoch[18] Iteration[60/65] Loss: 0.746, Acc: 1.000, Base Lr: 1.21e-04
2025-05-26 22:11:57,940 DeMo.train INFO: Epoch 18 done. Time per batch: 1.383[s] Speed: 92.5[samples/s]
2025-05-26 22:11:57,954 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:11:57,954 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 22:11:57,954 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7896
CMC curve: Rank-1: 0.9190, Rank-5: 0.9294, Rank-10: 0.9370
=> Enter reranking
=> Results after reranking:
mAP: 0.7952
CMC curve: Rank-1: 0.9195, Rank-5: 0.9254, Rank-10: 0.9312
=> Improvement:
mAP improvement: 0.0056 (+0.70%)
Rank-1 improvement: 0.0006 (+0.06%)
2025-05-26 22:15:02,145 DeMo.train INFO: Validation Results - Epoch: 18
2025-05-26 22:15:02,145 DeMo.train INFO: mAP: 79.5%
2025-05-26 22:15:02,145 DeMo.train INFO: CMC curve, Rank-1  :92.0%
2025-05-26 22:15:02,145 DeMo.train INFO: CMC curve, Rank-5  :92.5%
2025-05-26 22:15:02,146 DeMo.train INFO: CMC curve, Rank-10 :93.1%
2025-05-26 22:15:02,146 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:15:02,314 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:15:02,314 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 22:15:02,314 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7701
CMC curve: Rank-1: 0.9114, Rank-5: 0.9248, Rank-10: 0.9347
=> Enter reranking
=> Results after reranking:
mAP: 0.7763
CMC curve: Rank-1: 0.9149, Rank-5: 0.9184, Rank-10: 0.9248
=> Improvement:
mAP improvement: 0.0062 (+0.81%)
Rank-1 improvement: 0.0035 (+0.38%)
2025-05-26 22:18:05,904 DeMo.train INFO: Validation Results - Epoch: 18
2025-05-26 22:18:05,904 DeMo.train INFO: mAP: 77.6%
2025-05-26 22:18:05,904 DeMo.train INFO: CMC curve, Rank-1  :91.5%
2025-05-26 22:18:05,904 DeMo.train INFO: CMC curve, Rank-5  :91.8%
2025-05-26 22:18:05,904 DeMo.train INFO: CMC curve, Rank-10 :92.5%
2025-05-26 22:18:05,904 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:18:05,918 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:18:05,919 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 22:18:05,919 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7916
CMC curve: Rank-1: 0.9224, Rank-5: 0.9347, Rank-10: 0.9417
=> Enter reranking
=> Results after reranking:
mAP: 0.7969
CMC curve: Rank-1: 0.9230, Rank-5: 0.9335, Rank-10: 0.9388
=> Improvement:
mAP improvement: 0.0053 (+0.68%)
Rank-1 improvement: 0.0006 (+0.06%)
2025-05-26 22:21:10,740 DeMo.train INFO: Validation Results - Epoch: 18
2025-05-26 22:21:10,740 DeMo.train INFO: mAP: 79.7%
2025-05-26 22:21:10,740 DeMo.train INFO: CMC curve, Rank-1  :92.3%
2025-05-26 22:21:10,740 DeMo.train INFO: CMC curve, Rank-5  :93.4%
2025-05-26 22:21:10,741 DeMo.train INFO: CMC curve, Rank-10 :93.9%
2025-05-26 22:21:10,741 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:21:10,864 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:21:10,865 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 22:21:10,865 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 22:21:10,865 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 22:21:10,865 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 22:21:10,865 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:21:27,588 DeMo.train INFO: Epoch[19] Iteration[10/65] Loss: 0.750, Acc: 0.999, Base Lr: 1.04e-04
2025-05-26 22:21:40,818 DeMo.train INFO: Epoch[19] Iteration[20/65] Loss: 0.747, Acc: 1.000, Base Lr: 1.04e-04
2025-05-26 22:21:53,983 DeMo.train INFO: Epoch[19] Iteration[30/65] Loss: 0.747, Acc: 1.000, Base Lr: 1.04e-04
2025-05-26 22:22:07,096 DeMo.train INFO: Epoch[19] Iteration[40/65] Loss: 0.745, Acc: 1.000, Base Lr: 1.04e-04
2025-05-26 22:22:20,219 DeMo.train INFO: Epoch[19] Iteration[50/65] Loss: 0.744, Acc: 1.000, Base Lr: 1.04e-04
2025-05-26 22:22:33,432 DeMo.train INFO: Epoch[19] Iteration[60/65] Loss: 0.743, Acc: 1.000, Base Lr: 1.04e-04
2025-05-26 22:22:37,516 DeMo.train INFO: Epoch 19 done. Time per batch: 1.375[s] Speed: 93.1[samples/s]
2025-05-26 22:22:37,529 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:22:37,529 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 22:22:37,529 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7897
CMC curve: Rank-1: 0.9184, Rank-5: 0.9300, Rank-10: 0.9353
=> Enter reranking
=> Results after reranking:
mAP: 0.7956
CMC curve: Rank-1: 0.9224, Rank-5: 0.9306, Rank-10: 0.9341
=> Improvement:
mAP improvement: 0.0060 (+0.75%)
Rank-1 improvement: 0.0041 (+0.44%)
2025-05-26 22:25:41,002 DeMo.train INFO: Validation Results - Epoch: 19
2025-05-26 22:25:41,003 DeMo.train INFO: mAP: 79.6%
2025-05-26 22:25:41,003 DeMo.train INFO: CMC curve, Rank-1  :92.2%
2025-05-26 22:25:41,003 DeMo.train INFO: CMC curve, Rank-5  :93.1%
2025-05-26 22:25:41,003 DeMo.train INFO: CMC curve, Rank-10 :93.4%
2025-05-26 22:25:41,003 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:25:42,487 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:25:42,487 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 22:25:42,487 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7715
CMC curve: Rank-1: 0.9125, Rank-5: 0.9259, Rank-10: 0.9370
=> Enter reranking
=> Results after reranking:
mAP: 0.7784
CMC curve: Rank-1: 0.9178, Rank-5: 0.9242, Rank-10: 0.9335
=> Improvement:
mAP improvement: 0.0069 (+0.89%)
Rank-1 improvement: 0.0052 (+0.58%)
2025-05-26 22:28:46,654 DeMo.train INFO: Validation Results - Epoch: 19
2025-05-26 22:28:46,655 DeMo.train INFO: mAP: 77.8%
2025-05-26 22:28:46,655 DeMo.train INFO: CMC curve, Rank-1  :91.8%
2025-05-26 22:28:46,655 DeMo.train INFO: CMC curve, Rank-5  :92.4%
2025-05-26 22:28:46,655 DeMo.train INFO: CMC curve, Rank-10 :93.4%
2025-05-26 22:28:46,655 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:28:46,669 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:28:46,669 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 22:28:46,669 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7919
CMC curve: Rank-1: 0.9219, Rank-5: 0.9347, Rank-10: 0.9405
=> Enter reranking
=> Results after reranking:
mAP: 0.7975
CMC curve: Rank-1: 0.9254, Rank-5: 0.9341, Rank-10: 0.9388
=> Improvement:
mAP improvement: 0.0056 (+0.70%)
Rank-1 improvement: 0.0035 (+0.38%)
2025-05-26 22:31:54,388 DeMo.train INFO: Validation Results - Epoch: 19
2025-05-26 22:31:54,389 DeMo.train INFO: mAP: 79.8%
2025-05-26 22:31:54,389 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 22:31:54,389 DeMo.train INFO: CMC curve, Rank-5  :93.4%
2025-05-26 22:31:54,389 DeMo.train INFO: CMC curve, Rank-10 :93.9%
2025-05-26 22:31:54,389 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:31:54,740 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:31:54,740 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 22:31:54,741 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 22:31:54,741 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 22:31:54,741 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 22:31:54,741 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:32:11,189 DeMo.train INFO: Epoch[20] Iteration[10/65] Loss: 0.743, Acc: 1.000, Base Lr: 8.78e-05
2025-05-26 22:32:24,230 DeMo.train INFO: Epoch[20] Iteration[20/65] Loss: 0.743, Acc: 1.000, Base Lr: 8.78e-05
2025-05-26 22:32:37,308 DeMo.train INFO: Epoch[20] Iteration[30/65] Loss: 0.742, Acc: 1.000, Base Lr: 8.78e-05
2025-05-26 22:32:50,368 DeMo.train INFO: Epoch[20] Iteration[40/65] Loss: 0.741, Acc: 1.000, Base Lr: 8.78e-05
2025-05-26 22:33:03,555 DeMo.train INFO: Epoch[20] Iteration[50/65] Loss: 0.740, Acc: 1.000, Base Lr: 8.78e-05
2025-05-26 22:33:16,666 DeMo.train INFO: Epoch[20] Iteration[60/65] Loss: 0.740, Acc: 1.000, Base Lr: 8.78e-05
2025-05-26 22:33:19,473 DeMo.train INFO: Epoch 20 done. Time per batch: 1.367[s] Speed: 93.7[samples/s]
2025-05-26 22:33:19,485 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:33:19,486 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 22:33:19,486 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7905
CMC curve: Rank-1: 0.9184, Rank-5: 0.9289, Rank-10: 0.9364
=> Enter reranking
=> Results after reranking:
mAP: 0.7962
CMC curve: Rank-1: 0.9219, Rank-5: 0.9265, Rank-10: 0.9335
=> Improvement:
mAP improvement: 0.0057 (+0.72%)
Rank-1 improvement: 0.0035 (+0.38%)
2025-05-26 22:36:22,773 DeMo.train INFO: Validation Results - Epoch: 20
2025-05-26 22:36:22,773 DeMo.train INFO: mAP: 79.6%
2025-05-26 22:36:22,773 DeMo.train INFO: CMC curve, Rank-1  :92.2%
2025-05-26 22:36:22,773 DeMo.train INFO: CMC curve, Rank-5  :92.7%
2025-05-26 22:36:22,774 DeMo.train INFO: CMC curve, Rank-10 :93.4%
2025-05-26 22:36:22,774 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:36:24,696 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:36:24,697 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 22:36:24,697 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7712
CMC curve: Rank-1: 0.9131, Rank-5: 0.9289, Rank-10: 0.9359
=> Enter reranking
=> Results after reranking:
mAP: 0.7782
CMC curve: Rank-1: 0.9236, Rank-5: 0.9294, Rank-10: 0.9370
=> Improvement:
mAP improvement: 0.0070 (+0.91%)
Rank-1 improvement: 0.0105 (+1.15%)
2025-05-26 22:39:28,260 DeMo.train INFO: Validation Results - Epoch: 20
2025-05-26 22:39:28,260 DeMo.train INFO: mAP: 77.8%
2025-05-26 22:39:28,260 DeMo.train INFO: CMC curve, Rank-1  :92.4%
2025-05-26 22:39:28,260 DeMo.train INFO: CMC curve, Rank-5  :92.9%
2025-05-26 22:39:28,260 DeMo.train INFO: CMC curve, Rank-10 :93.7%
2025-05-26 22:39:28,260 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:39:28,275 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:39:28,275 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 22:39:28,275 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7926
CMC curve: Rank-1: 0.9230, Rank-5: 0.9359, Rank-10: 0.9405
=> Enter reranking
=> Results after reranking:
mAP: 0.7979
CMC curve: Rank-1: 0.9259, Rank-5: 0.9353, Rank-10: 0.9388
=> Improvement:
mAP improvement: 0.0053 (+0.67%)
Rank-1 improvement: 0.0029 (+0.32%)
2025-05-26 22:42:33,265 DeMo.train INFO: Validation Results - Epoch: 20
2025-05-26 22:42:33,265 DeMo.train INFO: mAP: 79.8%
2025-05-26 22:42:33,265 DeMo.train INFO: CMC curve, Rank-1  :92.6%
2025-05-26 22:42:33,266 DeMo.train INFO: CMC curve, Rank-5  :93.5%
2025-05-26 22:42:33,266 DeMo.train INFO: CMC curve, Rank-10 :93.9%
2025-05-26 22:42:33,266 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:42:33,421 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:42:33,421 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 22:42:33,421 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 22:42:33,421 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 22:42:33,422 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 22:42:33,422 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:42:50,786 DeMo.train INFO: Epoch[21] Iteration[10/65] Loss: 0.745, Acc: 1.000, Base Lr: 7.24e-05
2025-05-26 22:43:03,868 DeMo.train INFO: Epoch[21] Iteration[20/65] Loss: 0.746, Acc: 1.000, Base Lr: 7.24e-05
2025-05-26 22:43:16,964 DeMo.train INFO: Epoch[21] Iteration[30/65] Loss: 0.744, Acc: 1.000, Base Lr: 7.24e-05
2025-05-26 22:43:30,129 DeMo.train INFO: Epoch[21] Iteration[40/65] Loss: 0.743, Acc: 1.000, Base Lr: 7.24e-05
2025-05-26 22:43:43,231 DeMo.train INFO: Epoch[21] Iteration[50/65] Loss: 0.742, Acc: 1.000, Base Lr: 7.24e-05
2025-05-26 22:43:56,324 DeMo.train INFO: Epoch[21] Iteration[60/65] Loss: 0.741, Acc: 1.000, Base Lr: 7.24e-05
2025-05-26 22:44:00,405 DeMo.train INFO: Epoch 21 done. Time per batch: 1.381[s] Speed: 92.7[samples/s]
2025-05-26 22:44:00,417 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:44:00,417 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 22:44:00,417 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7885
CMC curve: Rank-1: 0.9195, Rank-5: 0.9283, Rank-10: 0.9341
=> Enter reranking
=> Results after reranking:
mAP: 0.7948
CMC curve: Rank-1: 0.9254, Rank-5: 0.9312, Rank-10: 0.9364
=> Improvement:
mAP improvement: 0.0063 (+0.80%)
Rank-1 improvement: 0.0058 (+0.63%)
2025-05-26 22:47:03,840 DeMo.train INFO: Validation Results - Epoch: 21
2025-05-26 22:47:03,841 DeMo.train INFO: mAP: 79.5%
2025-05-26 22:47:03,841 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 22:47:03,841 DeMo.train INFO: CMC curve, Rank-5  :93.1%
2025-05-26 22:47:03,841 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 22:47:03,841 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:47:04,026 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:47:04,026 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 22:47:04,027 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7717
CMC curve: Rank-1: 0.9166, Rank-5: 0.9318, Rank-10: 0.9388
=> Enter reranking
=> Results after reranking:
mAP: 0.7791
CMC curve: Rank-1: 0.9248, Rank-5: 0.9294, Rank-10: 0.9341
=> Improvement:
mAP improvement: 0.0074 (+0.96%)
Rank-1 improvement: 0.0082 (+0.89%)
2025-05-26 22:50:08,144 DeMo.train INFO: Validation Results - Epoch: 21
2025-05-26 22:50:08,144 DeMo.train INFO: mAP: 77.9%
2025-05-26 22:50:08,144 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 22:50:08,144 DeMo.train INFO: CMC curve, Rank-5  :92.9%
2025-05-26 22:50:08,144 DeMo.train INFO: CMC curve, Rank-10 :93.4%
2025-05-26 22:50:08,145 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:50:08,160 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:50:08,160 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 22:50:08,160 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7909
CMC curve: Rank-1: 0.9271, Rank-5: 0.9335, Rank-10: 0.9382
=> Enter reranking
=> Results after reranking:
mAP: 0.7971
CMC curve: Rank-1: 0.9312, Rank-5: 0.9394, Rank-10: 0.9417
=> Improvement:
mAP improvement: 0.0062 (+0.78%)
Rank-1 improvement: 0.0041 (+0.44%)
2025-05-26 22:53:12,917 DeMo.train INFO: Validation Results - Epoch: 21
2025-05-26 22:53:12,917 DeMo.train INFO: mAP: 79.7%
2025-05-26 22:53:12,917 DeMo.train INFO: CMC curve, Rank-1  :93.1%
2025-05-26 22:53:12,917 DeMo.train INFO: CMC curve, Rank-5  :93.9%
2025-05-26 22:53:12,917 DeMo.train INFO: CMC curve, Rank-10 :94.2%
2025-05-26 22:53:12,918 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:53:12,950 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:53:12,950 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 22:53:12,950 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 22:53:12,950 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 22:53:12,950 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 22:53:12,951 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:53:31,402 DeMo.train INFO: Epoch[22] Iteration[10/65] Loss: 0.745, Acc: 1.000, Base Lr: 5.82e-05
2025-05-26 22:53:44,503 DeMo.train INFO: Epoch[22] Iteration[20/65] Loss: 0.742, Acc: 1.000, Base Lr: 5.82e-05
2025-05-26 22:53:57,553 DeMo.train INFO: Epoch[22] Iteration[30/65] Loss: 0.740, Acc: 1.000, Base Lr: 5.82e-05
2025-05-26 22:54:10,686 DeMo.train INFO: Epoch[22] Iteration[40/65] Loss: 0.739, Acc: 1.000, Base Lr: 5.82e-05
2025-05-26 22:54:23,760 DeMo.train INFO: Epoch[22] Iteration[50/65] Loss: 0.738, Acc: 1.000, Base Lr: 5.82e-05
2025-05-26 22:54:37,008 DeMo.train INFO: Epoch[22] Iteration[60/65] Loss: 0.738, Acc: 1.000, Base Lr: 5.82e-05
2025-05-26 22:54:41,094 DeMo.train INFO: Epoch 22 done. Time per batch: 1.399[s] Speed: 91.5[samples/s]
2025-05-26 22:54:41,108 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:54:41,108 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 22:54:41,108 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7897
CMC curve: Rank-1: 0.9195, Rank-5: 0.9294, Rank-10: 0.9353
=> Enter reranking
=> Results after reranking:
mAP: 0.7954
CMC curve: Rank-1: 0.9248, Rank-5: 0.9329, Rank-10: 0.9359
=> Improvement:
mAP improvement: 0.0058 (+0.73%)
Rank-1 improvement: 0.0052 (+0.57%)
2025-05-26 22:57:44,513 DeMo.train INFO: Validation Results - Epoch: 22
2025-05-26 22:57:44,513 DeMo.train INFO: mAP: 79.5%
2025-05-26 22:57:44,513 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 22:57:44,513 DeMo.train INFO: CMC curve, Rank-5  :93.3%
2025-05-26 22:57:44,513 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 22:57:44,513 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:57:45,199 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 22:57:45,200 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 22:57:45,200 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7683
CMC curve: Rank-1: 0.9108, Rank-5: 0.9271, Rank-10: 0.9364
=> Enter reranking
=> Results after reranking:
mAP: 0.7755
CMC curve: Rank-1: 0.9219, Rank-5: 0.9277, Rank-10: 0.9335
=> Improvement:
mAP improvement: 0.0072 (+0.94%)
Rank-1 improvement: 0.0111 (+1.22%)
2025-05-26 23:00:49,371 DeMo.train INFO: Validation Results - Epoch: 22
2025-05-26 23:00:49,371 DeMo.train INFO: mAP: 77.6%
2025-05-26 23:00:49,371 DeMo.train INFO: CMC curve, Rank-1  :92.2%
2025-05-26 23:00:49,372 DeMo.train INFO: CMC curve, Rank-5  :92.8%
2025-05-26 23:00:49,372 DeMo.train INFO: CMC curve, Rank-10 :93.4%
2025-05-26 23:00:49,372 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:00:49,386 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:00:49,387 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 23:00:49,387 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7916
CMC curve: Rank-1: 0.9271, Rank-5: 0.9364, Rank-10: 0.9399
=> Enter reranking
=> Results after reranking:
mAP: 0.7973
CMC curve: Rank-1: 0.9318, Rank-5: 0.9370, Rank-10: 0.9394
=> Improvement:
mAP improvement: 0.0056 (+0.71%)
Rank-1 improvement: 0.0047 (+0.50%)
2025-05-26 23:03:54,981 DeMo.train INFO: Validation Results - Epoch: 22
2025-05-26 23:03:54,982 DeMo.train INFO: mAP: 79.7%
2025-05-26 23:03:54,982 DeMo.train INFO: CMC curve, Rank-1  :93.2%
2025-05-26 23:03:54,982 DeMo.train INFO: CMC curve, Rank-5  :93.7%
2025-05-26 23:03:54,982 DeMo.train INFO: CMC curve, Rank-10 :93.9%
2025-05-26 23:03:54,982 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:03:55,566 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:03:55,566 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 23:03:55,566 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 23:03:55,566 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 23:03:55,566 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 23:03:55,566 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:04:13,213 DeMo.train INFO: Epoch[23] Iteration[10/65] Loss: 0.741, Acc: 1.000, Base Lr: 4.53e-05
2025-05-26 23:04:26,463 DeMo.train INFO: Epoch[23] Iteration[20/65] Loss: 0.738, Acc: 1.000, Base Lr: 4.53e-05
2025-05-26 23:04:39,527 DeMo.train INFO: Epoch[23] Iteration[30/65] Loss: 0.738, Acc: 1.000, Base Lr: 4.53e-05
2025-05-26 23:04:52,596 DeMo.train INFO: Epoch[23] Iteration[40/65] Loss: 0.738, Acc: 1.000, Base Lr: 4.53e-05
2025-05-26 23:05:05,747 DeMo.train INFO: Epoch[23] Iteration[50/65] Loss: 0.738, Acc: 1.000, Base Lr: 4.53e-05
2025-05-26 23:05:18,841 DeMo.train INFO: Epoch[23] Iteration[60/65] Loss: 0.737, Acc: 1.000, Base Lr: 4.53e-05
2025-05-26 23:05:21,641 DeMo.train INFO: Epoch 23 done. Time per batch: 1.388[s] Speed: 92.2[samples/s]
2025-05-26 23:05:21,654 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:05:21,654 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 23:05:21,654 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7898
CMC curve: Rank-1: 0.9195, Rank-5: 0.9289, Rank-10: 0.9359
=> Enter reranking
=> Results after reranking:
mAP: 0.7959
CMC curve: Rank-1: 0.9271, Rank-5: 0.9329, Rank-10: 0.9370
=> Improvement:
mAP improvement: 0.0061 (+0.77%)
Rank-1 improvement: 0.0076 (+0.82%)
2025-05-26 23:08:24,308 DeMo.train INFO: Validation Results - Epoch: 23
2025-05-26 23:08:24,308 DeMo.train INFO: mAP: 79.6%
2025-05-26 23:08:24,308 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 23:08:24,308 DeMo.train INFO: CMC curve, Rank-5  :93.3%
2025-05-26 23:08:24,308 DeMo.train INFO: CMC curve, Rank-10 :93.7%
2025-05-26 23:08:24,308 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:08:25,639 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:08:25,640 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 23:08:25,640 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7716
CMC curve: Rank-1: 0.9178, Rank-5: 0.9318, Rank-10: 0.9423
=> Enter reranking
=> Results after reranking:
mAP: 0.7777
CMC curve: Rank-1: 0.9213, Rank-5: 0.9283, Rank-10: 0.9347
=> Improvement:
mAP improvement: 0.0061 (+0.79%)
Rank-1 improvement: 0.0035 (+0.38%)
2025-05-26 23:11:29,428 DeMo.train INFO: Validation Results - Epoch: 23
2025-05-26 23:11:29,429 DeMo.train INFO: mAP: 77.8%
2025-05-26 23:11:29,429 DeMo.train INFO: CMC curve, Rank-1  :92.1%
2025-05-26 23:11:29,429 DeMo.train INFO: CMC curve, Rank-5  :92.8%
2025-05-26 23:11:29,429 DeMo.train INFO: CMC curve, Rank-10 :93.5%
2025-05-26 23:11:29,429 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:11:29,443 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:11:29,443 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 23:11:29,443 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7923
CMC curve: Rank-1: 0.9248, Rank-5: 0.9353, Rank-10: 0.9394
=> Enter reranking
=> Results after reranking:
mAP: 0.7981
CMC curve: Rank-1: 0.9324, Rank-5: 0.9364, Rank-10: 0.9382
=> Improvement:
mAP improvement: 0.0058 (+0.73%)
Rank-1 improvement: 0.0076 (+0.82%)
2025-05-26 23:14:34,790 DeMo.train INFO: Validation Results - Epoch: 23
2025-05-26 23:14:34,791 DeMo.train INFO: mAP: 79.8%
2025-05-26 23:14:34,791 DeMo.train INFO: CMC curve, Rank-1  :93.2%
2025-05-26 23:14:34,791 DeMo.train INFO: CMC curve, Rank-5  :93.6%
2025-05-26 23:14:34,791 DeMo.train INFO: CMC curve, Rank-10 :93.8%
2025-05-26 23:14:34,791 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:14:35,615 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:14:35,616 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 23:14:35,616 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 23:14:35,616 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 23:14:35,616 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 23:14:35,616 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:14:52,298 DeMo.train INFO: Epoch[24] Iteration[10/65] Loss: 0.735, Acc: 1.000, Base Lr: 3.37e-05
2025-05-26 23:15:05,441 DeMo.train INFO: Epoch[24] Iteration[20/65] Loss: 0.736, Acc: 1.000, Base Lr: 3.37e-05
2025-05-26 23:15:18,504 DeMo.train INFO: Epoch[24] Iteration[30/65] Loss: 0.737, Acc: 1.000, Base Lr: 3.37e-05
2025-05-26 23:15:31,612 DeMo.train INFO: Epoch[24] Iteration[40/65] Loss: 0.736, Acc: 1.000, Base Lr: 3.37e-05
2025-05-26 23:15:44,751 DeMo.train INFO: Epoch[24] Iteration[50/65] Loss: 0.736, Acc: 1.000, Base Lr: 3.37e-05
2025-05-26 23:15:58,116 DeMo.train INFO: Epoch[24] Iteration[60/65] Loss: 0.735, Acc: 1.000, Base Lr: 3.37e-05
2025-05-26 23:16:02,212 DeMo.train INFO: Epoch 24 done. Time per batch: 1.375[s] Speed: 93.1[samples/s]
2025-05-26 23:16:02,229 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:16:02,230 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 23:16:02,230 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7901
CMC curve: Rank-1: 0.9201, Rank-5: 0.9289, Rank-10: 0.9364
=> Enter reranking
=> Results after reranking:
mAP: 0.7961
CMC curve: Rank-1: 0.9271, Rank-5: 0.9324, Rank-10: 0.9370
=> Improvement:
mAP improvement: 0.0060 (+0.76%)
Rank-1 improvement: 0.0070 (+0.76%)
2025-05-26 23:19:15,774 DeMo.train INFO: Validation Results - Epoch: 24
2025-05-26 23:19:15,774 DeMo.train INFO: mAP: 79.6%
2025-05-26 23:19:15,775 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 23:19:15,775 DeMo.train INFO: CMC curve, Rank-5  :93.2%
2025-05-26 23:19:15,775 DeMo.train INFO: CMC curve, Rank-10 :93.7%
2025-05-26 23:19:15,775 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:19:16,699 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:19:16,699 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 23:19:16,700 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7720
CMC curve: Rank-1: 0.9155, Rank-5: 0.9306, Rank-10: 0.9382
=> Enter reranking
=> Results after reranking:
mAP: 0.7786
CMC curve: Rank-1: 0.9230, Rank-5: 0.9300, Rank-10: 0.9370
=> Improvement:
mAP improvement: 0.0065 (+0.85%)
Rank-1 improvement: 0.0076 (+0.83%)
2025-05-26 23:22:45,245 DeMo.train INFO: Validation Results - Epoch: 24
2025-05-26 23:22:45,245 DeMo.train INFO: mAP: 77.9%
2025-05-26 23:22:45,245 DeMo.train INFO: CMC curve, Rank-1  :92.3%
2025-05-26 23:22:45,245 DeMo.train INFO: CMC curve, Rank-5  :93.0%
2025-05-26 23:22:45,246 DeMo.train INFO: CMC curve, Rank-10 :93.7%
2025-05-26 23:22:45,246 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:22:45,259 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:22:45,260 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 23:22:45,260 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7926
CMC curve: Rank-1: 0.9254, Rank-5: 0.9364, Rank-10: 0.9399
=> Enter reranking
=> Results after reranking:
mAP: 0.7983
CMC curve: Rank-1: 0.9306, Rank-5: 0.9376, Rank-10: 0.9388
=> Improvement:
mAP improvement: 0.0057 (+0.72%)
Rank-1 improvement: 0.0052 (+0.57%)
2025-05-26 23:26:05,600 DeMo.train INFO: Validation Results - Epoch: 24
2025-05-26 23:26:05,600 DeMo.train INFO: mAP: 79.8%
2025-05-26 23:26:05,600 DeMo.train INFO: CMC curve, Rank-1  :93.1%
2025-05-26 23:26:05,601 DeMo.train INFO: CMC curve, Rank-5  :93.8%
2025-05-26 23:26:05,601 DeMo.train INFO: CMC curve, Rank-10 :93.9%
2025-05-26 23:26:05,601 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:26:06,271 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:26:06,271 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 23:26:06,271 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 23:26:06,271 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 23:26:06,271 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 23:26:06,272 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:26:22,886 DeMo.train INFO: Epoch[25] Iteration[10/65] Loss: 0.735, Acc: 1.000, Base Lr: 2.38e-05
2025-05-26 23:26:35,990 DeMo.train INFO: Epoch[25] Iteration[20/65] Loss: 0.735, Acc: 1.000, Base Lr: 2.38e-05
2025-05-26 23:26:49,045 DeMo.train INFO: Epoch[25] Iteration[30/65] Loss: 0.736, Acc: 1.000, Base Lr: 2.38e-05
2025-05-26 23:27:02,140 DeMo.train INFO: Epoch[25] Iteration[40/65] Loss: 0.735, Acc: 1.000, Base Lr: 2.38e-05
2025-05-26 23:27:15,211 DeMo.train INFO: Epoch[25] Iteration[50/65] Loss: 0.734, Acc: 1.000, Base Lr: 2.38e-05
2025-05-26 23:27:28,267 DeMo.train INFO: Epoch[25] Iteration[60/65] Loss: 0.734, Acc: 1.000, Base Lr: 2.38e-05
2025-05-26 23:27:32,339 DeMo.train INFO: Epoch 25 done. Time per batch: 1.366[s] Speed: 93.7[samples/s]
2025-05-26 23:27:32,351 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:27:32,351 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 23:27:32,351 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7902
CMC curve: Rank-1: 0.9195, Rank-5: 0.9294, Rank-10: 0.9364
=> Enter reranking
=> Results after reranking:
mAP: 0.7962
CMC curve: Rank-1: 0.9265, Rank-5: 0.9318, Rank-10: 0.9364
=> Improvement:
mAP improvement: 0.0060 (+0.76%)
Rank-1 improvement: 0.0070 (+0.76%)
2025-05-26 23:30:47,547 DeMo.train INFO: Validation Results - Epoch: 25
2025-05-26 23:30:47,547 DeMo.train INFO: mAP: 79.6%
2025-05-26 23:30:47,548 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 23:30:47,548 DeMo.train INFO: CMC curve, Rank-5  :93.2%
2025-05-26 23:30:47,548 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 23:30:47,548 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:30:48,077 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:30:48,077 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 23:30:48,078 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7730
CMC curve: Rank-1: 0.9160, Rank-5: 0.9300, Rank-10: 0.9405
=> Enter reranking
=> Results after reranking:
mAP: 0.7786
CMC curve: Rank-1: 0.9213, Rank-5: 0.9283, Rank-10: 0.9353
=> Improvement:
mAP improvement: 0.0056 (+0.73%)
Rank-1 improvement: 0.0052 (+0.57%)
2025-05-26 23:34:21,426 DeMo.train INFO: Validation Results - Epoch: 25
2025-05-26 23:34:21,426 DeMo.train INFO: mAP: 77.9%
2025-05-26 23:34:21,426 DeMo.train INFO: CMC curve, Rank-1  :92.1%
2025-05-26 23:34:21,426 DeMo.train INFO: CMC curve, Rank-5  :92.8%
2025-05-26 23:34:21,426 DeMo.train INFO: CMC curve, Rank-10 :93.5%
2025-05-26 23:34:21,426 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:34:21,439 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:34:21,439 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 23:34:21,439 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7928
CMC curve: Rank-1: 0.9265, Rank-5: 0.9370, Rank-10: 0.9405
=> Enter reranking
=> Results after reranking:
mAP: 0.7983
CMC curve: Rank-1: 0.9312, Rank-5: 0.9364, Rank-10: 0.9382
=> Improvement:
mAP improvement: 0.0055 (+0.69%)
Rank-1 improvement: 0.0047 (+0.50%)
2025-05-26 23:37:43,090 DeMo.train INFO: Validation Results - Epoch: 25
2025-05-26 23:37:43,091 DeMo.train INFO: mAP: 79.8%
2025-05-26 23:37:43,091 DeMo.train INFO: CMC curve, Rank-1  :93.1%
2025-05-26 23:37:43,091 DeMo.train INFO: CMC curve, Rank-5  :93.6%
2025-05-26 23:37:43,091 DeMo.train INFO: CMC curve, Rank-10 :93.8%
2025-05-26 23:37:43,091 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:37:43,654 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:37:43,654 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 23:37:43,654 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 23:37:43,654 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 23:37:43,654 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 23:37:43,654 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:38:00,143 DeMo.train INFO: Epoch[26] Iteration[10/65] Loss: 0.735, Acc: 1.000, Base Lr: 1.55e-05
2025-05-26 23:38:13,182 DeMo.train INFO: Epoch[26] Iteration[20/65] Loss: 0.733, Acc: 1.000, Base Lr: 1.55e-05
2025-05-26 23:38:26,218 DeMo.train INFO: Epoch[26] Iteration[30/65] Loss: 0.735, Acc: 1.000, Base Lr: 1.55e-05
2025-05-26 23:38:39,284 DeMo.train INFO: Epoch[26] Iteration[40/65] Loss: 0.734, Acc: 1.000, Base Lr: 1.55e-05
2025-05-26 23:38:52,321 DeMo.train INFO: Epoch[26] Iteration[50/65] Loss: 0.734, Acc: 1.000, Base Lr: 1.55e-05
2025-05-26 23:39:05,422 DeMo.train INFO: Epoch[26] Iteration[60/65] Loss: 0.734, Acc: 1.000, Base Lr: 1.55e-05
2025-05-26 23:39:09,498 DeMo.train INFO: Epoch 26 done. Time per batch: 1.363[s] Speed: 93.9[samples/s]
2025-05-26 23:39:09,511 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:39:09,511 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 23:39:09,511 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7901
CMC curve: Rank-1: 0.9201, Rank-5: 0.9289, Rank-10: 0.9359
=> Enter reranking
=> Results after reranking:
mAP: 0.7958
CMC curve: Rank-1: 0.9254, Rank-5: 0.9306, Rank-10: 0.9359
=> Improvement:
mAP improvement: 0.0057 (+0.72%)
Rank-1 improvement: 0.0052 (+0.57%)
2025-05-26 23:42:29,802 DeMo.train INFO: Validation Results - Epoch: 26
2025-05-26 23:42:29,802 DeMo.train INFO: mAP: 79.6%
2025-05-26 23:42:29,802 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-26 23:42:29,802 DeMo.train INFO: CMC curve, Rank-5  :93.1%
2025-05-26 23:42:29,802 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 23:42:29,802 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:42:29,978 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:42:29,978 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 23:42:29,978 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7722
CMC curve: Rank-1: 0.9160, Rank-5: 0.9283, Rank-10: 0.9388
=> Enter reranking
=> Results after reranking:
mAP: 0.7779
CMC curve: Rank-1: 0.9207, Rank-5: 0.9271, Rank-10: 0.9335
=> Improvement:
mAP improvement: 0.0057 (+0.73%)
Rank-1 improvement: 0.0047 (+0.51%)
2025-05-26 23:45:57,758 DeMo.train INFO: Validation Results - Epoch: 26
2025-05-26 23:45:57,758 DeMo.train INFO: mAP: 77.8%
2025-05-26 23:45:57,758 DeMo.train INFO: CMC curve, Rank-1  :92.1%
2025-05-26 23:45:57,758 DeMo.train INFO: CMC curve, Rank-5  :92.7%
2025-05-26 23:45:57,759 DeMo.train INFO: CMC curve, Rank-10 :93.4%
2025-05-26 23:45:57,759 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:45:57,774 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:45:57,774 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 23:45:57,774 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7925
CMC curve: Rank-1: 0.9254, Rank-5: 0.9364, Rank-10: 0.9405
=> Enter reranking
=> Results after reranking:
mAP: 0.7982
CMC curve: Rank-1: 0.9324, Rank-5: 0.9376, Rank-10: 0.9394
=> Improvement:
mAP improvement: 0.0056 (+0.71%)
Rank-1 improvement: 0.0070 (+0.76%)
2025-05-26 23:49:09,689 DeMo.train INFO: Validation Results - Epoch: 26
2025-05-26 23:49:09,689 DeMo.train INFO: mAP: 79.8%
2025-05-26 23:49:09,689 DeMo.train INFO: CMC curve, Rank-1  :93.2%
2025-05-26 23:49:09,689 DeMo.train INFO: CMC curve, Rank-5  :93.8%
2025-05-26 23:49:09,689 DeMo.train INFO: CMC curve, Rank-10 :93.9%
2025-05-26 23:49:09,689 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:49:09,783 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:49:09,784 DeMo.train INFO: Best mAP: 79.9%
2025-05-26 23:49:09,784 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-26 23:49:09,784 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-26 23:49:09,784 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-26 23:49:09,784 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:49:26,383 DeMo.train INFO: Epoch[27] Iteration[10/65] Loss: 0.737, Acc: 1.000, Base Lr: 8.91e-06
2025-05-26 23:49:39,588 DeMo.train INFO: Epoch[27] Iteration[20/65] Loss: 0.736, Acc: 1.000, Base Lr: 8.91e-06
2025-05-26 23:49:52,621 DeMo.train INFO: Epoch[27] Iteration[30/65] Loss: 0.737, Acc: 1.000, Base Lr: 8.91e-06
2025-05-26 23:50:05,717 DeMo.train INFO: Epoch[27] Iteration[40/65] Loss: 0.737, Acc: 1.000, Base Lr: 8.91e-06
2025-05-26 23:50:18,793 DeMo.train INFO: Epoch[27] Iteration[50/65] Loss: 0.736, Acc: 1.000, Base Lr: 8.91e-06
2025-05-26 23:50:31,846 DeMo.train INFO: Epoch[27] Iteration[60/65] Loss: 0.735, Acc: 1.000, Base Lr: 8.91e-06
2025-05-26 23:50:35,934 DeMo.train INFO: Epoch 27 done. Time per batch: 1.367[s] Speed: 93.6[samples/s]
2025-05-26 23:50:35,946 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:50:35,946 DeMo.train INFO: Current is the ori feature testing!
2025-05-26 23:50:35,946 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7907
CMC curve: Rank-1: 0.9213, Rank-5: 0.9300, Rank-10: 0.9376
=> Enter reranking
=> Results after reranking:
mAP: 0.7965
CMC curve: Rank-1: 0.9271, Rank-5: 0.9312, Rank-10: 0.9359
=> Improvement:
mAP improvement: 0.0058 (+0.73%)
Rank-1 improvement: 0.0058 (+0.63%)
2025-05-26 23:53:59,256 DeMo.train INFO: Validation Results - Epoch: 27
2025-05-26 23:53:59,257 DeMo.train INFO: mAP: 79.7%
2025-05-26 23:53:59,257 DeMo.train INFO: CMC curve, Rank-1  :92.7%
2025-05-26 23:53:59,257 DeMo.train INFO: CMC curve, Rank-5  :93.1%
2025-05-26 23:53:59,257 DeMo.train INFO: CMC curve, Rank-10 :93.6%
2025-05-26 23:53:59,257 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:53:59,431 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:53:59,431 DeMo.train INFO: Current is the moe feature testing!
2025-05-26 23:53:59,431 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7725
CMC curve: Rank-1: 0.9149, Rank-5: 0.9265, Rank-10: 0.9405
=> Enter reranking
=> Results after reranking:
mAP: 0.7787
CMC curve: Rank-1: 0.9230, Rank-5: 0.9277, Rank-10: 0.9353
=> Improvement:
mAP improvement: 0.0063 (+0.81%)
Rank-1 improvement: 0.0082 (+0.89%)
2025-05-26 23:57:21,233 DeMo.train INFO: Validation Results - Epoch: 27
2025-05-26 23:57:21,234 DeMo.train INFO: mAP: 77.9%
2025-05-26 23:57:21,234 DeMo.train INFO: CMC curve, Rank-1  :92.3%
2025-05-26 23:57:21,234 DeMo.train INFO: CMC curve, Rank-5  :92.8%
2025-05-26 23:57:21,234 DeMo.train INFO: CMC curve, Rank-10 :93.5%
2025-05-26 23:57:21,234 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:57:21,248 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-26 23:57:21,248 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-26 23:57:21,249 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7932
CMC curve: Rank-1: 0.9259, Rank-5: 0.9364, Rank-10: 0.9417
=> Enter reranking
=> Results after reranking:
mAP: 0.7989
CMC curve: Rank-1: 0.9335, Rank-5: 0.9359, Rank-10: 0.9382
=> Improvement:
mAP improvement: 0.0057 (+0.72%)
Rank-1 improvement: 0.0076 (+0.82%)
2025-05-27 00:00:33,237 DeMo.train INFO: Validation Results - Epoch: 27
2025-05-27 00:00:33,238 DeMo.train INFO: mAP: 79.9%
2025-05-27 00:00:33,238 DeMo.train INFO: CMC curve, Rank-1  :93.4%
2025-05-27 00:00:33,238 DeMo.train INFO: CMC curve, Rank-5  :93.6%
2025-05-27 00:00:33,238 DeMo.train INFO: CMC curve, Rank-10 :93.8%
2025-05-27 00:00:33,238 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 00:00:33,731 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 00:00:33,731 DeMo.train INFO: Best mAP: 79.9%
2025-05-27 00:00:33,731 DeMo.train INFO: Best Rank-1: 92.5%
2025-05-27 00:00:33,731 DeMo.train INFO: Best Rank-5: 93.3%
2025-05-27 00:00:33,732 DeMo.train INFO: Best Rank-10: 94.0%
2025-05-27 00:00:33,732 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 00:00:51,973 DeMo.train INFO: Epoch[28] Iteration[10/65] Loss: 0.739, Acc: 1.000, Base Lr: 4.17e-06
2025-05-27 00:01:05,060 DeMo.train INFO: Epoch[28] Iteration[20/65] Loss: 0.738, Acc: 1.000, Base Lr: 4.17e-06
2025-05-27 00:01:18,083 DeMo.train INFO: Epoch[28] Iteration[30/65] Loss: 0.737, Acc: 1.000, Base Lr: 4.17e-06
2025-05-27 00:01:31,134 DeMo.train INFO: Epoch[28] Iteration[40/65] Loss: 0.736, Acc: 1.000, Base Lr: 4.17e-06
2025-05-27 00:01:44,338 DeMo.train INFO: Epoch[28] Iteration[50/65] Loss: 0.735, Acc: 1.000, Base Lr: 4.17e-06
2025-05-27 00:01:57,364 DeMo.train INFO: Epoch[28] Iteration[60/65] Loss: 0.734, Acc: 1.000, Base Lr: 4.17e-06
2025-05-27 00:02:01,448 DeMo.train INFO: Epoch 28 done. Time per batch: 1.392[s] Speed: 91.9[samples/s]
2025-05-27 00:02:01,462 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 00:02:01,462 DeMo.train INFO: Current is the ori feature testing!
2025-05-27 00:02:01,462 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
