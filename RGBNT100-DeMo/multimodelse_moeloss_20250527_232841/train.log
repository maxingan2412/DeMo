2025-05-27 23:28:45,625 DeMo INFO: Saving model in the path :./RGBNT100-DeMo/multimodelse_moeloss_20250527_232841
2025-05-27 23:28:45,625 DeMo INFO: Namespace(config_file='configs/RGBNT100/DeMo.yml', fea_cft=0, local_rank=0, opts=['OUTPUT_DIR', './RGBNT100-DeMo/multimodelse_moeloss_20250527_232841'])
2025-05-27 23:28:45,625 DeMo INFO: Loaded configuration file configs/RGBNT100/DeMo.yml
2025-05-27 23:28:45,625 DeMo INFO: 
MODEL:
  TRANSFORMER_TYPE: 'ViT-B-16'
  STRIDE_SIZE: [ 16, 16 ]
  SIE_CAMERA: True
  DIRECT: 0
  SIE_COE: 1.0
  ID_LOSS_WEIGHT: 0.25
  TRIPLET_LOSS_WEIGHT: 1.0
  GLOBAL_LOCAL: True
  HDM: True
  ATM: True
  HEAD: 8
  CENGJIFUSION: True

INPUT:
  SIZE_TRAIN: [ 128, 256 ]
  SIZE_TEST: [ 128, 256 ]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.5 # random erasing
  PADDING: 10

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 16
  NUM_WORKERS: 14

DATASETS:
  NAMES: ('RGBNT100')
  ROOT_DIR: '..'

SOLVER:
  BASE_LR: 0.00035
  WARMUP_ITERS: 5
  MAX_EPOCHS: 30
  OPTIMIZER_NAME: 'Adam'
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  EVAL_PERIOD: 1
  SEED: 1111

TEST:
  IMS_PER_BATCH: 128
  RE_RANKING: 'no'
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'
  MISS: "nothing"

OUTPUT_DIR: '..'




2025-05-27 23:28:45,626 DeMo INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 14
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: RGBNT100
  ROOT_DIR: ..
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [128, 256]
  SIZE_TRAIN: [128, 256]
MODEL:
  ADAPTER: False
  ATM: True
  ATT_DROP_RATE: 0.0
  CENGJIFUSION: True
  DEVICE: cuda
  DEVICE_ID: 0
  DIRECT: 0
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FROZEN: False
  GLOBAL_LOCAL: True
  HDM: True
  HEAD: 8
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  METRIC_LOSS_TYPE: triplet
  NAME: DeMo
  NECK: bnneck
  NO_MARGIN: True
  PRETRAIN_PATH_T: /path/to/your/vitb_16_224_21k.pth
  PROMPT: False
  SIE_CAMERA: True
  SIE_COE: 1.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: ViT-B-16
  TRIPLET_LOSS_WEIGHT: 1.0
OUTPUT_DIR: ./RGBNT100-DeMo/multimodelse_moeloss_20250527_232841
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 60
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 64
  LARGE_FC_LR: False
  LOG_PERIOD: 10
  MARGIN: 0.3
  MAX_EPOCHS: 30
  MOMENTUM: 0.9
  OPTIMIZER_NAME: Adam
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1111
  STEPS: (40, 70)
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 5
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
TEST:
  FEAT: 0
  FEAT_NORM: yes
  IMS_PER_BATCH: 128
  MISS: nothing
  NECK_FEAT: before
  RE_RANKING: no
  WEIGHT: 
=> RGB_IR loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |    50 |     8675 |         8
  query    |    50 |     1715 |         8
  gallery  |    50 |     8575 |         8
  ----------------------------------------
data is ready
cengjifusion: True mxa
rwkvbackbone: False mxa
using Transformer_type: ViT-B-16 as a backbone
simplegate: False mxa
tiaoyuelianjie: False mxa
Resized position embedding: %s to %s torch.Size([197, 768]) torch.Size([129, 768])
Position embedding resize to height:8 width: 16
Successfully load ckpt!
_IncompatibleKeys(missing_keys=['visual.triple_dff.fc_atten1.0.weight', 'visual.triple_dff.fc_atten1.1.weight', 'visual.triple_dff.fc_atten1.1.bias', 'visual.triple_dff.fc_atten2.0.weight', 'visual.triple_dff.fc_atten2.1.weight', 'visual.triple_dff.fc_atten2.1.bias', 'visual.triple_dff.fc_atten4.0.weight', 'visual.triple_dff.fc_atten4.1.weight', 'visual.triple_dff.fc_atten4.1.bias', 'visual.triple_dff.input_weight_net.0.weight', 'visual.triple_dff.input_weight_net.0.bias', 'visual.triple_dff.input_weight_net.2.weight', 'visual.triple_dff.input_weight_net.2.bias', 'visual.triple_dff.gate_fc.0.weight', 'visual.triple_dff.gate_enhancement.0.weight', 'visual.triple_dff.gate_enhancement.0.bias', 'visual.triple_dff.fc_redu.0.weight', 'visual.triple_dff.fc_redu.1.weight', 'visual.triple_dff.fc_redu.1.bias', 'visual.triple_dff.residual_fc1.0.weight', 'visual.triple_dff.residual_fc1.1.weight', 'visual.triple_dff.residual_fc1.1.bias', 'visual.triple_dff.residual_fc2.0.weight', 'visual.triple_dff.residual_fc2.1.weight', 'visual.triple_dff.residual_fc2.1.bias', 'visual.triple_dff.residual_fc3.0.weight', 'visual.triple_dff.residual_fc3.1.weight', 'visual.triple_dff.residual_fc3.1.bias', 'visual.triple_dff.residual_fusion.0.weight', 'visual.triple_dff.residual_fusion.1.weight', 'visual.triple_dff.residual_fusion.1.bias', 'visual.triple_dff.fc1.weight', 'visual.triple_dff.fc1.bias', 'visual.triple_dff.fc2.weight', 'visual.triple_dff.fc2.bias', 'visual.triple_dff.fc3.weight', 'visual.triple_dff.fc3.bias', 'visual.triple_dff.attention_fusion.0.weight', 'visual.triple_dff.attention_fusion.0.bias', 'visual.quad_dffs.stage1_triple_dff.fc_atten1.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten1.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten1.1.bias', 'visual.quad_dffs.stage1_triple_dff.fc_atten2.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten2.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten2.1.bias', 'visual.quad_dffs.stage1_triple_dff.fc_atten4.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten4.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_atten4.1.bias', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.0.weight', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.0.bias', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.2.weight', 'visual.quad_dffs.stage1_triple_dff.input_weight_net.2.bias', 'visual.quad_dffs.stage1_triple_dff.gate_fc.0.weight', 'visual.quad_dffs.stage1_triple_dff.gate_enhancement.0.weight', 'visual.quad_dffs.stage1_triple_dff.gate_enhancement.0.bias', 'visual.quad_dffs.stage1_triple_dff.fc_redu.0.weight', 'visual.quad_dffs.stage1_triple_dff.fc_redu.1.weight', 'visual.quad_dffs.stage1_triple_dff.fc_redu.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fc1.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc1.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc1.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fc2.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc2.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc2.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fc3.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc3.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fc3.1.bias', 'visual.quad_dffs.stage1_triple_dff.residual_fusion.0.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fusion.1.weight', 'visual.quad_dffs.stage1_triple_dff.residual_fusion.1.bias', 'visual.quad_dffs.stage1_triple_dff.fc1.weight', 'visual.quad_dffs.stage1_triple_dff.fc1.bias', 'visual.quad_dffs.stage1_triple_dff.fc2.weight', 'visual.quad_dffs.stage1_triple_dff.fc2.bias', 'visual.quad_dffs.stage1_triple_dff.fc3.weight', 'visual.quad_dffs.stage1_triple_dff.fc3.bias', 'visual.quad_dffs.stage1_triple_dff.attention_fusion.0.weight', 'visual.quad_dffs.stage1_triple_dff.attention_fusion.0.bias', 'visual.quad_dffs.stage1_enhancement.0.weight', 'visual.quad_dffs.stage1_enhancement.0.bias', 'visual.quad_dffs.stage1_enhancement.1.weight', 'visual.quad_dffs.stage1_enhancement.1.bias', 'visual.quad_dffs.stage1_enhancement.3.weight', 'visual.quad_dffs.stage1_enhancement.3.bias', 'visual.quad_dffs.stage1_enhancement.5.weight', 'visual.quad_dffs.stage1_enhancement.5.bias', 'visual.quad_dffs.input4_preprocessing.0.weight', 'visual.quad_dffs.input4_preprocessing.0.bias', 'visual.quad_dffs.input4_preprocessing.1.weight', 'visual.quad_dffs.input4_preprocessing.1.bias', 'visual.quad_dffs.input4_preprocessing.3.weight', 'visual.quad_dffs.input4_preprocessing.3.bias', 'visual.quad_dffs.input4_preprocessing.4.weight', 'visual.quad_dffs.input4_preprocessing.4.bias', 'visual.quad_dffs.cross_stage_attention.0.weight', 'visual.quad_dffs.cross_stage_attention.0.bias', 'visual.quad_dffs.cross_stage_attention.2.weight', 'visual.quad_dffs.cross_stage_attention.2.bias', 'visual.quad_dffs.adaptive_fusion_weight.0.weight', 'visual.quad_dffs.adaptive_fusion_weight.0.bias', 'visual.quad_dffs.adaptive_fusion_weight.2.weight', 'visual.quad_dffs.adaptive_fusion_weight.2.bias', 'visual.quad_dffs.stage2_dff.fc_atten1.0.weight', 'visual.quad_dffs.stage2_dff.fc_atten2.0.weight', 'visual.quad_dffs.stage2_dff.fc_atten3.0.weight', 'visual.quad_dffs.stage2_dff.gate_fc.0.weight', 'visual.quad_dffs.stage2_dff.fc_redu.weight', 'visual.quad_dffs.stage2_dff.residual_fc.weight', 'visual.quad_dffs.stage2_dff.fc1.weight', 'visual.quad_dffs.stage2_dff.fc1.bias', 'visual.quad_dffs.stage2_dff.fc2.weight', 'visual.quad_dffs.stage2_dff.fc2.bias', 'visual.quad_dffs.memory_input1.weight', 'visual.quad_dffs.memory_input4.weight', 'visual.quad_dffs.memory_fusion.0.weight', 'visual.quad_dffs.memory_fusion.1.weight', 'visual.quad_dffs.memory_fusion.1.bias', 'visual.quad_dffs.global_context.0.weight', 'visual.quad_dffs.global_context.0.bias', 'visual.quad_dffs.global_context.2.weight', 'visual.quad_dffs.global_context.2.bias', 'visual.quad_dffs.final_refinement.0.weight', 'visual.quad_dffs.final_refinement.0.bias', 'visual.quad_dffs.final_refinement.1.weight', 'visual.quad_dffs.final_refinement.1.bias', 'visual.quad_dffs.final_refinement.3.weight', 'visual.quad_dffs.final_refinement.3.bias', 'visual.quad_dffs.final_refinement.4.weight', 'visual.quad_dffs.final_refinement.4.bias', 'visual.gated_enhancement.rgb_gating.residual_weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.q_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.k_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.v_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.out_proj.weight', 'visual.gated_enhancement.rgb_gating.cross_modal_attention.out_proj.bias', 'visual.gated_enhancement.rgb_gating.channel_gate.0.weight', 'visual.gated_enhancement.rgb_gating.channel_gate.0.bias', 'visual.gated_enhancement.rgb_gating.channel_gate.2.weight', 'visual.gated_enhancement.rgb_gating.channel_gate.2.bias', 'visual.gated_enhancement.rgb_gating.spatial_gate.0.weight', 'visual.gated_enhancement.rgb_gating.spatial_gate.0.bias', 'visual.gated_enhancement.rgb_gating.spatial_gate.2.weight', 'visual.gated_enhancement.rgb_gating.spatial_gate.2.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.0.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.0.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.1.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.1.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.3.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.3.bias', 'visual.gated_enhancement.rgb_gating.feature_fusion.4.weight', 'visual.gated_enhancement.rgb_gating.feature_fusion.4.bias', 'visual.gated_enhancement.rgb_gating.adaptive_weight.0.weight', 'visual.gated_enhancement.rgb_gating.adaptive_weight.0.bias', 'visual.gated_enhancement.rgb_gating.adaptive_weight.2.weight', 'visual.gated_enhancement.rgb_gating.adaptive_weight.2.bias', 'visual.gated_enhancement.nir_gating.residual_weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.q_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.k_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.v_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.out_proj.weight', 'visual.gated_enhancement.nir_gating.cross_modal_attention.out_proj.bias', 'visual.gated_enhancement.nir_gating.channel_gate.0.weight', 'visual.gated_enhancement.nir_gating.channel_gate.0.bias', 'visual.gated_enhancement.nir_gating.channel_gate.2.weight', 'visual.gated_enhancement.nir_gating.channel_gate.2.bias', 'visual.gated_enhancement.nir_gating.spatial_gate.0.weight', 'visual.gated_enhancement.nir_gating.spatial_gate.0.bias', 'visual.gated_enhancement.nir_gating.spatial_gate.2.weight', 'visual.gated_enhancement.nir_gating.spatial_gate.2.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.0.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.0.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.1.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.1.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.3.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.3.bias', 'visual.gated_enhancement.nir_gating.feature_fusion.4.weight', 'visual.gated_enhancement.nir_gating.feature_fusion.4.bias', 'visual.gated_enhancement.nir_gating.adaptive_weight.0.weight', 'visual.gated_enhancement.nir_gating.adaptive_weight.0.bias', 'visual.gated_enhancement.nir_gating.adaptive_weight.2.weight', 'visual.gated_enhancement.nir_gating.adaptive_weight.2.bias', 'visual.gated_enhancement.tir_gating.residual_weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.q_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.k_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.v_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.out_proj.weight', 'visual.gated_enhancement.tir_gating.cross_modal_attention.out_proj.bias', 'visual.gated_enhancement.tir_gating.channel_gate.0.weight', 'visual.gated_enhancement.tir_gating.channel_gate.0.bias', 'visual.gated_enhancement.tir_gating.channel_gate.2.weight', 'visual.gated_enhancement.tir_gating.channel_gate.2.bias', 'visual.gated_enhancement.tir_gating.spatial_gate.0.weight', 'visual.gated_enhancement.tir_gating.spatial_gate.0.bias', 'visual.gated_enhancement.tir_gating.spatial_gate.2.weight', 'visual.gated_enhancement.tir_gating.spatial_gate.2.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.0.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.0.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.1.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.1.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.3.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.3.bias', 'visual.gated_enhancement.tir_gating.feature_fusion.4.weight', 'visual.gated_enhancement.tir_gating.feature_fusion.4.bias', 'visual.gated_enhancement.tir_gating.adaptive_weight.0.weight', 'visual.gated_enhancement.tir_gating.adaptive_weight.0.bias', 'visual.gated_enhancement.tir_gating.adaptive_weight.2.weight', 'visual.gated_enhancement.tir_gating.adaptive_weight.2.bias', 'visual.gated_enhancement.global_coordination.interaction_net.0.weight', 'visual.gated_enhancement.global_coordination.interaction_net.0.bias', 'visual.gated_enhancement.global_coordination.interaction_net.1.weight', 'visual.gated_enhancement.global_coordination.interaction_net.1.bias', 'visual.gated_enhancement.global_coordination.interaction_net.3.weight', 'visual.gated_enhancement.global_coordination.interaction_net.3.bias', 'visual.gated_enhancement.global_coordination.interaction_net.4.weight', 'visual.gated_enhancement.global_coordination.interaction_net.4.bias', 'visual.gated_enhancement.global_coordination.balance_net.0.weight', 'visual.gated_enhancement.global_coordination.balance_net.0.bias', 'visual.gated_enhancement.global_coordination.balance_net.2.weight', 'visual.gated_enhancement.global_coordination.balance_net.2.bias', 'visual.gated_enhancement.global_coordination.global_gate.0.weight', 'visual.gated_enhancement.global_coordination.global_gate.0.bias', 'visual.gated_enhancement.global_coordination.global_gate.2.weight', 'visual.gated_enhancement.global_coordination.global_gate.2.bias'], unexpected_keys=[])
Loading pretrained model from CLIP
camera number is : 8
combineway: multimodelse mxa
2025-05-27 23:28:53,122 DeMo INFO: combineway: multimodelse
UsingDiversity: False mxa
===========Building DeMo===========
2025-05-27 23:28:53,132 DeMo INFO: DeMo(
  (BACKBONE): build_transformer_new(
    (base): VisionTransformer(
      (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
      (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (transformer): Transformer(
        (resblocks): Sequential(
          (0): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (1): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (2): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (3): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (4): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (5): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (6): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (7): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (8): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (9): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (10): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (11): ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): QuickGELU()
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (triple_dff): TripleInputDirectDFF(
        (avg_pool1): AdaptiveAvgPool1d(output_size=1)
        (avg_pool2): AdaptiveAvgPool1d(output_size=2)
        (avg_pool4): AdaptiveAvgPool1d(output_size=4)
        (fc_atten1): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
        (fc_atten2): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
        (fc_atten4): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
        (input_weight_net): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=768, out_features=3, bias=True)
          (3): Softmax(dim=-1)
        )
        (gate_fc): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=False)
          (1): Sigmoid()
        )
        (gate_enhancement): Sequential(
          (0): Linear(in_features=2304, out_features=2304, bias=True)
          (1): Tanh()
        )
        (fc_redu): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
        )
        (residual_fc1): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (residual_fc2): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (residual_fc3): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (residual_fusion): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (fc1): Linear(in_features=768, out_features=1, bias=True)
        (fc2): Linear(in_features=768, out_features=1, bias=True)
        (fc3): Linear(in_features=768, out_features=1, bias=True)
        (attention_fusion): Sequential(
          (0): Linear(in_features=3, out_features=1, bias=True)
          (1): Sigmoid()
        )
      )
      (quad_dffs): QuadInputHierarchicalDFF(
        (stage1_triple_dff): TripleInputDirectDFF(
          (avg_pool1): AdaptiveAvgPool1d(output_size=1)
          (avg_pool2): AdaptiveAvgPool1d(output_size=2)
          (avg_pool4): AdaptiveAvgPool1d(output_size=4)
          (fc_atten1): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
            (2): Sigmoid()
          )
          (fc_atten2): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
            (2): Sigmoid()
          )
          (fc_atten4): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): LayerNorm((2304,), eps=1e-05, elementwise_affine=True)
            (2): Sigmoid()
          )
          (input_weight_net): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=3, bias=True)
            (3): Softmax(dim=-1)
          )
          (gate_fc): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=False)
            (1): Sigmoid()
          )
          (gate_enhancement): Sequential(
            (0): Linear(in_features=2304, out_features=2304, bias=True)
            (1): Tanh()
          )
          (fc_redu): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
          )
          (residual_fc1): Sequential(
            (0): Linear(in_features=768, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (residual_fc2): Sequential(
            (0): Linear(in_features=768, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (residual_fc3): Sequential(
            (0): Linear(in_features=768, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (residual_fusion): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=False)
            (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (fc1): Linear(in_features=768, out_features=1, bias=True)
          (fc2): Linear(in_features=768, out_features=1, bias=True)
          (fc3): Linear(in_features=768, out_features=1, bias=True)
          (attention_fusion): Sequential(
            (0): Linear(in_features=3, out_features=1, bias=True)
            (1): Sigmoid()
          )
        )
        (stage1_enhancement): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
          (3): Linear(in_features=768, out_features=192, bias=True)
          (4): ReLU(inplace=True)
          (5): Linear(in_features=192, out_features=768, bias=True)
          (6): Sigmoid()
        )
        (input4_preprocessing): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
          (3): Linear(in_features=768, out_features=768, bias=True)
          (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (cross_stage_attention): Sequential(
          (0): Linear(in_features=768, out_features=96, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=96, out_features=768, bias=True)
          (3): Sigmoid()
        )
        (adaptive_fusion_weight): Sequential(
          (0): Linear(in_features=1536, out_features=192, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=192, out_features=2, bias=True)
          (3): Softmax(dim=-1)
        )
        (stage2_dff): InnovativeDFF(
          (avg_pool1): AdaptiveAvgPool1d(output_size=1)
          (avg_pool2): AdaptiveAvgPool1d(output_size=2)
          (avg_pool3): AdaptiveAvgPool1d(output_size=4)
          (fc_atten1): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (fc_atten2): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (fc_atten3): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (gate_fc): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=False)
            (1): Sigmoid()
          )
          (fc_redu): Linear(in_features=1536, out_features=768, bias=False)
          (residual_fc): Linear(in_features=768, out_features=768, bias=False)
          (fc1): Linear(in_features=768, out_features=1, bias=True)
          (fc2): Linear(in_features=768, out_features=1, bias=True)
          (nonlin): Sigmoid()
        )
        (memory_input1): Linear(in_features=768, out_features=768, bias=False)
        (memory_input4): Linear(in_features=768, out_features=768, bias=False)
        (memory_fusion): Sequential(
          (0): Linear(in_features=1536, out_features=768, bias=False)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (global_context): Sequential(
          (0): Linear(in_features=768, out_features=384, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=384, out_features=768, bias=True)
          (3): Sigmoid()
        )
        (final_refinement): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): ReLU(inplace=True)
          (3): Linear(in_features=768, out_features=768, bias=True)
          (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
      (gated_enhancement): GatedModalityEnhancement(
        (rgb_gating): ModalityGatingUnit(
          (cross_modal_attention): CrossModalAttentionGate(
            (q_proj): Linear(in_features=768, out_features=768, bias=False)
            (k_proj): Linear(in_features=768, out_features=768, bias=False)
            (v_proj): Linear(in_features=768, out_features=768, bias=False)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (channel_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=768, bias=True)
            (3): Sigmoid()
          )
          (spatial_gate): Sequential(
            (0): Linear(in_features=1536, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=1, bias=True)
            (3): Sigmoid()
          )
          (feature_fusion): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (adaptive_weight): Sequential(
            (0): Linear(in_features=1536, out_features=384, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=384, out_features=2, bias=True)
            (3): Softmax(dim=-1)
          )
        )
        (nir_gating): ModalityGatingUnit(
          (cross_modal_attention): CrossModalAttentionGate(
            (q_proj): Linear(in_features=768, out_features=768, bias=False)
            (k_proj): Linear(in_features=768, out_features=768, bias=False)
            (v_proj): Linear(in_features=768, out_features=768, bias=False)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (channel_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=768, bias=True)
            (3): Sigmoid()
          )
          (spatial_gate): Sequential(
            (0): Linear(in_features=1536, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=1, bias=True)
            (3): Sigmoid()
          )
          (feature_fusion): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (adaptive_weight): Sequential(
            (0): Linear(in_features=1536, out_features=384, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=384, out_features=2, bias=True)
            (3): Softmax(dim=-1)
          )
        )
        (tir_gating): ModalityGatingUnit(
          (cross_modal_attention): CrossModalAttentionGate(
            (q_proj): Linear(in_features=768, out_features=768, bias=False)
            (k_proj): Linear(in_features=768, out_features=768, bias=False)
            (v_proj): Linear(in_features=768, out_features=768, bias=False)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (channel_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=768, bias=True)
            (3): Sigmoid()
          )
          (spatial_gate): Sequential(
            (0): Linear(in_features=1536, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=1, bias=True)
            (3): Sigmoid()
          )
          (feature_fusion): Sequential(
            (0): Linear(in_features=1536, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (adaptive_weight): Sequential(
            (0): Linear(in_features=1536, out_features=384, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=384, out_features=2, bias=True)
            (3): Softmax(dim=-1)
          )
        )
        (global_coordination): GlobalCoordinationGate(
          (interaction_net): Sequential(
            (0): Linear(in_features=2304, out_features=1536, bias=True)
            (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (2): ReLU(inplace=True)
            (3): Linear(in_features=1536, out_features=768, bias=True)
            (4): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
          (balance_net): Sequential(
            (0): Linear(in_features=4608, out_features=768, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=768, out_features=3, bias=True)
            (3): Softmax(dim=-1)
          )
          (global_gate): Sequential(
            (0): Linear(in_features=768, out_features=192, bias=True)
            (1): ReLU(inplace=True)
            (2): Linear(in_features=192, out_features=1, bias=True)
            (3): Sigmoid()
          )
        )
      )
    )
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (rgb_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (nir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (tir_reduce): Sequential(
    (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): QuickGELU()
  )
  (generalFusion): GeneralFusion(
    (r): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (n): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (t): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (rn): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (rt): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (nt): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (rnt): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
    )
    (moe): MoM(
      (experts): ModuleList(
        (0): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (1): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (2): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (3): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (4): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (5): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (6): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
        (7): ExpertHead(
          (expertHead): ModuleList(
            (0): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (1): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (2): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (3): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (4): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (5): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
            (6): Expert(
              (mlp): Sequential(
                (0): Linear(in_features=64, out_features=64, bias=True)
                (1): QuickGELU()
                (2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              )
            )
          )
        )
      )
      (gating_network): GatingNetwork(
        (gate): CrossAttention(
          (linear_re): Sequential(
            (0): Linear(in_features=3584, out_features=512, bias=True)
            (1): QuickGELU()
            (2): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (q_): Linear(in_features=512, out_features=512, bias=False)
          (k_): Linear(in_features=512, out_features=512, bias=False)
        )
      )
    )
    (multimodal_token_se): MultiModalTokenSE(
      (rgb_aggregator): Sequential(
        (0): Linear(in_features=128, out_features=32, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=32, out_features=128, bias=True)
        (3): Sigmoid()
      )
      (nir_aggregator): Sequential(
        (0): Linear(in_features=128, out_features=32, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=32, out_features=128, bias=True)
        (3): Sigmoid()
      )
      (tir_aggregator): Sequential(
        (0): Linear(in_features=128, out_features=32, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=32, out_features=128, bias=True)
        (3): Sigmoid()
      )
      (adaptive_weighting): AdaptiveWeighting(
        (weight_net): Sequential(
          (0): Linear(in_features=384, out_features=128, bias=True)
          (1): ReLU(inplace=True)
          (2): Linear(in_features=128, out_features=384, bias=True)
          (3): Softmax(dim=-1)
        )
      )
      (global_context_net): Sequential(
        (0): Linear(in_features=384, out_features=128, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=128, out_features=128, bias=True)
        (3): Sigmoid()
      )
      (modal_balance): Sequential(
        (0): Linear(in_features=3, out_features=8, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=8, out_features=3, bias=True)
        (3): Softmax(dim=-1)
      )
      (enhancement_net): Sequential(
        (0): Linear(in_features=384, out_features=128, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=128, out_features=128, bias=True)
        (3): Sigmoid()
      )
    )
  )
  (classifier_moe): Linear(in_features=3584, out_features=50, bias=False)
  (bottleneck_moe): BatchNorm1d(3584, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_r): Linear(in_features=512, out_features=50, bias=False)
  (bottleneck_r): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_n): Linear(in_features=512, out_features=50, bias=False)
  (bottleneck_n): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (classifier_t): Linear(in_features=512, out_features=50, bias=False)
  (bottleneck_t): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)
2025-05-27 23:28:53,134 DeMo INFO: number of parameters:215.698532
using soft triplet loss for training
label smooth on, numclasses: 50
2025-05-27 23:28:53,227 DeMo.train INFO: start training
diversityweight: 1.0 mxa
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/ma1/work/demorelated/DeMo/modeling/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
/home/ma1/anaconda3/envs/DeMo/lib/python3.8/site-packages/torchvision/transforms/transforms.py:329: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
2025-05-27 23:29:14,784 DeMo.train INFO: Epoch[1] Iteration[10/129] Loss: 12.408, Acc: 0.017, Base Lr: 9.80e-05
2025-05-27 23:29:21,785 DeMo.train INFO: Epoch[1] Iteration[20/129] Loss: 10.585, Acc: 0.052, Base Lr: 9.80e-05
2025-05-27 23:29:28,907 DeMo.train INFO: Epoch[1] Iteration[30/129] Loss: 9.800, Acc: 0.108, Base Lr: 9.80e-05
2025-05-27 23:29:36,049 DeMo.train INFO: Epoch[1] Iteration[40/129] Loss: 9.315, Acc: 0.149, Base Lr: 9.80e-05
2025-05-27 23:29:43,206 DeMo.train INFO: Epoch[1] Iteration[50/129] Loss: 9.000, Acc: 0.167, Base Lr: 9.80e-05
2025-05-27 23:29:50,353 DeMo.train INFO: Epoch[1] Iteration[60/129] Loss: 8.768, Acc: 0.191, Base Lr: 9.80e-05
2025-05-27 23:29:57,501 DeMo.train INFO: Epoch[1] Iteration[70/129] Loss: 8.580, Acc: 0.212, Base Lr: 9.80e-05
2025-05-27 23:30:04,730 DeMo.train INFO: Epoch[1] Iteration[80/129] Loss: 8.396, Acc: 0.236, Base Lr: 9.80e-05
2025-05-27 23:30:11,860 DeMo.train INFO: Epoch[1] Iteration[90/129] Loss: 8.251, Acc: 0.256, Base Lr: 9.80e-05
2025-05-27 23:30:18,995 DeMo.train INFO: Epoch[1] Iteration[100/129] Loss: 8.114, Acc: 0.264, Base Lr: 9.80e-05
2025-05-27 23:30:26,140 DeMo.train INFO: Epoch[1] Iteration[110/129] Loss: 7.961, Acc: 0.276, Base Lr: 9.80e-05
2025-05-27 23:30:33,253 DeMo.train INFO: Epoch[1] Iteration[120/129] Loss: 7.796, Acc: 0.285, Base Lr: 9.80e-05
2025-05-27 23:30:38,322 DeMo.train INFO: Epoch 1 done. Time per batch: 0.827[s] Speed: 77.4[samples/s]
2025-05-27 23:30:38,326 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:30:38,326 DeMo.train INFO: Current is the ori feature testing!
2025-05-27 23:30:38,326 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.5970
CMC curve: Rank-1: 0.8216, Rank-5: 0.8501, Rank-10: 0.8641
=> Enter reranking
=> Results after reranking:
mAP: 0.6145
CMC curve: Rank-1: 0.8297, Rank-5: 0.8367, Rank-10: 0.8466
=> Improvement:
mAP improvement: 0.0175 (+2.93%)
Rank-1 improvement: 0.0082 (+0.99%)
2025-05-27 23:33:47,228 DeMo.train INFO: Validation Results - Epoch: 1
2025-05-27 23:33:47,228 DeMo.train INFO: mAP: 61.4%
2025-05-27 23:33:47,228 DeMo.train INFO: CMC curve, Rank-1  :83.0%
2025-05-27 23:33:47,228 DeMo.train INFO: CMC curve, Rank-5  :83.7%
2025-05-27 23:33:47,228 DeMo.train INFO: CMC curve, Rank-10 :84.7%
2025-05-27 23:33:47,229 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:33:47,236 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:33:47,237 DeMo.train INFO: Current is the moe feature testing!
2025-05-27 23:33:47,237 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/home/ma1/work/demorelated/DeMo/utils/reranking.py:40: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1420.)
  distmat.addmm_(1, -2, feat, feat.t())
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6411
CMC curve: Rank-1: 0.8472, Rank-5: 0.8647, Rank-10: 0.8729
=> Enter reranking
=> Results after reranking:
mAP: 0.6500
CMC curve: Rank-1: 0.8362, Rank-5: 0.8472, Rank-10: 0.8589
=> Improvement:
mAP improvement: 0.0089 (+1.38%)
Rank-1 improvement: -0.0111 (-1.31%)
2025-05-27 23:36:55,806 DeMo.train INFO: Validation Results - Epoch: 1
2025-05-27 23:36:55,807 DeMo.train INFO: mAP: 65.0%
2025-05-27 23:36:55,807 DeMo.train INFO: CMC curve, Rank-1  :83.6%
2025-05-27 23:36:55,807 DeMo.train INFO: CMC curve, Rank-5  :84.7%
2025-05-27 23:36:55,807 DeMo.train INFO: CMC curve, Rank-10 :85.9%
2025-05-27 23:36:55,807 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:36:56,168 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:36:56,168 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-27 23:36:56,168 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6497
CMC curve: Rank-1: 0.8525, Rank-5: 0.8735, Rank-10: 0.8869
=> Enter reranking
=> Results after reranking:
mAP: 0.6573
CMC curve: Rank-1: 0.8472, Rank-5: 0.8525, Rank-10: 0.8641
=> Improvement:
mAP improvement: 0.0076 (+1.17%)
Rank-1 improvement: -0.0052 (-0.62%)
2025-05-27 23:42:28,023 DeMo.train INFO: Validation Results - Epoch: 1
2025-05-27 23:42:28,023 DeMo.train INFO: mAP: 65.7%
2025-05-27 23:42:28,023 DeMo.train INFO: CMC curve, Rank-1  :84.7%
2025-05-27 23:42:28,023 DeMo.train INFO: CMC curve, Rank-5  :85.2%
2025-05-27 23:42:28,023 DeMo.train INFO: CMC curve, Rank-10 :86.4%
2025-05-27 23:42:28,023 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:42:36,082 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:42:36,082 DeMo.train INFO: Best mAP: 65.7%
2025-05-27 23:42:36,082 DeMo.train INFO: Best Rank-1: 84.7%
2025-05-27 23:42:36,082 DeMo.train INFO: Best Rank-5: 85.2%
2025-05-27 23:42:36,082 DeMo.train INFO: Best Rank-10: 86.4%
2025-05-27 23:42:36,082 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:42:47,467 DeMo.train INFO: Epoch[2] Iteration[10/129] Loss: 6.657, Acc: 0.338, Base Lr: 1.61e-04
2025-05-27 23:42:54,646 DeMo.train INFO: Epoch[2] Iteration[20/129] Loss: 6.854, Acc: 0.333, Base Lr: 1.61e-04
2025-05-27 23:43:01,802 DeMo.train INFO: Epoch[2] Iteration[30/129] Loss: 6.838, Acc: 0.362, Base Lr: 1.61e-04
2025-05-27 23:43:08,957 DeMo.train INFO: Epoch[2] Iteration[40/129] Loss: 6.653, Acc: 0.351, Base Lr: 1.61e-04
2025-05-27 23:43:16,110 DeMo.train INFO: Epoch[2] Iteration[50/129] Loss: 6.538, Acc: 0.348, Base Lr: 1.61e-04
2025-05-27 23:43:23,521 DeMo.train INFO: Epoch[2] Iteration[60/129] Loss: 6.466, Acc: 0.365, Base Lr: 1.61e-04
2025-05-27 23:43:38,453 DeMo.train INFO: Epoch[2] Iteration[70/129] Loss: 6.377, Acc: 0.357, Base Lr: 1.61e-04
2025-05-27 23:43:54,463 DeMo.train INFO: Epoch[2] Iteration[80/129] Loss: 6.200, Acc: 0.386, Base Lr: 1.61e-04
2025-05-27 23:44:10,471 DeMo.train INFO: Epoch[2] Iteration[90/129] Loss: 6.107, Acc: 0.399, Base Lr: 1.61e-04
2025-05-27 23:44:26,511 DeMo.train INFO: Epoch[2] Iteration[100/129] Loss: 5.932, Acc: 0.412, Base Lr: 1.61e-04
2025-05-27 23:44:42,542 DeMo.train INFO: Epoch[2] Iteration[110/129] Loss: 5.862, Acc: 0.425, Base Lr: 1.61e-04
2025-05-27 23:44:58,546 DeMo.train INFO: Epoch[2] Iteration[120/129] Loss: 5.765, Acc: 0.445, Base Lr: 1.61e-04
2025-05-27 23:45:09,932 DeMo.train INFO: Epoch 2 done. Time per batch: 1.211[s] Speed: 52.8[samples/s]
2025-05-27 23:45:09,944 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:45:09,944 DeMo.train INFO: Current is the ori feature testing!
2025-05-27 23:45:09,944 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.5943
CMC curve: Rank-1: 0.7913, Rank-5: 0.8163, Rank-10: 0.8350
=> Enter reranking
=> Results after reranking:
mAP: 0.6043
CMC curve: Rank-1: 0.7965, Rank-5: 0.8070, Rank-10: 0.8198
=> Improvement:
mAP improvement: 0.0100 (+1.68%)
Rank-1 improvement: 0.0052 (+0.66%)
2025-05-27 23:48:41,605 DeMo.train INFO: Validation Results - Epoch: 2
2025-05-27 23:48:41,605 DeMo.train INFO: mAP: 60.4%
2025-05-27 23:48:41,606 DeMo.train INFO: CMC curve, Rank-1  :79.7%
2025-05-27 23:48:41,606 DeMo.train INFO: CMC curve, Rank-5  :80.7%
2025-05-27 23:48:41,606 DeMo.train INFO: CMC curve, Rank-10 :82.0%
2025-05-27 23:48:41,606 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:48:42,980 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:48:42,980 DeMo.train INFO: Current is the moe feature testing!
2025-05-27 23:48:42,980 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6296
CMC curve: Rank-1: 0.8292, Rank-5: 0.8490, Rank-10: 0.8589
=> Enter reranking
=> Results after reranking:
mAP: 0.6387
CMC curve: Rank-1: 0.8280, Rank-5: 0.8332, Rank-10: 0.8356
=> Improvement:
mAP improvement: 0.0091 (+1.45%)
Rank-1 improvement: -0.0012 (-0.14%)
2025-05-27 23:52:00,576 DeMo.train INFO: Validation Results - Epoch: 2
2025-05-27 23:52:00,577 DeMo.train INFO: mAP: 63.9%
2025-05-27 23:52:00,577 DeMo.train INFO: CMC curve, Rank-1  :82.8%
2025-05-27 23:52:00,577 DeMo.train INFO: CMC curve, Rank-5  :83.3%
2025-05-27 23:52:00,577 DeMo.train INFO: CMC curve, Rank-10 :83.6%
2025-05-27 23:52:00,577 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:52:01,654 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:52:01,655 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-27 23:52:01,655 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.6204
CMC curve: Rank-1: 0.8210, Rank-5: 0.8402, Rank-10: 0.8548
=> Enter reranking
=> Results after reranking:
mAP: 0.6296
CMC curve: Rank-1: 0.8175, Rank-5: 0.8286, Rank-10: 0.8344
=> Improvement:
mAP improvement: 0.0092 (+1.48%)
Rank-1 improvement: -0.0035 (-0.43%)
2025-05-27 23:55:39,781 DeMo.train INFO: Validation Results - Epoch: 2
2025-05-27 23:55:39,781 DeMo.train INFO: mAP: 63.0%
2025-05-27 23:55:39,781 DeMo.train INFO: CMC curve, Rank-1  :81.7%
2025-05-27 23:55:39,781 DeMo.train INFO: CMC curve, Rank-5  :82.9%
2025-05-27 23:55:39,781 DeMo.train INFO: CMC curve, Rank-10 :83.4%
2025-05-27 23:55:39,781 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:55:40,085 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:55:40,085 DeMo.train INFO: Best mAP: 65.7%
2025-05-27 23:55:40,085 DeMo.train INFO: Best Rank-1: 84.7%
2025-05-27 23:55:40,085 DeMo.train INFO: Best Rank-5: 85.2%
2025-05-27 23:55:40,085 DeMo.train INFO: Best Rank-10: 86.4%
2025-05-27 23:55:40,085 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:55:50,712 DeMo.train INFO: Epoch[3] Iteration[10/129] Loss: 5.775, Acc: 0.417, Base Lr: 2.24e-04
2025-05-27 23:55:57,862 DeMo.train INFO: Epoch[3] Iteration[20/129] Loss: 5.166, Acc: 0.427, Base Lr: 2.24e-04
2025-05-27 23:56:04,985 DeMo.train INFO: Epoch[3] Iteration[30/129] Loss: 4.755, Acc: 0.510, Base Lr: 2.24e-04
2025-05-27 23:56:12,121 DeMo.train INFO: Epoch[3] Iteration[40/129] Loss: 4.514, Acc: 0.510, Base Lr: 2.24e-04
2025-05-27 23:56:19,300 DeMo.train INFO: Epoch[3] Iteration[50/129] Loss: 4.397, Acc: 0.509, Base Lr: 2.24e-04
2025-05-27 23:56:26,656 DeMo.train INFO: Epoch[3] Iteration[60/129] Loss: 4.289, Acc: 0.526, Base Lr: 2.24e-04
2025-05-27 23:56:33,833 DeMo.train INFO: Epoch[3] Iteration[70/129] Loss: 4.272, Acc: 0.537, Base Lr: 2.24e-04
2025-05-27 23:56:41,132 DeMo.train INFO: Epoch[3] Iteration[80/129] Loss: 4.227, Acc: 0.555, Base Lr: 2.24e-04
2025-05-27 23:56:48,279 DeMo.train INFO: Epoch[3] Iteration[90/129] Loss: 4.255, Acc: 0.563, Base Lr: 2.24e-04
2025-05-27 23:56:55,486 DeMo.train INFO: Epoch[3] Iteration[100/129] Loss: 4.221, Acc: 0.583, Base Lr: 2.24e-04
2025-05-27 23:57:02,916 DeMo.train INFO: Epoch[3] Iteration[110/129] Loss: 4.144, Acc: 0.594, Base Lr: 2.24e-04
2025-05-27 23:57:10,161 DeMo.train INFO: Epoch[3] Iteration[120/129] Loss: 4.044, Acc: 0.604, Base Lr: 2.24e-04
2025-05-27 23:57:16,064 DeMo.train INFO: Epoch 3 done. Time per batch: 0.750[s] Speed: 85.4[samples/s]
2025-05-27 23:57:16,076 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-27 23:57:16,076 DeMo.train INFO: Current is the ori feature testing!
2025-05-27 23:57:16,077 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7054
CMC curve: Rank-1: 0.8536, Rank-5: 0.8746, Rank-10: 0.8886
=> Enter reranking
=> Results after reranking:
mAP: 0.7136
CMC curve: Rank-1: 0.8601, Rank-5: 0.8671, Rank-10: 0.8735
=> Improvement:
mAP improvement: 0.0082 (+1.17%)
Rank-1 improvement: 0.0064 (+0.75%)
2025-05-28 00:00:35,981 DeMo.train INFO: Validation Results - Epoch: 3
2025-05-28 00:00:35,981 DeMo.train INFO: mAP: 71.4%
2025-05-28 00:00:35,981 DeMo.train INFO: CMC curve, Rank-1  :86.0%
2025-05-28 00:00:35,981 DeMo.train INFO: CMC curve, Rank-5  :86.7%
2025-05-28 00:00:35,981 DeMo.train INFO: CMC curve, Rank-10 :87.3%
2025-05-28 00:00:35,982 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:00:36,151 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:00:36,152 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 00:00:36,152 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7331
CMC curve: Rank-1: 0.8950, Rank-5: 0.9143, Rank-10: 0.9248
=> Enter reranking
=> Results after reranking:
mAP: 0.7408
CMC curve: Rank-1: 0.9096, Rank-5: 0.9160, Rank-10: 0.9230
=> Improvement:
mAP improvement: 0.0076 (+1.04%)
Rank-1 improvement: 0.0146 (+1.63%)
2025-05-28 00:04:21,936 DeMo.train INFO: Validation Results - Epoch: 3
2025-05-28 00:04:21,937 DeMo.train INFO: mAP: 74.1%
2025-05-28 00:04:21,937 DeMo.train INFO: CMC curve, Rank-1  :91.0%
2025-05-28 00:04:21,937 DeMo.train INFO: CMC curve, Rank-5  :91.6%
2025-05-28 00:04:21,937 DeMo.train INFO: CMC curve, Rank-10 :92.3%
2025-05-28 00:04:21,937 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:04:22,939 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:04:22,939 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 00:04:22,939 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7187
CMC curve: Rank-1: 0.8647, Rank-5: 0.8834, Rank-10: 0.8933
=> Enter reranking
=> Results after reranking:
mAP: 0.7251
CMC curve: Rank-1: 0.8653, Rank-5: 0.8700, Rank-10: 0.8805
=> Improvement:
mAP improvement: 0.0064 (+0.90%)
Rank-1 improvement: 0.0006 (+0.07%)
2025-05-28 00:08:06,515 DeMo.train INFO: Validation Results - Epoch: 3
2025-05-28 00:08:06,516 DeMo.train INFO: mAP: 72.5%
2025-05-28 00:08:06,516 DeMo.train INFO: CMC curve, Rank-1  :86.5%
2025-05-28 00:08:06,516 DeMo.train INFO: CMC curve, Rank-5  :87.0%
2025-05-28 00:08:06,516 DeMo.train INFO: CMC curve, Rank-10 :88.0%
2025-05-28 00:08:06,516 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:08:15,067 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:08:15,067 DeMo.train INFO: Best mAP: 72.5%
2025-05-28 00:08:15,067 DeMo.train INFO: Best Rank-1: 86.5%
2025-05-28 00:08:15,067 DeMo.train INFO: Best Rank-5: 87.0%
2025-05-28 00:08:15,067 DeMo.train INFO: Best Rank-10: 88.0%
2025-05-28 00:08:15,067 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:08:26,450 DeMo.train INFO: Epoch[4] Iteration[10/129] Loss: 3.382, Acc: 0.622, Base Lr: 2.87e-04
2025-05-28 00:08:33,589 DeMo.train INFO: Epoch[4] Iteration[20/129] Loss: 3.372, Acc: 0.678, Base Lr: 2.87e-04
2025-05-28 00:08:40,708 DeMo.train INFO: Epoch[4] Iteration[30/129] Loss: 3.298, Acc: 0.710, Base Lr: 2.87e-04
2025-05-28 00:08:48,019 DeMo.train INFO: Epoch[4] Iteration[40/129] Loss: 3.178, Acc: 0.738, Base Lr: 2.87e-04
2025-05-28 00:08:55,135 DeMo.train INFO: Epoch[4] Iteration[50/129] Loss: 3.196, Acc: 0.751, Base Lr: 2.87e-04
2025-05-28 00:09:02,271 DeMo.train INFO: Epoch[4] Iteration[60/129] Loss: 3.156, Acc: 0.767, Base Lr: 2.87e-04
2025-05-28 00:09:09,393 DeMo.train INFO: Epoch[4] Iteration[70/129] Loss: 3.156, Acc: 0.775, Base Lr: 2.87e-04
2025-05-28 00:09:16,497 DeMo.train INFO: Epoch[4] Iteration[80/129] Loss: 3.089, Acc: 0.786, Base Lr: 2.87e-04
2025-05-28 00:09:23,634 DeMo.train INFO: Epoch[4] Iteration[90/129] Loss: 3.035, Acc: 0.801, Base Lr: 2.87e-04
2025-05-28 00:09:30,787 DeMo.train INFO: Epoch[4] Iteration[100/129] Loss: 3.004, Acc: 0.810, Base Lr: 2.87e-04
2025-05-28 00:09:37,884 DeMo.train INFO: Epoch[4] Iteration[110/129] Loss: 2.974, Acc: 0.818, Base Lr: 2.87e-04
2025-05-28 00:09:45,014 DeMo.train INFO: Epoch[4] Iteration[120/129] Loss: 2.940, Acc: 0.830, Base Lr: 2.87e-04
2025-05-28 00:09:50,838 DeMo.train INFO: Epoch 4 done. Time per batch: 0.748[s] Speed: 85.5[samples/s]
2025-05-28 00:09:50,849 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:09:50,850 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 00:09:50,850 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7258
CMC curve: Rank-1: 0.8630, Rank-5: 0.8945, Rank-10: 0.9067
=> Enter reranking
=> Results after reranking:
mAP: 0.7332
CMC curve: Rank-1: 0.8601, Rank-5: 0.8717, Rank-10: 0.8776
=> Improvement:
mAP improvement: 0.0074 (+1.02%)
Rank-1 improvement: -0.0029 (-0.34%)
2025-05-28 00:13:27,563 DeMo.train INFO: Validation Results - Epoch: 4
2025-05-28 00:13:27,563 DeMo.train INFO: mAP: 73.3%
2025-05-28 00:13:27,563 DeMo.train INFO: CMC curve, Rank-1  :86.0%
2025-05-28 00:13:27,564 DeMo.train INFO: CMC curve, Rank-5  :87.2%
2025-05-28 00:13:27,564 DeMo.train INFO: CMC curve, Rank-10 :87.8%
2025-05-28 00:13:27,564 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:13:28,087 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:13:28,087 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 00:13:28,087 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7596
CMC curve: Rank-1: 0.9044, Rank-5: 0.9213, Rank-10: 0.9300
=> Enter reranking
=> Results after reranking:
mAP: 0.7669
CMC curve: Rank-1: 0.9085, Rank-5: 0.9166, Rank-10: 0.9195
=> Improvement:
mAP improvement: 0.0073 (+0.97%)
Rank-1 improvement: 0.0041 (+0.45%)
2025-05-28 00:16:51,068 DeMo.train INFO: Validation Results - Epoch: 4
2025-05-28 00:16:51,068 DeMo.train INFO: mAP: 76.7%
2025-05-28 00:16:51,068 DeMo.train INFO: CMC curve, Rank-1  :90.8%
2025-05-28 00:16:51,069 DeMo.train INFO: CMC curve, Rank-5  :91.7%
2025-05-28 00:16:51,069 DeMo.train INFO: CMC curve, Rank-10 :92.0%
2025-05-28 00:16:51,069 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:16:51,170 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:16:51,170 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 00:16:51,170 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7388
CMC curve: Rank-1: 0.8752, Rank-5: 0.9044, Rank-10: 0.9143
=> Enter reranking
=> Results after reranking:
mAP: 0.7470
CMC curve: Rank-1: 0.8764, Rank-5: 0.8840, Rank-10: 0.8898
=> Improvement:
mAP improvement: 0.0082 (+1.11%)
Rank-1 improvement: 0.0012 (+0.13%)
2025-05-28 00:20:05,028 DeMo.train INFO: Validation Results - Epoch: 4
2025-05-28 00:20:05,028 DeMo.train INFO: mAP: 74.7%
2025-05-28 00:20:05,029 DeMo.train INFO: CMC curve, Rank-1  :87.6%
2025-05-28 00:20:05,029 DeMo.train INFO: CMC curve, Rank-5  :88.4%
2025-05-28 00:20:05,029 DeMo.train INFO: CMC curve, Rank-10 :89.0%
2025-05-28 00:20:05,029 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:20:13,570 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:20:13,570 DeMo.train INFO: Best mAP: 74.7%
2025-05-28 00:20:13,570 DeMo.train INFO: Best Rank-1: 87.6%
2025-05-28 00:20:13,570 DeMo.train INFO: Best Rank-5: 88.4%
2025-05-28 00:20:13,570 DeMo.train INFO: Best Rank-10: 89.0%
2025-05-28 00:20:13,570 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:20:25,100 DeMo.train INFO: Epoch[5] Iteration[10/129] Loss: 2.860, Acc: 0.853, Base Lr: 3.27e-04
2025-05-28 00:20:32,353 DeMo.train INFO: Epoch[5] Iteration[20/129] Loss: 2.710, Acc: 0.838, Base Lr: 3.27e-04
2025-05-28 00:20:39,486 DeMo.train INFO: Epoch[5] Iteration[30/129] Loss: 2.663, Acc: 0.845, Base Lr: 3.27e-04
2025-05-28 00:20:46,631 DeMo.train INFO: Epoch[5] Iteration[40/129] Loss: 2.612, Acc: 0.833, Base Lr: 3.27e-04
2025-05-28 00:20:53,765 DeMo.train INFO: Epoch[5] Iteration[50/129] Loss: 2.565, Acc: 0.841, Base Lr: 3.27e-04
2025-05-28 00:21:00,894 DeMo.train INFO: Epoch[5] Iteration[60/129] Loss: 2.529, Acc: 0.842, Base Lr: 3.27e-04
2025-05-28 00:21:08,061 DeMo.train INFO: Epoch[5] Iteration[70/129] Loss: 2.515, Acc: 0.844, Base Lr: 3.27e-04
2025-05-28 00:21:15,222 DeMo.train INFO: Epoch[5] Iteration[80/129] Loss: 2.516, Acc: 0.836, Base Lr: 3.27e-04
2025-05-28 00:21:22,408 DeMo.train INFO: Epoch[5] Iteration[90/129] Loss: 2.503, Acc: 0.835, Base Lr: 3.27e-04
2025-05-28 00:21:29,974 DeMo.train INFO: Epoch[5] Iteration[100/129] Loss: 2.487, Acc: 0.837, Base Lr: 3.27e-04
2025-05-28 00:21:37,123 DeMo.train INFO: Epoch[5] Iteration[110/129] Loss: 2.462, Acc: 0.844, Base Lr: 3.27e-04
2025-05-28 00:21:44,300 DeMo.train INFO: Epoch[5] Iteration[120/129] Loss: 2.438, Acc: 0.850, Base Lr: 3.27e-04
2025-05-28 00:21:50,145 DeMo.train INFO: Epoch 5 done. Time per batch: 0.754[s] Speed: 84.8[samples/s]
2025-05-28 00:21:50,156 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:21:50,157 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 00:21:50,157 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7793
CMC curve: Rank-1: 0.9067, Rank-5: 0.9283, Rank-10: 0.9429
=> Enter reranking
=> Results after reranking:
mAP: 0.7850
CMC curve: Rank-1: 0.9050, Rank-5: 0.9120, Rank-10: 0.9213
=> Improvement:
mAP improvement: 0.0058 (+0.74%)
Rank-1 improvement: -0.0017 (-0.19%)
2025-05-28 00:25:18,433 DeMo.train INFO: Validation Results - Epoch: 5
2025-05-28 00:25:18,434 DeMo.train INFO: mAP: 78.5%
2025-05-28 00:25:18,434 DeMo.train INFO: CMC curve, Rank-1  :90.5%
2025-05-28 00:25:18,434 DeMo.train INFO: CMC curve, Rank-5  :91.2%
2025-05-28 00:25:18,434 DeMo.train INFO: CMC curve, Rank-10 :92.1%
2025-05-28 00:25:18,435 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:25:18,780 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:25:18,781 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 00:25:18,781 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7856
CMC curve: Rank-1: 0.9440, Rank-5: 0.9609, Rank-10: 0.9679
=> Enter reranking
=> Results after reranking:
mAP: 0.7922
CMC curve: Rank-1: 0.9481, Rank-5: 0.9539, Rank-10: 0.9586
=> Improvement:
mAP improvement: 0.0066 (+0.84%)
Rank-1 improvement: 0.0041 (+0.43%)
2025-05-28 00:28:33,404 DeMo.train INFO: Validation Results - Epoch: 5
2025-05-28 00:28:33,404 DeMo.train INFO: mAP: 79.2%
2025-05-28 00:28:33,404 DeMo.train INFO: CMC curve, Rank-1  :94.8%
2025-05-28 00:28:33,404 DeMo.train INFO: CMC curve, Rank-5  :95.4%
2025-05-28 00:28:33,404 DeMo.train INFO: CMC curve, Rank-10 :95.9%
2025-05-28 00:28:33,404 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:28:34,226 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:28:34,226 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 00:28:34,227 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7874
CMC curve: Rank-1: 0.9230, Rank-5: 0.9399, Rank-10: 0.9464
=> Enter reranking
=> Results after reranking:
mAP: 0.7931
CMC curve: Rank-1: 0.9184, Rank-5: 0.9254, Rank-10: 0.9283
=> Improvement:
mAP improvement: 0.0057 (+0.73%)
Rank-1 improvement: -0.0047 (-0.51%)
2025-05-28 00:31:48,502 DeMo.train INFO: Validation Results - Epoch: 5
2025-05-28 00:31:48,502 DeMo.train INFO: mAP: 79.3%
2025-05-28 00:31:48,502 DeMo.train INFO: CMC curve, Rank-1  :91.8%
2025-05-28 00:31:48,502 DeMo.train INFO: CMC curve, Rank-5  :92.5%
2025-05-28 00:31:48,503 DeMo.train INFO: CMC curve, Rank-10 :92.8%
2025-05-28 00:31:48,503 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:31:56,220 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:31:56,220 DeMo.train INFO: Best mAP: 79.3%
2025-05-28 00:31:56,220 DeMo.train INFO: Best Rank-1: 91.8%
2025-05-28 00:31:56,220 DeMo.train INFO: Best Rank-5: 92.5%
2025-05-28 00:31:56,220 DeMo.train INFO: Best Rank-10: 92.8%
2025-05-28 00:31:56,220 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:32:07,777 DeMo.train INFO: Epoch[6] Iteration[10/129] Loss: 2.398, Acc: 0.792, Base Lr: 3.17e-04
2025-05-28 00:32:14,903 DeMo.train INFO: Epoch[6] Iteration[20/129] Loss: 2.298, Acc: 0.808, Base Lr: 3.17e-04
2025-05-28 00:32:22,029 DeMo.train INFO: Epoch[6] Iteration[30/129] Loss: 2.274, Acc: 0.833, Base Lr: 3.17e-04
2025-05-28 00:32:29,283 DeMo.train INFO: Epoch[6] Iteration[40/129] Loss: 2.237, Acc: 0.858, Base Lr: 3.17e-04
2025-05-28 00:32:36,465 DeMo.train INFO: Epoch[6] Iteration[50/129] Loss: 2.210, Acc: 0.868, Base Lr: 3.17e-04
2025-05-28 00:32:43,676 DeMo.train INFO: Epoch[6] Iteration[60/129] Loss: 2.178, Acc: 0.883, Base Lr: 3.17e-04
2025-05-28 00:32:50,958 DeMo.train INFO: Epoch[6] Iteration[70/129] Loss: 2.160, Acc: 0.896, Base Lr: 3.17e-04
2025-05-28 00:32:58,190 DeMo.train INFO: Epoch[6] Iteration[80/129] Loss: 2.150, Acc: 0.902, Base Lr: 3.17e-04
2025-05-28 00:33:05,556 DeMo.train INFO: Epoch[6] Iteration[90/129] Loss: 2.138, Acc: 0.908, Base Lr: 3.17e-04
2025-05-28 00:33:13,159 DeMo.train INFO: Epoch[6] Iteration[100/129] Loss: 2.122, Acc: 0.916, Base Lr: 3.17e-04
2025-05-28 00:33:20,329 DeMo.train INFO: Epoch[6] Iteration[110/129] Loss: 2.108, Acc: 0.921, Base Lr: 3.17e-04
2025-05-28 00:33:27,522 DeMo.train INFO: Epoch[6] Iteration[120/129] Loss: 2.094, Acc: 0.928, Base Lr: 3.17e-04
2025-05-28 00:33:33,422 DeMo.train INFO: Epoch 6 done. Time per batch: 0.759[s] Speed: 84.3[samples/s]
2025-05-28 00:33:33,434 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:33:33,434 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 00:33:33,434 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7833
CMC curve: Rank-1: 0.9312, Rank-5: 0.9464, Rank-10: 0.9545
=> Enter reranking
=> Results after reranking:
mAP: 0.7885
CMC curve: Rank-1: 0.9254, Rank-5: 0.9312, Rank-10: 0.9353
=> Improvement:
mAP improvement: 0.0051 (+0.66%)
Rank-1 improvement: -0.0058 (-0.63%)
2025-05-28 00:36:52,518 DeMo.train INFO: Validation Results - Epoch: 6
2025-05-28 00:36:52,518 DeMo.train INFO: mAP: 78.8%
2025-05-28 00:36:52,519 DeMo.train INFO: CMC curve, Rank-1  :92.5%
2025-05-28 00:36:52,519 DeMo.train INFO: CMC curve, Rank-5  :93.1%
2025-05-28 00:36:52,519 DeMo.train INFO: CMC curve, Rank-10 :93.5%
2025-05-28 00:36:52,519 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:36:52,925 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:36:52,926 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 00:36:52,926 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7763
CMC curve: Rank-1: 0.9312, Rank-5: 0.9399, Rank-10: 0.9469
=> Enter reranking
=> Results after reranking:
mAP: 0.7835
CMC curve: Rank-1: 0.9353, Rank-5: 0.9423, Rank-10: 0.9475
=> Improvement:
mAP improvement: 0.0072 (+0.92%)
Rank-1 improvement: 0.0041 (+0.44%)
2025-05-28 00:40:11,533 DeMo.train INFO: Validation Results - Epoch: 6
2025-05-28 00:40:11,534 DeMo.train INFO: mAP: 78.3%
2025-05-28 00:40:11,534 DeMo.train INFO: CMC curve, Rank-1  :93.5%
2025-05-28 00:40:11,534 DeMo.train INFO: CMC curve, Rank-5  :94.2%
2025-05-28 00:40:11,534 DeMo.train INFO: CMC curve, Rank-10 :94.8%
2025-05-28 00:40:11,534 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:40:11,942 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:40:11,942 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 00:40:11,942 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7891
CMC curve: Rank-1: 0.9347, Rank-5: 0.9504, Rank-10: 0.9563
=> Enter reranking
=> Results after reranking:
mAP: 0.7953
CMC curve: Rank-1: 0.9399, Rank-5: 0.9452, Rank-10: 0.9499
=> Improvement:
mAP improvement: 0.0062 (+0.79%)
Rank-1 improvement: 0.0052 (+0.56%)
2025-05-28 00:43:37,253 DeMo.train INFO: Validation Results - Epoch: 6
2025-05-28 00:43:37,253 DeMo.train INFO: mAP: 79.5%
2025-05-28 00:43:37,254 DeMo.train INFO: CMC curve, Rank-1  :94.0%
2025-05-28 00:43:37,254 DeMo.train INFO: CMC curve, Rank-5  :94.5%
2025-05-28 00:43:37,254 DeMo.train INFO: CMC curve, Rank-10 :95.0%
2025-05-28 00:43:37,254 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:43:45,082 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:43:45,082 DeMo.train INFO: Best mAP: 79.5%
2025-05-28 00:43:45,082 DeMo.train INFO: Best Rank-1: 94.0%
2025-05-28 00:43:45,082 DeMo.train INFO: Best Rank-5: 94.5%
2025-05-28 00:43:45,082 DeMo.train INFO: Best Rank-10: 95.0%
2025-05-28 00:43:45,083 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:43:56,745 DeMo.train INFO: Epoch[7] Iteration[10/129] Loss: 1.966, Acc: 0.994, Base Lr: 3.05e-04
2025-05-28 00:44:04,007 DeMo.train INFO: Epoch[7] Iteration[20/129] Loss: 1.982, Acc: 0.982, Base Lr: 3.05e-04
2025-05-28 00:44:11,125 DeMo.train INFO: Epoch[7] Iteration[30/129] Loss: 1.987, Acc: 0.977, Base Lr: 3.05e-04
2025-05-28 00:44:18,306 DeMo.train INFO: Epoch[7] Iteration[40/129] Loss: 1.978, Acc: 0.979, Base Lr: 3.05e-04
2025-05-28 00:44:25,510 DeMo.train INFO: Epoch[7] Iteration[50/129] Loss: 1.967, Acc: 0.983, Base Lr: 3.05e-04
2025-05-28 00:44:32,682 DeMo.train INFO: Epoch[7] Iteration[60/129] Loss: 1.960, Acc: 0.985, Base Lr: 3.05e-04
2025-05-28 00:44:39,863 DeMo.train INFO: Epoch[7] Iteration[70/129] Loss: 1.957, Acc: 0.986, Base Lr: 3.05e-04
2025-05-28 00:44:47,026 DeMo.train INFO: Epoch[7] Iteration[80/129] Loss: 1.953, Acc: 0.988, Base Lr: 3.05e-04
2025-05-28 00:44:54,163 DeMo.train INFO: Epoch[7] Iteration[90/129] Loss: 1.946, Acc: 0.989, Base Lr: 3.05e-04
2025-05-28 00:45:01,302 DeMo.train INFO: Epoch[7] Iteration[100/129] Loss: 1.942, Acc: 0.990, Base Lr: 3.05e-04
2025-05-28 00:45:08,450 DeMo.train INFO: Epoch[7] Iteration[110/129] Loss: 1.937, Acc: 0.989, Base Lr: 3.05e-04
2025-05-28 00:45:16,323 DeMo.train INFO: Epoch[7] Iteration[120/129] Loss: 1.932, Acc: 0.990, Base Lr: 3.05e-04
2025-05-28 00:45:21,658 DeMo.train INFO: Epoch 7 done. Time per batch: 0.760[s] Speed: 84.2[samples/s]
2025-05-28 00:45:21,671 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:45:21,671 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 00:45:21,671 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7916
CMC curve: Rank-1: 0.9382, Rank-5: 0.9499, Rank-10: 0.9551
=> Enter reranking
=> Results after reranking:
mAP: 0.7967
CMC curve: Rank-1: 0.9318, Rank-5: 0.9388, Rank-10: 0.9458
=> Improvement:
mAP improvement: 0.0051 (+0.64%)
Rank-1 improvement: -0.0064 (-0.68%)
2025-05-28 00:49:02,854 DeMo.train INFO: Validation Results - Epoch: 7
2025-05-28 00:49:02,855 DeMo.train INFO: mAP: 79.7%
2025-05-28 00:49:02,855 DeMo.train INFO: CMC curve, Rank-1  :93.2%
2025-05-28 00:49:02,855 DeMo.train INFO: CMC curve, Rank-5  :93.9%
2025-05-28 00:49:02,855 DeMo.train INFO: CMC curve, Rank-10 :94.6%
2025-05-28 00:49:02,855 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:49:03,289 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:49:03,289 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 00:49:03,289 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7918
CMC curve: Rank-1: 0.9376, Rank-5: 0.9499, Rank-10: 0.9551
=> Enter reranking
=> Results after reranking:
mAP: 0.7981
CMC curve: Rank-1: 0.9475, Rank-5: 0.9493, Rank-10: 0.9504
=> Improvement:
mAP improvement: 0.0062 (+0.79%)
Rank-1 improvement: 0.0099 (+1.06%)
2025-05-28 00:52:24,628 DeMo.train INFO: Validation Results - Epoch: 7
2025-05-28 00:52:24,629 DeMo.train INFO: mAP: 79.8%
2025-05-28 00:52:24,629 DeMo.train INFO: CMC curve, Rank-1  :94.8%
2025-05-28 00:52:24,629 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 00:52:24,629 DeMo.train INFO: CMC curve, Rank-10 :95.0%
2025-05-28 00:52:24,629 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:52:24,659 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:52:24,660 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 00:52:24,660 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7983
CMC curve: Rank-1: 0.9423, Rank-5: 0.9545, Rank-10: 0.9603
=> Enter reranking
=> Results after reranking:
mAP: 0.8038
CMC curve: Rank-1: 0.9429, Rank-5: 0.9516, Rank-10: 0.9569
=> Improvement:
mAP improvement: 0.0055 (+0.69%)
Rank-1 improvement: 0.0006 (+0.06%)
2025-05-28 00:55:38,779 DeMo.train INFO: Validation Results - Epoch: 7
2025-05-28 00:55:38,779 DeMo.train INFO: mAP: 80.4%
2025-05-28 00:55:38,779 DeMo.train INFO: CMC curve, Rank-1  :94.3%
2025-05-28 00:55:38,779 DeMo.train INFO: CMC curve, Rank-5  :95.2%
2025-05-28 00:55:38,780 DeMo.train INFO: CMC curve, Rank-10 :95.7%
2025-05-28 00:55:38,780 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:55:46,511 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:55:46,511 DeMo.train INFO: Best mAP: 80.4%
2025-05-28 00:55:46,511 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 00:55:46,511 DeMo.train INFO: Best Rank-5: 95.2%
2025-05-28 00:55:46,511 DeMo.train INFO: Best Rank-10: 95.7%
2025-05-28 00:55:46,511 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:55:58,409 DeMo.train INFO: Epoch[8] Iteration[10/129] Loss: 1.872, Acc: 0.997, Base Lr: 2.92e-04
2025-05-28 00:56:05,669 DeMo.train INFO: Epoch[8] Iteration[20/129] Loss: 1.894, Acc: 0.997, Base Lr: 2.92e-04
2025-05-28 00:56:12,774 DeMo.train INFO: Epoch[8] Iteration[30/129] Loss: 1.895, Acc: 0.996, Base Lr: 2.92e-04
2025-05-28 00:56:19,898 DeMo.train INFO: Epoch[8] Iteration[40/129] Loss: 1.889, Acc: 0.994, Base Lr: 2.92e-04
2025-05-28 00:56:27,014 DeMo.train INFO: Epoch[8] Iteration[50/129] Loss: 1.890, Acc: 0.995, Base Lr: 2.92e-04
2025-05-28 00:56:34,120 DeMo.train INFO: Epoch[8] Iteration[60/129] Loss: 1.885, Acc: 0.994, Base Lr: 2.92e-04
2025-05-28 00:56:41,488 DeMo.train INFO: Epoch[8] Iteration[70/129] Loss: 1.881, Acc: 0.995, Base Lr: 2.92e-04
2025-05-28 00:56:49,792 DeMo.train INFO: Epoch[8] Iteration[80/129] Loss: 1.882, Acc: 0.994, Base Lr: 2.92e-04
2025-05-28 00:56:57,288 DeMo.train INFO: Epoch[8] Iteration[90/129] Loss: 1.878, Acc: 0.995, Base Lr: 2.92e-04
2025-05-28 00:57:05,541 DeMo.train INFO: Epoch[8] Iteration[100/129] Loss: 1.877, Acc: 0.995, Base Lr: 2.92e-04
2025-05-28 00:57:13,801 DeMo.train INFO: Epoch[8] Iteration[110/129] Loss: 1.874, Acc: 0.995, Base Lr: 2.92e-04
2025-05-28 00:57:20,943 DeMo.train INFO: Epoch[8] Iteration[120/129] Loss: 1.870, Acc: 0.996, Base Lr: 2.92e-04
2025-05-28 00:57:26,073 DeMo.train INFO: Epoch 8 done. Time per batch: 0.784[s] Speed: 81.6[samples/s]
2025-05-28 00:57:26,086 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 00:57:26,086 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 00:57:26,086 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7928
CMC curve: Rank-1: 0.9335, Rank-5: 0.9452, Rank-10: 0.9528
=> Enter reranking
=> Results after reranking:
mAP: 0.7991
CMC curve: Rank-1: 0.9359, Rank-5: 0.9399, Rank-10: 0.9429
=> Improvement:
mAP improvement: 0.0062 (+0.79%)
Rank-1 improvement: 0.0023 (+0.25%)
2025-05-28 01:01:31,958 DeMo.train INFO: Validation Results - Epoch: 8
2025-05-28 01:01:31,958 DeMo.train INFO: mAP: 79.9%
2025-05-28 01:01:31,958 DeMo.train INFO: CMC curve, Rank-1  :93.6%
2025-05-28 01:01:31,959 DeMo.train INFO: CMC curve, Rank-5  :94.0%
2025-05-28 01:01:31,959 DeMo.train INFO: CMC curve, Rank-10 :94.3%
2025-05-28 01:01:31,959 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:01:33,092 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:01:33,092 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 01:01:33,093 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8005
CMC curve: Rank-1: 0.9417, Rank-5: 0.9551, Rank-10: 0.9633
=> Enter reranking
=> Results after reranking:
mAP: 0.8052
CMC curve: Rank-1: 0.9458, Rank-5: 0.9499, Rank-10: 0.9545
=> Improvement:
mAP improvement: 0.0047 (+0.58%)
Rank-1 improvement: 0.0041 (+0.43%)
2025-05-28 01:07:19,113 DeMo.train INFO: Validation Results - Epoch: 8
2025-05-28 01:07:19,114 DeMo.train INFO: mAP: 80.5%
2025-05-28 01:07:19,114 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 01:07:19,114 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 01:07:19,114 DeMo.train INFO: CMC curve, Rank-10 :95.5%
2025-05-28 01:07:19,114 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:07:19,849 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:07:19,849 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 01:07:19,849 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7997
CMC curve: Rank-1: 0.9388, Rank-5: 0.9516, Rank-10: 0.9563
=> Enter reranking
=> Results after reranking:
mAP: 0.8049
CMC curve: Rank-1: 0.9364, Rank-5: 0.9394, Rank-10: 0.9434
=> Improvement:
mAP improvement: 0.0052 (+0.65%)
Rank-1 improvement: -0.0023 (-0.25%)
2025-05-28 01:12:06,271 DeMo.train INFO: Validation Results - Epoch: 8
2025-05-28 01:12:06,271 DeMo.train INFO: mAP: 80.5%
2025-05-28 01:12:06,271 DeMo.train INFO: CMC curve, Rank-1  :93.6%
2025-05-28 01:12:06,271 DeMo.train INFO: CMC curve, Rank-5  :93.9%
2025-05-28 01:12:06,272 DeMo.train INFO: CMC curve, Rank-10 :94.3%
2025-05-28 01:12:06,272 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:12:14,573 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:12:14,574 DeMo.train INFO: Best mAP: 80.5%
2025-05-28 01:12:14,574 DeMo.train INFO: Best Rank-1: 93.6%
2025-05-28 01:12:14,574 DeMo.train INFO: Best Rank-5: 93.9%
2025-05-28 01:12:14,574 DeMo.train INFO: Best Rank-10: 94.3%
2025-05-28 01:12:14,574 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:12:36,076 DeMo.train INFO: Epoch[9] Iteration[10/129] Loss: 1.838, Acc: 1.000, Base Lr: 2.78e-04
2025-05-28 01:12:52,053 DeMo.train INFO: Epoch[9] Iteration[20/129] Loss: 1.856, Acc: 0.998, Base Lr: 2.78e-04
2025-05-28 01:13:08,454 DeMo.train INFO: Epoch[9] Iteration[30/129] Loss: 1.859, Acc: 0.994, Base Lr: 2.78e-04
2025-05-28 01:13:24,486 DeMo.train INFO: Epoch[9] Iteration[40/129] Loss: 1.860, Acc: 0.995, Base Lr: 2.78e-04
2025-05-28 01:13:40,465 DeMo.train INFO: Epoch[9] Iteration[50/129] Loss: 1.858, Acc: 0.996, Base Lr: 2.78e-04
2025-05-28 01:13:56,472 DeMo.train INFO: Epoch[9] Iteration[60/129] Loss: 1.854, Acc: 0.997, Base Lr: 2.78e-04
2025-05-28 01:14:13,026 DeMo.train INFO: Epoch[9] Iteration[70/129] Loss: 1.854, Acc: 0.997, Base Lr: 2.78e-04
2025-05-28 01:14:29,067 DeMo.train INFO: Epoch[9] Iteration[80/129] Loss: 1.852, Acc: 0.997, Base Lr: 2.78e-04
2025-05-28 01:14:45,288 DeMo.train INFO: Epoch[9] Iteration[90/129] Loss: 1.850, Acc: 0.997, Base Lr: 2.78e-04
2025-05-28 01:14:56,486 DeMo.train INFO: Epoch[9] Iteration[100/129] Loss: 1.854, Acc: 0.997, Base Lr: 2.78e-04
2025-05-28 01:15:04,019 DeMo.train INFO: Epoch[9] Iteration[110/129] Loss: 1.852, Acc: 0.997, Base Lr: 2.78e-04
2025-05-28 01:15:11,236 DeMo.train INFO: Epoch[9] Iteration[120/129] Loss: 1.848, Acc: 0.998, Base Lr: 2.78e-04
2025-05-28 01:15:17,097 DeMo.train INFO: Epoch 9 done. Time per batch: 1.426[s] Speed: 44.9[samples/s]
2025-05-28 01:15:17,115 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:15:17,115 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 01:15:17,115 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7939
CMC curve: Rank-1: 0.9423, Rank-5: 0.9574, Rank-10: 0.9633
=> Enter reranking
=> Results after reranking:
mAP: 0.8005
CMC curve: Rank-1: 0.9399, Rank-5: 0.9522, Rank-10: 0.9557
=> Improvement:
mAP improvement: 0.0066 (+0.84%)
Rank-1 improvement: -0.0023 (-0.25%)
2025-05-28 01:20:32,703 DeMo.train INFO: Validation Results - Epoch: 9
2025-05-28 01:20:32,703 DeMo.train INFO: mAP: 80.1%
2025-05-28 01:20:32,704 DeMo.train INFO: CMC curve, Rank-1  :94.0%
2025-05-28 01:20:32,704 DeMo.train INFO: CMC curve, Rank-5  :95.2%
2025-05-28 01:20:32,704 DeMo.train INFO: CMC curve, Rank-10 :95.6%
2025-05-28 01:20:32,704 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:20:33,476 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:20:33,477 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 01:20:33,477 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7954
CMC curve: Rank-1: 0.9399, Rank-5: 0.9487, Rank-10: 0.9569
=> Enter reranking
=> Results after reranking:
mAP: 0.7984
CMC curve: Rank-1: 0.9364, Rank-5: 0.9399, Rank-10: 0.9446
=> Improvement:
mAP improvement: 0.0030 (+0.37%)
Rank-1 improvement: -0.0035 (-0.37%)
2025-05-28 01:25:42,274 DeMo.train INFO: Validation Results - Epoch: 9
2025-05-28 01:25:42,275 DeMo.train INFO: mAP: 79.8%
2025-05-28 01:25:42,275 DeMo.train INFO: CMC curve, Rank-1  :93.6%
2025-05-28 01:25:42,275 DeMo.train INFO: CMC curve, Rank-5  :94.0%
2025-05-28 01:25:42,275 DeMo.train INFO: CMC curve, Rank-10 :94.5%
2025-05-28 01:25:42,275 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:25:43,717 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:25:43,718 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 01:25:43,718 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8002
CMC curve: Rank-1: 0.9487, Rank-5: 0.9603, Rank-10: 0.9662
=> Enter reranking
=> Results after reranking:
mAP: 0.8066
CMC curve: Rank-1: 0.9522, Rank-5: 0.9598, Rank-10: 0.9633
=> Improvement:
mAP improvement: 0.0064 (+0.80%)
Rank-1 improvement: 0.0035 (+0.37%)
2025-05-28 01:30:28,804 DeMo.train INFO: Validation Results - Epoch: 9
2025-05-28 01:30:28,804 DeMo.train INFO: mAP: 80.7%
2025-05-28 01:30:28,804 DeMo.train INFO: CMC curve, Rank-1  :95.2%
2025-05-28 01:30:28,804 DeMo.train INFO: CMC curve, Rank-5  :96.0%
2025-05-28 01:30:28,804 DeMo.train INFO: CMC curve, Rank-10 :96.3%
2025-05-28 01:30:28,805 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:30:37,170 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:30:37,170 DeMo.train INFO: Best mAP: 80.7%
2025-05-28 01:30:37,170 DeMo.train INFO: Best Rank-1: 95.2%
2025-05-28 01:30:37,170 DeMo.train INFO: Best Rank-5: 96.0%
2025-05-28 01:30:37,170 DeMo.train INFO: Best Rank-10: 96.3%
2025-05-28 01:30:37,170 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:30:58,812 DeMo.train INFO: Epoch[10] Iteration[10/129] Loss: 1.856, Acc: 1.000, Base Lr: 2.63e-04
2025-05-28 01:31:14,884 DeMo.train INFO: Epoch[10] Iteration[20/129] Loss: 1.844, Acc: 0.998, Base Lr: 2.63e-04
2025-05-28 01:31:30,876 DeMo.train INFO: Epoch[10] Iteration[30/129] Loss: 1.834, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:31:46,888 DeMo.train INFO: Epoch[10] Iteration[40/129] Loss: 1.830, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:32:03,081 DeMo.train INFO: Epoch[10] Iteration[50/129] Loss: 1.828, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:32:19,097 DeMo.train INFO: Epoch[10] Iteration[60/129] Loss: 1.826, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:32:35,093 DeMo.train INFO: Epoch[10] Iteration[70/129] Loss: 1.823, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:32:51,612 DeMo.train INFO: Epoch[10] Iteration[80/129] Loss: 1.821, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:33:00,287 DeMo.train INFO: Epoch[10] Iteration[90/129] Loss: 1.821, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:33:07,443 DeMo.train INFO: Epoch[10] Iteration[100/129] Loss: 1.821, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:33:14,668 DeMo.train INFO: Epoch[10] Iteration[110/129] Loss: 1.820, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:33:21,819 DeMo.train INFO: Epoch[10] Iteration[120/129] Loss: 1.820, Acc: 0.999, Base Lr: 2.63e-04
2025-05-28 01:33:26,972 DeMo.train INFO: Epoch 10 done. Time per batch: 1.337[s] Speed: 47.9[samples/s]
2025-05-28 01:33:26,986 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:33:26,986 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 01:33:26,986 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7962
CMC curve: Rank-1: 0.9534, Rank-5: 0.9621, Rank-10: 0.9633
=> Enter reranking
=> Results after reranking:
mAP: 0.8026
CMC curve: Rank-1: 0.9446, Rank-5: 0.9475, Rank-10: 0.9534
=> Improvement:
mAP improvement: 0.0063 (+0.80%)
Rank-1 improvement: -0.0087 (-0.92%)
2025-05-28 01:38:52,850 DeMo.train INFO: Validation Results - Epoch: 10
2025-05-28 01:38:52,850 DeMo.train INFO: mAP: 80.3%
2025-05-28 01:38:52,850 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 01:38:52,850 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 01:38:52,850 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 01:38:52,851 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:38:53,117 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:38:53,117 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 01:38:53,117 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8028
CMC curve: Rank-1: 0.9440, Rank-5: 0.9615, Rank-10: 0.9685
=> Enter reranking
=> Results after reranking:
mAP: 0.8061
CMC curve: Rank-1: 0.9399, Rank-5: 0.9446, Rank-10: 0.9493
=> Improvement:
mAP improvement: 0.0034 (+0.42%)
Rank-1 improvement: -0.0041 (-0.43%)
2025-05-28 01:44:12,660 DeMo.train INFO: Validation Results - Epoch: 10
2025-05-28 01:44:12,660 DeMo.train INFO: mAP: 80.6%
2025-05-28 01:44:12,660 DeMo.train INFO: CMC curve, Rank-1  :94.0%
2025-05-28 01:44:12,661 DeMo.train INFO: CMC curve, Rank-5  :94.5%
2025-05-28 01:44:12,661 DeMo.train INFO: CMC curve, Rank-10 :94.9%
2025-05-28 01:44:12,661 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:44:13,416 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:44:13,416 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 01:44:13,416 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8025
CMC curve: Rank-1: 0.9551, Rank-5: 0.9627, Rank-10: 0.9644
=> Enter reranking
=> Results after reranking:
mAP: 0.8080
CMC curve: Rank-1: 0.9475, Rank-5: 0.9504, Rank-10: 0.9534
=> Improvement:
mAP improvement: 0.0055 (+0.69%)
Rank-1 improvement: -0.0076 (-0.79%)
2025-05-28 01:48:53,505 DeMo.train INFO: Validation Results - Epoch: 10
2025-05-28 01:48:53,506 DeMo.train INFO: mAP: 80.8%
2025-05-28 01:48:53,506 DeMo.train INFO: CMC curve, Rank-1  :94.8%
2025-05-28 01:48:53,506 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 01:48:53,506 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 01:48:53,506 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:49:02,129 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:49:02,129 DeMo.train INFO: Best mAP: 80.8%
2025-05-28 01:49:02,129 DeMo.train INFO: Best Rank-1: 94.8%
2025-05-28 01:49:02,129 DeMo.train INFO: Best Rank-5: 95.0%
2025-05-28 01:49:02,129 DeMo.train INFO: Best Rank-10: 95.3%
2025-05-28 01:49:02,129 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:49:23,935 DeMo.train INFO: Epoch[11] Iteration[10/129] Loss: 1.812, Acc: 1.000, Base Lr: 2.46e-04
2025-05-28 01:49:39,873 DeMo.train INFO: Epoch[11] Iteration[20/129] Loss: 1.814, Acc: 1.000, Base Lr: 2.46e-04
2025-05-28 01:49:55,844 DeMo.train INFO: Epoch[11] Iteration[30/129] Loss: 1.813, Acc: 1.000, Base Lr: 2.46e-04
2025-05-28 01:50:11,898 DeMo.train INFO: Epoch[11] Iteration[40/129] Loss: 1.813, Acc: 0.999, Base Lr: 2.46e-04
2025-05-28 01:50:28,010 DeMo.train INFO: Epoch[11] Iteration[50/129] Loss: 1.808, Acc: 0.999, Base Lr: 2.46e-04
2025-05-28 01:50:44,073 DeMo.train INFO: Epoch[11] Iteration[60/129] Loss: 1.807, Acc: 0.999, Base Lr: 2.46e-04
2025-05-28 01:51:00,214 DeMo.train INFO: Epoch[11] Iteration[70/129] Loss: 1.804, Acc: 0.999, Base Lr: 2.46e-04
2025-05-28 01:51:16,129 DeMo.train INFO: Epoch[11] Iteration[80/129] Loss: 1.805, Acc: 0.999, Base Lr: 2.46e-04
2025-05-28 01:51:31,709 DeMo.train INFO: Epoch[11] Iteration[90/129] Loss: 1.805, Acc: 0.999, Base Lr: 2.46e-04
2025-05-28 01:51:38,927 DeMo.train INFO: Epoch[11] Iteration[100/129] Loss: 1.803, Acc: 0.999, Base Lr: 2.46e-04
2025-05-28 01:51:46,116 DeMo.train INFO: Epoch[11] Iteration[110/129] Loss: 1.802, Acc: 0.999, Base Lr: 2.46e-04
2025-05-28 01:51:53,314 DeMo.train INFO: Epoch[11] Iteration[120/129] Loss: 1.800, Acc: 0.999, Base Lr: 2.46e-04
2025-05-28 01:51:58,499 DeMo.train INFO: Epoch 11 done. Time per batch: 1.389[s] Speed: 46.1[samples/s]
2025-05-28 01:51:58,511 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:51:58,511 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 01:51:58,511 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7955
CMC curve: Rank-1: 0.9528, Rank-5: 0.9638, Rank-10: 0.9656
=> Enter reranking
=> Results after reranking:
mAP: 0.8015
CMC curve: Rank-1: 0.9452, Rank-5: 0.9528, Rank-10: 0.9569
=> Improvement:
mAP improvement: 0.0061 (+0.76%)
Rank-1 improvement: -0.0076 (-0.80%)
2025-05-28 01:56:53,684 DeMo.train INFO: Validation Results - Epoch: 11
2025-05-28 01:56:53,685 DeMo.train INFO: mAP: 80.2%
2025-05-28 01:56:53,685 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 01:56:53,685 DeMo.train INFO: CMC curve, Rank-5  :95.3%
2025-05-28 01:56:53,685 DeMo.train INFO: CMC curve, Rank-10 :95.7%
2025-05-28 01:56:53,686 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:56:55,151 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 01:56:55,152 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 01:56:55,152 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7952
CMC curve: Rank-1: 0.9359, Rank-5: 0.9504, Rank-10: 0.9586
=> Enter reranking
=> Results after reranking:
mAP: 0.7989
CMC curve: Rank-1: 0.9394, Rank-5: 0.9452, Rank-10: 0.9464
=> Improvement:
mAP improvement: 0.0037 (+0.47%)
Rank-1 improvement: 0.0035 (+0.37%)
2025-05-28 02:01:33,933 DeMo.train INFO: Validation Results - Epoch: 11
2025-05-28 02:01:33,933 DeMo.train INFO: mAP: 79.9%
2025-05-28 02:01:33,933 DeMo.train INFO: CMC curve, Rank-1  :93.9%
2025-05-28 02:01:33,933 DeMo.train INFO: CMC curve, Rank-5  :94.5%
2025-05-28 02:01:33,934 DeMo.train INFO: CMC curve, Rank-10 :94.6%
2025-05-28 02:01:33,934 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:01:35,343 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:01:35,343 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 02:01:35,343 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8011
CMC curve: Rank-1: 0.9574, Rank-5: 0.9644, Rank-10: 0.9668
=> Enter reranking
=> Results after reranking:
mAP: 0.8066
CMC curve: Rank-1: 0.9504, Rank-5: 0.9545, Rank-10: 0.9563
=> Improvement:
mAP improvement: 0.0055 (+0.69%)
Rank-1 improvement: -0.0070 (-0.73%)
2025-05-28 02:05:56,150 DeMo.train INFO: Validation Results - Epoch: 11
2025-05-28 02:05:56,150 DeMo.train INFO: mAP: 80.7%
2025-05-28 02:05:56,150 DeMo.train INFO: CMC curve, Rank-1  :95.0%
2025-05-28 02:05:56,150 DeMo.train INFO: CMC curve, Rank-5  :95.5%
2025-05-28 02:05:56,150 DeMo.train INFO: CMC curve, Rank-10 :95.6%
2025-05-28 02:05:56,150 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:05:56,505 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:05:56,506 DeMo.train INFO: Best mAP: 80.8%
2025-05-28 02:05:56,506 DeMo.train INFO: Best Rank-1: 94.8%
2025-05-28 02:05:56,506 DeMo.train INFO: Best Rank-5: 95.0%
2025-05-28 02:05:56,506 DeMo.train INFO: Best Rank-10: 95.3%
2025-05-28 02:05:56,506 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:06:17,749 DeMo.train INFO: Epoch[12] Iteration[10/129] Loss: 1.805, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:06:33,591 DeMo.train INFO: Epoch[12] Iteration[20/129] Loss: 1.798, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:06:49,389 DeMo.train INFO: Epoch[12] Iteration[30/129] Loss: 1.795, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:07:05,211 DeMo.train INFO: Epoch[12] Iteration[40/129] Loss: 1.794, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:07:21,164 DeMo.train INFO: Epoch[12] Iteration[50/129] Loss: 1.793, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:07:37,092 DeMo.train INFO: Epoch[12] Iteration[60/129] Loss: 1.791, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:07:53,056 DeMo.train INFO: Epoch[12] Iteration[70/129] Loss: 1.790, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:08:09,023 DeMo.train INFO: Epoch[12] Iteration[80/129] Loss: 1.789, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:08:25,046 DeMo.train INFO: Epoch[12] Iteration[90/129] Loss: 1.789, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:08:41,040 DeMo.train INFO: Epoch[12] Iteration[100/129] Loss: 1.789, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:08:57,167 DeMo.train INFO: Epoch[12] Iteration[110/129] Loss: 1.788, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:09:13,133 DeMo.train INFO: Epoch[12] Iteration[120/129] Loss: 1.788, Acc: 1.000, Base Lr: 2.29e-04
2025-05-28 02:09:19,378 DeMo.train INFO: Epoch 12 done. Time per batch: 1.585[s] Speed: 40.4[samples/s]
2025-05-28 02:09:19,390 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:09:19,391 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 02:09:19,391 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7967
CMC curve: Rank-1: 0.9534, Rank-5: 0.9621, Rank-10: 0.9644
=> Enter reranking
=> Results after reranking:
mAP: 0.8029
CMC curve: Rank-1: 0.9452, Rank-5: 0.9493, Rank-10: 0.9534
=> Improvement:
mAP improvement: 0.0062 (+0.77%)
Rank-1 improvement: -0.0082 (-0.86%)
2025-05-28 02:13:59,329 DeMo.train INFO: Validation Results - Epoch: 12
2025-05-28 02:13:59,329 DeMo.train INFO: mAP: 80.3%
2025-05-28 02:13:59,329 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 02:13:59,329 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 02:13:59,330 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 02:13:59,330 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:14:00,553 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:14:00,553 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 02:14:00,553 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8005
CMC curve: Rank-1: 0.9440, Rank-5: 0.9580, Rank-10: 0.9638
=> Enter reranking
=> Results after reranking:
mAP: 0.8047
CMC curve: Rank-1: 0.9394, Rank-5: 0.9423, Rank-10: 0.9481
=> Improvement:
mAP improvement: 0.0042 (+0.53%)
Rank-1 improvement: -0.0047 (-0.49%)
2025-05-28 02:18:38,166 DeMo.train INFO: Validation Results - Epoch: 12
2025-05-28 02:18:38,166 DeMo.train INFO: mAP: 80.5%
2025-05-28 02:18:38,166 DeMo.train INFO: CMC curve, Rank-1  :93.9%
2025-05-28 02:18:38,166 DeMo.train INFO: CMC curve, Rank-5  :94.2%
2025-05-28 02:18:38,166 DeMo.train INFO: CMC curve, Rank-10 :94.8%
2025-05-28 02:18:38,167 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:18:38,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:18:38,728 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 02:18:38,728 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8027
CMC curve: Rank-1: 0.9557, Rank-5: 0.9633, Rank-10: 0.9673
=> Enter reranking
=> Results after reranking:
mAP: 0.8082
CMC curve: Rank-1: 0.9469, Rank-5: 0.9522, Rank-10: 0.9539
=> Improvement:
mAP improvement: 0.0055 (+0.68%)
Rank-1 improvement: -0.0087 (-0.92%)
2025-05-28 02:23:07,951 DeMo.train INFO: Validation Results - Epoch: 12
2025-05-28 02:23:07,951 DeMo.train INFO: mAP: 80.8%
2025-05-28 02:23:07,951 DeMo.train INFO: CMC curve, Rank-1  :94.7%
2025-05-28 02:23:07,951 DeMo.train INFO: CMC curve, Rank-5  :95.2%
2025-05-28 02:23:07,951 DeMo.train INFO: CMC curve, Rank-10 :95.4%
2025-05-28 02:23:07,952 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:23:16,078 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:23:16,079 DeMo.train INFO: Best mAP: 80.8%
2025-05-28 02:23:16,079 DeMo.train INFO: Best Rank-1: 94.7%
2025-05-28 02:23:16,079 DeMo.train INFO: Best Rank-5: 95.2%
2025-05-28 02:23:16,079 DeMo.train INFO: Best Rank-10: 95.4%
2025-05-28 02:23:16,079 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:23:36,821 DeMo.train INFO: Epoch[13] Iteration[10/129] Loss: 1.782, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:23:52,821 DeMo.train INFO: Epoch[13] Iteration[20/129] Loss: 1.781, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:24:08,940 DeMo.train INFO: Epoch[13] Iteration[30/129] Loss: 1.783, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:24:24,925 DeMo.train INFO: Epoch[13] Iteration[40/129] Loss: 1.781, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:24:40,924 DeMo.train INFO: Epoch[13] Iteration[50/129] Loss: 1.780, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:24:56,916 DeMo.train INFO: Epoch[13] Iteration[60/129] Loss: 1.781, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:25:12,929 DeMo.train INFO: Epoch[13] Iteration[70/129] Loss: 1.782, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:25:28,941 DeMo.train INFO: Epoch[13] Iteration[80/129] Loss: 1.780, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:25:45,097 DeMo.train INFO: Epoch[13] Iteration[90/129] Loss: 1.780, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:26:01,086 DeMo.train INFO: Epoch[13] Iteration[100/129] Loss: 1.779, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:26:10,411 DeMo.train INFO: Epoch[13] Iteration[110/129] Loss: 1.779, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:26:17,582 DeMo.train INFO: Epoch[13] Iteration[120/129] Loss: 1.779, Acc: 1.000, Base Lr: 2.12e-04
2025-05-28 02:26:23,448 DeMo.train INFO: Epoch 13 done. Time per batch: 1.464[s] Speed: 43.7[samples/s]
2025-05-28 02:26:23,461 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:26:23,461 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 02:26:23,462 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7965
CMC curve: Rank-1: 0.9528, Rank-5: 0.9609, Rank-10: 0.9650
=> Enter reranking
=> Results after reranking:
mAP: 0.8024
CMC curve: Rank-1: 0.9434, Rank-5: 0.9499, Rank-10: 0.9557
=> Improvement:
mAP improvement: 0.0059 (+0.74%)
Rank-1 improvement: -0.0093 (-0.98%)
2025-05-28 02:32:14,118 DeMo.train INFO: Validation Results - Epoch: 13
2025-05-28 02:32:14,119 DeMo.train INFO: mAP: 80.2%
2025-05-28 02:32:14,119 DeMo.train INFO: CMC curve, Rank-1  :94.3%
2025-05-28 02:32:14,119 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 02:32:14,119 DeMo.train INFO: CMC curve, Rank-10 :95.6%
2025-05-28 02:32:14,119 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:32:14,658 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:32:14,658 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 02:32:14,658 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7973
CMC curve: Rank-1: 0.9423, Rank-5: 0.9534, Rank-10: 0.9656
=> Enter reranking
=> Results after reranking:
mAP: 0.8026
CMC curve: Rank-1: 0.9429, Rank-5: 0.9534, Rank-10: 0.9598
=> Improvement:
mAP improvement: 0.0053 (+0.66%)
Rank-1 improvement: 0.0006 (+0.06%)
2025-05-28 02:37:56,762 DeMo.train INFO: Validation Results - Epoch: 13
2025-05-28 02:37:56,762 DeMo.train INFO: mAP: 80.3%
2025-05-28 02:37:56,762 DeMo.train INFO: CMC curve, Rank-1  :94.3%
2025-05-28 02:37:56,762 DeMo.train INFO: CMC curve, Rank-5  :95.3%
2025-05-28 02:37:56,763 DeMo.train INFO: CMC curve, Rank-10 :96.0%
2025-05-28 02:37:56,763 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:37:58,023 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:37:58,024 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 02:37:58,024 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8025
CMC curve: Rank-1: 0.9539, Rank-5: 0.9633, Rank-10: 0.9662
=> Enter reranking
=> Results after reranking:
mAP: 0.8077
CMC curve: Rank-1: 0.9475, Rank-5: 0.9528, Rank-10: 0.9545
=> Improvement:
mAP improvement: 0.0052 (+0.65%)
Rank-1 improvement: -0.0064 (-0.67%)
2025-05-28 02:43:36,691 DeMo.train INFO: Validation Results - Epoch: 13
2025-05-28 02:43:36,691 DeMo.train INFO: mAP: 80.8%
2025-05-28 02:43:36,691 DeMo.train INFO: CMC curve, Rank-1  :94.8%
2025-05-28 02:43:36,691 DeMo.train INFO: CMC curve, Rank-5  :95.3%
2025-05-28 02:43:36,691 DeMo.train INFO: CMC curve, Rank-10 :95.5%
2025-05-28 02:43:36,691 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:43:36,788 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:43:36,789 DeMo.train INFO: Best mAP: 80.8%
2025-05-28 02:43:36,789 DeMo.train INFO: Best Rank-1: 94.7%
2025-05-28 02:43:36,789 DeMo.train INFO: Best Rank-5: 95.2%
2025-05-28 02:43:36,789 DeMo.train INFO: Best Rank-10: 95.4%
2025-05-28 02:43:36,789 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:43:50,432 DeMo.train INFO: Epoch[14] Iteration[10/129] Loss: 1.777, Acc: 0.998, Base Lr: 1.93e-04
2025-05-28 02:43:57,721 DeMo.train INFO: Epoch[14] Iteration[20/129] Loss: 1.784, Acc: 0.999, Base Lr: 1.93e-04
2025-05-28 02:44:04,867 DeMo.train INFO: Epoch[14] Iteration[30/129] Loss: 1.783, Acc: 0.999, Base Lr: 1.93e-04
2025-05-28 02:44:12,076 DeMo.train INFO: Epoch[14] Iteration[40/129] Loss: 1.783, Acc: 0.999, Base Lr: 1.93e-04
2025-05-28 02:44:19,493 DeMo.train INFO: Epoch[14] Iteration[50/129] Loss: 1.783, Acc: 0.999, Base Lr: 1.93e-04
2025-05-28 02:44:26,709 DeMo.train INFO: Epoch[14] Iteration[60/129] Loss: 1.781, Acc: 0.999, Base Lr: 1.93e-04
2025-05-28 02:44:33,971 DeMo.train INFO: Epoch[14] Iteration[70/129] Loss: 1.780, Acc: 1.000, Base Lr: 1.93e-04
2025-05-28 02:44:46,036 DeMo.train INFO: Epoch[14] Iteration[80/129] Loss: 1.780, Acc: 1.000, Base Lr: 1.93e-04
2025-05-28 02:45:02,099 DeMo.train INFO: Epoch[14] Iteration[90/129] Loss: 1.779, Acc: 1.000, Base Lr: 1.93e-04
2025-05-28 02:45:18,747 DeMo.train INFO: Epoch[14] Iteration[100/129] Loss: 1.779, Acc: 1.000, Base Lr: 1.93e-04
2025-05-28 02:45:35,561 DeMo.train INFO: Epoch[14] Iteration[110/129] Loss: 1.779, Acc: 1.000, Base Lr: 1.93e-04
2025-05-28 02:45:51,627 DeMo.train INFO: Epoch[14] Iteration[120/129] Loss: 1.778, Acc: 1.000, Base Lr: 1.93e-04
2025-05-28 02:46:02,952 DeMo.train INFO: Epoch 14 done. Time per batch: 1.151[s] Speed: 55.6[samples/s]
2025-05-28 02:46:02,964 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:46:02,964 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 02:46:02,964 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7979
CMC curve: Rank-1: 0.9499, Rank-5: 0.9609, Rank-10: 0.9644
=> Enter reranking
=> Results after reranking:
mAP: 0.8037
CMC curve: Rank-1: 0.9423, Rank-5: 0.9458, Rank-10: 0.9493
=> Improvement:
mAP improvement: 0.0058 (+0.73%)
Rank-1 improvement: -0.0076 (-0.80%)
2025-05-28 02:50:55,609 DeMo.train INFO: Validation Results - Epoch: 14
2025-05-28 02:50:55,610 DeMo.train INFO: mAP: 80.4%
2025-05-28 02:50:55,610 DeMo.train INFO: CMC curve, Rank-1  :94.2%
2025-05-28 02:50:55,610 DeMo.train INFO: CMC curve, Rank-5  :94.6%
2025-05-28 02:50:55,610 DeMo.train INFO: CMC curve, Rank-10 :94.9%
2025-05-28 02:50:55,610 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:50:56,636 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:50:56,637 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 02:50:56,637 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7986
CMC curve: Rank-1: 0.9318, Rank-5: 0.9539, Rank-10: 0.9609
=> Enter reranking
=> Results after reranking:
mAP: 0.8043
CMC curve: Rank-1: 0.9353, Rank-5: 0.9452, Rank-10: 0.9516
=> Improvement:
mAP improvement: 0.0057 (+0.71%)
Rank-1 improvement: 0.0035 (+0.38%)
2025-05-28 02:55:38,331 DeMo.train INFO: Validation Results - Epoch: 14
2025-05-28 02:55:38,331 DeMo.train INFO: mAP: 80.4%
2025-05-28 02:55:38,331 DeMo.train INFO: CMC curve, Rank-1  :93.5%
2025-05-28 02:55:38,331 DeMo.train INFO: CMC curve, Rank-5  :94.5%
2025-05-28 02:55:38,331 DeMo.train INFO: CMC curve, Rank-10 :95.2%
2025-05-28 02:55:38,332 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:55:38,466 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 02:55:38,467 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 02:55:38,467 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8040
CMC curve: Rank-1: 0.9545, Rank-5: 0.9621, Rank-10: 0.9668
=> Enter reranking
=> Results after reranking:
mAP: 0.8091
CMC curve: Rank-1: 0.9434, Rank-5: 0.9481, Rank-10: 0.9510
=> Improvement:
mAP improvement: 0.0051 (+0.63%)
Rank-1 improvement: -0.0111 (-1.16%)
2025-05-28 03:01:51,930 DeMo.train INFO: Validation Results - Epoch: 14
2025-05-28 03:01:51,930 DeMo.train INFO: mAP: 80.9%
2025-05-28 03:01:51,930 DeMo.train INFO: CMC curve, Rank-1  :94.3%
2025-05-28 03:01:51,931 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 03:01:51,931 DeMo.train INFO: CMC curve, Rank-10 :95.1%
2025-05-28 03:01:51,931 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:02:00,146 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:02:00,146 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 03:02:00,146 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 03:02:00,146 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 03:02:00,146 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 03:02:00,146 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:02:22,688 DeMo.train INFO: Epoch[15] Iteration[10/129] Loss: 1.781, Acc: 1.000, Base Lr: 1.75e-04
2025-05-28 03:02:38,674 DeMo.train INFO: Epoch[15] Iteration[20/129] Loss: 1.778, Acc: 0.999, Base Lr: 1.75e-04
2025-05-28 03:02:54,628 DeMo.train INFO: Epoch[15] Iteration[30/129] Loss: 1.777, Acc: 0.999, Base Lr: 1.75e-04
2025-05-28 03:03:10,612 DeMo.train INFO: Epoch[15] Iteration[40/129] Loss: 1.779, Acc: 0.999, Base Lr: 1.75e-04
2025-05-28 03:03:26,608 DeMo.train INFO: Epoch[15] Iteration[50/129] Loss: 1.778, Acc: 0.999, Base Lr: 1.75e-04
2025-05-28 03:03:42,881 DeMo.train INFO: Epoch[15] Iteration[60/129] Loss: 1.776, Acc: 0.999, Base Lr: 1.75e-04
2025-05-28 03:03:59,322 DeMo.train INFO: Epoch[15] Iteration[70/129] Loss: 1.775, Acc: 0.999, Base Lr: 1.75e-04
2025-05-28 03:04:15,658 DeMo.train INFO: Epoch[15] Iteration[80/129] Loss: 1.774, Acc: 0.999, Base Lr: 1.75e-04
2025-05-28 03:04:32,005 DeMo.train INFO: Epoch[15] Iteration[90/129] Loss: 1.774, Acc: 0.999, Base Lr: 1.75e-04
2025-05-28 03:04:48,026 DeMo.train INFO: Epoch[15] Iteration[100/129] Loss: 1.773, Acc: 1.000, Base Lr: 1.75e-04
2025-05-28 03:05:04,613 DeMo.train INFO: Epoch[15] Iteration[110/129] Loss: 1.772, Acc: 1.000, Base Lr: 1.75e-04
2025-05-28 03:05:20,739 DeMo.train INFO: Epoch[15] Iteration[120/129] Loss: 1.772, Acc: 1.000, Base Lr: 1.75e-04
2025-05-28 03:05:32,161 DeMo.train INFO: Epoch 15 done. Time per batch: 1.669[s] Speed: 38.3[samples/s]
2025-05-28 03:05:32,166 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:05:32,166 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 03:05:32,166 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7966
CMC curve: Rank-1: 0.9522, Rank-5: 0.9603, Rank-10: 0.9650
=> Enter reranking
=> Results after reranking:
mAP: 0.8031
CMC curve: Rank-1: 0.9417, Rank-5: 0.9493, Rank-10: 0.9545
=> Improvement:
mAP improvement: 0.0064 (+0.81%)
Rank-1 improvement: -0.0105 (-1.10%)
2025-05-28 03:10:17,710 DeMo.train INFO: Validation Results - Epoch: 15
2025-05-28 03:10:17,710 DeMo.train INFO: mAP: 80.3%
2025-05-28 03:10:17,710 DeMo.train INFO: CMC curve, Rank-1  :94.2%
2025-05-28 03:10:17,710 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 03:10:17,710 DeMo.train INFO: CMC curve, Rank-10 :95.5%
2025-05-28 03:10:17,711 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:10:19,206 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:10:19,207 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 03:10:19,207 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7924
CMC curve: Rank-1: 0.9347, Rank-5: 0.9487, Rank-10: 0.9569
=> Enter reranking
=> Results after reranking:
mAP: 0.7998
CMC curve: Rank-1: 0.9464, Rank-5: 0.9557, Rank-10: 0.9598
=> Improvement:
mAP improvement: 0.0075 (+0.94%)
Rank-1 improvement: 0.0117 (+1.25%)
2025-05-28 03:14:58,751 DeMo.train INFO: Validation Results - Epoch: 15
2025-05-28 03:14:58,752 DeMo.train INFO: mAP: 80.0%
2025-05-28 03:14:58,752 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 03:14:58,752 DeMo.train INFO: CMC curve, Rank-5  :95.6%
2025-05-28 03:14:58,752 DeMo.train INFO: CMC curve, Rank-10 :96.0%
2025-05-28 03:14:58,752 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:14:59,575 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:14:59,575 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 03:14:59,575 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8024
CMC curve: Rank-1: 0.9557, Rank-5: 0.9627, Rank-10: 0.9668
=> Enter reranking
=> Results after reranking:
mAP: 0.8078
CMC curve: Rank-1: 0.9440, Rank-5: 0.9469, Rank-10: 0.9499
=> Improvement:
mAP improvement: 0.0055 (+0.68%)
Rank-1 improvement: -0.0117 (-1.22%)
2025-05-28 03:20:19,327 DeMo.train INFO: Validation Results - Epoch: 15
2025-05-28 03:20:19,327 DeMo.train INFO: mAP: 80.8%
2025-05-28 03:20:19,327 DeMo.train INFO: CMC curve, Rank-1  :94.4%
2025-05-28 03:20:19,327 DeMo.train INFO: CMC curve, Rank-5  :94.7%
2025-05-28 03:20:19,328 DeMo.train INFO: CMC curve, Rank-10 :95.0%
2025-05-28 03:20:19,328 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:20:19,769 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:20:19,769 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 03:20:19,769 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 03:20:19,770 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 03:20:19,770 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 03:20:19,770 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:20:41,069 DeMo.train INFO: Epoch[16] Iteration[10/129] Loss: 1.777, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:20:57,142 DeMo.train INFO: Epoch[16] Iteration[20/129] Loss: 1.775, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:21:13,217 DeMo.train INFO: Epoch[16] Iteration[30/129] Loss: 1.773, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:21:29,238 DeMo.train INFO: Epoch[16] Iteration[40/129] Loss: 1.773, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:21:45,167 DeMo.train INFO: Epoch[16] Iteration[50/129] Loss: 1.771, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:22:01,191 DeMo.train INFO: Epoch[16] Iteration[60/129] Loss: 1.769, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:22:09,731 DeMo.train INFO: Epoch[16] Iteration[70/129] Loss: 1.768, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:22:16,939 DeMo.train INFO: Epoch[16] Iteration[80/129] Loss: 1.767, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:22:24,074 DeMo.train INFO: Epoch[16] Iteration[90/129] Loss: 1.767, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:22:31,228 DeMo.train INFO: Epoch[16] Iteration[100/129] Loss: 1.766, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:22:38,366 DeMo.train INFO: Epoch[16] Iteration[110/129] Loss: 1.765, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:22:45,532 DeMo.train INFO: Epoch[16] Iteration[120/129] Loss: 1.764, Acc: 1.000, Base Lr: 1.57e-04
2025-05-28 03:22:51,391 DeMo.train INFO: Epoch 16 done. Time per batch: 1.185[s] Speed: 54.0[samples/s]
2025-05-28 03:22:51,395 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:22:51,395 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 03:22:51,396 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7950
CMC curve: Rank-1: 0.9539, Rank-5: 0.9621, Rank-10: 0.9673
=> Enter reranking
=> Results after reranking:
mAP: 0.8012
CMC curve: Rank-1: 0.9417, Rank-5: 0.9475, Rank-10: 0.9516
=> Improvement:
mAP improvement: 0.0062 (+0.78%)
Rank-1 improvement: -0.0122 (-1.28%)
2025-05-28 03:28:48,326 DeMo.train INFO: Validation Results - Epoch: 16
2025-05-28 03:28:48,327 DeMo.train INFO: mAP: 80.1%
2025-05-28 03:28:48,327 DeMo.train INFO: CMC curve, Rank-1  :94.2%
2025-05-28 03:28:48,327 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 03:28:48,327 DeMo.train INFO: CMC curve, Rank-10 :95.2%
2025-05-28 03:28:48,327 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:28:49,765 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:28:49,766 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 03:28:49,766 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8034
CMC curve: Rank-1: 0.9440, Rank-5: 0.9580, Rank-10: 0.9615
=> Enter reranking
=> Results after reranking:
mAP: 0.8107
CMC curve: Rank-1: 0.9510, Rank-5: 0.9563, Rank-10: 0.9609
=> Improvement:
mAP improvement: 0.0073 (+0.91%)
Rank-1 improvement: 0.0070 (+0.74%)
2025-05-28 03:34:41,291 DeMo.train INFO: Validation Results - Epoch: 16
2025-05-28 03:34:41,291 DeMo.train INFO: mAP: 81.1%
2025-05-28 03:34:41,292 DeMo.train INFO: CMC curve, Rank-1  :95.1%
2025-05-28 03:34:41,292 DeMo.train INFO: CMC curve, Rank-5  :95.6%
2025-05-28 03:34:41,292 DeMo.train INFO: CMC curve, Rank-10 :96.1%
2025-05-28 03:34:41,292 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:34:41,383 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:34:41,383 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 03:34:41,383 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.8016
CMC curve: Rank-1: 0.9551, Rank-5: 0.9644, Rank-10: 0.9679
=> Enter reranking
=> Results after reranking:
mAP: 0.8070
CMC curve: Rank-1: 0.9446, Rank-5: 0.9487, Rank-10: 0.9504
=> Improvement:
mAP improvement: 0.0054 (+0.67%)
Rank-1 improvement: -0.0105 (-1.10%)
2025-05-28 03:39:38,133 DeMo.train INFO: Validation Results - Epoch: 16
2025-05-28 03:39:38,133 DeMo.train INFO: mAP: 80.7%
2025-05-28 03:39:38,133 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 03:39:38,133 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 03:39:38,133 DeMo.train INFO: CMC curve, Rank-10 :95.0%
2025-05-28 03:39:38,134 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:39:38,754 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:39:38,754 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 03:39:38,754 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 03:39:38,754 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 03:39:38,754 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 03:39:38,754 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:39:49,486 DeMo.train INFO: Epoch[17] Iteration[10/129] Loss: 1.764, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:39:56,878 DeMo.train INFO: Epoch[17] Iteration[20/129] Loss: 1.767, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:40:03,987 DeMo.train INFO: Epoch[17] Iteration[30/129] Loss: 1.766, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:40:11,121 DeMo.train INFO: Epoch[17] Iteration[40/129] Loss: 1.765, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:40:18,257 DeMo.train INFO: Epoch[17] Iteration[50/129] Loss: 1.764, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:40:32,864 DeMo.train INFO: Epoch[17] Iteration[60/129] Loss: 1.764, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:40:48,914 DeMo.train INFO: Epoch[17] Iteration[70/129] Loss: 1.763, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:41:04,937 DeMo.train INFO: Epoch[17] Iteration[80/129] Loss: 1.763, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:41:20,967 DeMo.train INFO: Epoch[17] Iteration[90/129] Loss: 1.763, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:41:36,975 DeMo.train INFO: Epoch[17] Iteration[100/129] Loss: 1.762, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:41:53,065 DeMo.train INFO: Epoch[17] Iteration[110/129] Loss: 1.762, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:42:09,212 DeMo.train INFO: Epoch[17] Iteration[120/129] Loss: 1.761, Acc: 1.000, Base Lr: 1.39e-04
2025-05-28 03:42:20,565 DeMo.train INFO: Epoch 17 done. Time per batch: 1.274[s] Speed: 50.2[samples/s]
2025-05-28 03:42:20,570 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:42:20,570 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 03:42:20,570 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7933
CMC curve: Rank-1: 0.9504, Rank-5: 0.9603, Rank-10: 0.9633
=> Enter reranking
=> Results after reranking:
mAP: 0.7999
CMC curve: Rank-1: 0.9394, Rank-5: 0.9464, Rank-10: 0.9493
=> Improvement:
mAP improvement: 0.0066 (+0.83%)
Rank-1 improvement: -0.0111 (-1.17%)
2025-05-28 03:47:43,675 DeMo.train INFO: Validation Results - Epoch: 17
2025-05-28 03:47:43,675 DeMo.train INFO: mAP: 80.0%
2025-05-28 03:47:43,675 DeMo.train INFO: CMC curve, Rank-1  :93.9%
2025-05-28 03:47:43,675 DeMo.train INFO: CMC curve, Rank-5  :94.6%
2025-05-28 03:47:43,675 DeMo.train INFO: CMC curve, Rank-10 :94.9%
2025-05-28 03:47:43,676 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:47:44,644 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:47:44,644 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 03:47:44,644 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7951
CMC curve: Rank-1: 0.9394, Rank-5: 0.9545, Rank-10: 0.9603
=> Enter reranking
=> Results after reranking:
mAP: 0.8019
CMC curve: Rank-1: 0.9417, Rank-5: 0.9475, Rank-10: 0.9534
=> Improvement:
mAP improvement: 0.0067 (+0.85%)
Rank-1 improvement: 0.0023 (+0.25%)
2025-05-28 03:53:08,755 DeMo.train INFO: Validation Results - Epoch: 17
2025-05-28 03:53:08,755 DeMo.train INFO: mAP: 80.2%
2025-05-28 03:53:08,755 DeMo.train INFO: CMC curve, Rank-1  :94.2%
2025-05-28 03:53:08,755 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 03:53:08,755 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 03:53:08,755 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:53:09,451 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:53:09,451 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 03:53:09,451 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7993
CMC curve: Rank-1: 0.9539, Rank-5: 0.9621, Rank-10: 0.9627
=> Enter reranking
=> Results after reranking:
mAP: 0.8050
CMC curve: Rank-1: 0.9434, Rank-5: 0.9475, Rank-10: 0.9499
=> Improvement:
mAP improvement: 0.0056 (+0.70%)
Rank-1 improvement: -0.0105 (-1.10%)
2025-05-28 03:58:58,654 DeMo.train INFO: Validation Results - Epoch: 17
2025-05-28 03:58:58,654 DeMo.train INFO: mAP: 80.5%
2025-05-28 03:58:58,654 DeMo.train INFO: CMC curve, Rank-1  :94.3%
2025-05-28 03:58:58,654 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 03:58:58,654 DeMo.train INFO: CMC curve, Rank-10 :95.0%
2025-05-28 03:58:58,654 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:58:59,158 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:58:59,158 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 03:58:59,158 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 03:58:59,158 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 03:58:59,158 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 03:58:59,158 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 03:59:20,334 DeMo.train INFO: Epoch[18] Iteration[10/129] Loss: 1.764, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 03:59:36,217 DeMo.train INFO: Epoch[18] Iteration[20/129] Loss: 1.763, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 03:59:52,143 DeMo.train INFO: Epoch[18] Iteration[30/129] Loss: 1.766, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:00:08,182 DeMo.train INFO: Epoch[18] Iteration[40/129] Loss: 1.764, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:00:24,300 DeMo.train INFO: Epoch[18] Iteration[50/129] Loss: 1.762, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:00:40,303 DeMo.train INFO: Epoch[18] Iteration[60/129] Loss: 1.761, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:00:56,325 DeMo.train INFO: Epoch[18] Iteration[70/129] Loss: 1.760, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:01:12,458 DeMo.train INFO: Epoch[18] Iteration[80/129] Loss: 1.760, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:01:28,380 DeMo.train INFO: Epoch[18] Iteration[90/129] Loss: 1.758, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:01:38,101 DeMo.train INFO: Epoch[18] Iteration[100/129] Loss: 1.758, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:01:45,253 DeMo.train INFO: Epoch[18] Iteration[110/129] Loss: 1.757, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:01:52,371 DeMo.train INFO: Epoch[18] Iteration[120/129] Loss: 1.756, Acc: 1.000, Base Lr: 1.21e-04
2025-05-28 04:01:57,491 DeMo.train INFO: Epoch 18 done. Time per batch: 1.404[s] Speed: 45.6[samples/s]
2025-05-28 04:01:57,496 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:01:57,496 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 04:01:57,496 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7913
CMC curve: Rank-1: 0.9481, Rank-5: 0.9574, Rank-10: 0.9627
=> Enter reranking
=> Results after reranking:
mAP: 0.7979
CMC curve: Rank-1: 0.9382, Rank-5: 0.9440, Rank-10: 0.9499
=> Improvement:
mAP improvement: 0.0066 (+0.84%)
Rank-1 improvement: -0.0099 (-1.05%)
2025-05-28 04:06:47,510 DeMo.train INFO: Validation Results - Epoch: 18
2025-05-28 04:06:47,511 DeMo.train INFO: mAP: 79.8%
2025-05-28 04:06:47,511 DeMo.train INFO: CMC curve, Rank-1  :93.8%
2025-05-28 04:06:47,511 DeMo.train INFO: CMC curve, Rank-5  :94.4%
2025-05-28 04:06:47,511 DeMo.train INFO: CMC curve, Rank-10 :95.0%
2025-05-28 04:06:47,511 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:06:48,572 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:06:48,572 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 04:06:48,572 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7939
CMC curve: Rank-1: 0.9417, Rank-5: 0.9516, Rank-10: 0.9586
=> Enter reranking
=> Results after reranking:
mAP: 0.8024
CMC curve: Rank-1: 0.9434, Rank-5: 0.9504, Rank-10: 0.9534
=> Improvement:
mAP improvement: 0.0085 (+1.07%)
Rank-1 improvement: 0.0017 (+0.19%)
2025-05-28 04:12:12,110 DeMo.train INFO: Validation Results - Epoch: 18
2025-05-28 04:12:12,110 DeMo.train INFO: mAP: 80.2%
2025-05-28 04:12:12,110 DeMo.train INFO: CMC curve, Rank-1  :94.3%
2025-05-28 04:12:12,110 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 04:12:12,110 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 04:12:12,110 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:12:13,542 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:12:13,542 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 04:12:13,542 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7971
CMC curve: Rank-1: 0.9522, Rank-5: 0.9586, Rank-10: 0.9644
=> Enter reranking
=> Results after reranking:
mAP: 0.8033
CMC curve: Rank-1: 0.9452, Rank-5: 0.9487, Rank-10: 0.9499
=> Improvement:
mAP improvement: 0.0061 (+0.77%)
Rank-1 improvement: -0.0070 (-0.73%)
2025-05-28 04:17:11,550 DeMo.train INFO: Validation Results - Epoch: 18
2025-05-28 04:17:11,550 DeMo.train INFO: mAP: 80.3%
2025-05-28 04:17:11,550 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 04:17:11,550 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 04:17:11,551 DeMo.train INFO: CMC curve, Rank-10 :95.0%
2025-05-28 04:17:11,551 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:17:11,802 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:17:11,802 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 04:17:11,802 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 04:17:11,802 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 04:17:11,802 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 04:17:11,802 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:17:30,773 DeMo.train INFO: Epoch[19] Iteration[10/129] Loss: 1.754, Acc: 1.000, Base Lr: 1.04e-04
2025-05-28 04:17:37,993 DeMo.train INFO: Epoch[19] Iteration[20/129] Loss: 1.753, Acc: 0.999, Base Lr: 1.04e-04
2025-05-28 04:17:45,120 DeMo.train INFO: Epoch[19] Iteration[30/129] Loss: 1.753, Acc: 0.999, Base Lr: 1.04e-04
2025-05-28 04:17:52,300 DeMo.train INFO: Epoch[19] Iteration[40/129] Loss: 1.755, Acc: 1.000, Base Lr: 1.04e-04
2025-05-28 04:17:59,462 DeMo.train INFO: Epoch[19] Iteration[50/129] Loss: 1.756, Acc: 1.000, Base Lr: 1.04e-04
2025-05-28 04:18:06,623 DeMo.train INFO: Epoch[19] Iteration[60/129] Loss: 1.756, Acc: 0.999, Base Lr: 1.04e-04
2025-05-28 04:18:13,956 DeMo.train INFO: Epoch[19] Iteration[70/129] Loss: 1.756, Acc: 1.000, Base Lr: 1.04e-04
2025-05-28 04:18:21,096 DeMo.train INFO: Epoch[19] Iteration[80/129] Loss: 1.755, Acc: 0.999, Base Lr: 1.04e-04
2025-05-28 04:18:28,249 DeMo.train INFO: Epoch[19] Iteration[90/129] Loss: 1.754, Acc: 0.999, Base Lr: 1.04e-04
2025-05-28 04:18:37,032 DeMo.train INFO: Epoch[19] Iteration[100/129] Loss: 1.754, Acc: 1.000, Base Lr: 1.04e-04
2025-05-28 04:18:51,394 DeMo.train INFO: Epoch[19] Iteration[110/129] Loss: 1.753, Acc: 1.000, Base Lr: 1.04e-04
2025-05-28 04:19:05,597 DeMo.train INFO: Epoch[19] Iteration[120/129] Loss: 1.753, Acc: 1.000, Base Lr: 1.04e-04
2025-05-28 04:19:15,823 DeMo.train INFO: Epoch 19 done. Time per batch: 0.977[s] Speed: 65.5[samples/s]
2025-05-28 04:19:15,828 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:19:15,828 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 04:19:15,828 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7908
CMC curve: Rank-1: 0.9469, Rank-5: 0.9569, Rank-10: 0.9621
=> Enter reranking
=> Results after reranking:
mAP: 0.7971
CMC curve: Rank-1: 0.9394, Rank-5: 0.9452, Rank-10: 0.9534
=> Improvement:
mAP improvement: 0.0064 (+0.81%)
Rank-1 improvement: -0.0076 (-0.80%)
2025-05-28 04:24:45,626 DeMo.train INFO: Validation Results - Epoch: 19
2025-05-28 04:24:45,627 DeMo.train INFO: mAP: 79.7%
2025-05-28 04:24:45,627 DeMo.train INFO: CMC curve, Rank-1  :93.9%
2025-05-28 04:24:45,627 DeMo.train INFO: CMC curve, Rank-5  :94.5%
2025-05-28 04:24:45,627 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 04:24:45,627 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:24:45,807 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:24:45,807 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 04:24:45,807 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7904
CMC curve: Rank-1: 0.9388, Rank-5: 0.9481, Rank-10: 0.9569
=> Enter reranking
=> Results after reranking:
mAP: 0.7979
CMC curve: Rank-1: 0.9394, Rank-5: 0.9440, Rank-10: 0.9504
=> Improvement:
mAP improvement: 0.0075 (+0.94%)
Rank-1 improvement: 0.0006 (+0.06%)
2025-05-28 04:29:37,343 DeMo.train INFO: Validation Results - Epoch: 19
2025-05-28 04:29:37,344 DeMo.train INFO: mAP: 79.8%
2025-05-28 04:29:37,344 DeMo.train INFO: CMC curve, Rank-1  :93.9%
2025-05-28 04:29:37,344 DeMo.train INFO: CMC curve, Rank-5  :94.4%
2025-05-28 04:29:37,344 DeMo.train INFO: CMC curve, Rank-10 :95.0%
2025-05-28 04:29:37,344 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:29:37,907 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:29:37,907 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 04:29:37,908 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7969
CMC curve: Rank-1: 0.9510, Rank-5: 0.9580, Rank-10: 0.9638
=> Enter reranking
=> Results after reranking:
mAP: 0.8024
CMC curve: Rank-1: 0.9411, Rank-5: 0.9446, Rank-10: 0.9493
=> Improvement:
mAP improvement: 0.0054 (+0.68%)
Rank-1 improvement: -0.0099 (-1.04%)
2025-05-28 04:34:44,937 DeMo.train INFO: Validation Results - Epoch: 19
2025-05-28 04:34:44,937 DeMo.train INFO: mAP: 80.2%
2025-05-28 04:34:44,937 DeMo.train INFO: CMC curve, Rank-1  :94.1%
2025-05-28 04:34:44,937 DeMo.train INFO: CMC curve, Rank-5  :94.5%
2025-05-28 04:34:44,937 DeMo.train INFO: CMC curve, Rank-10 :94.9%
2025-05-28 04:34:44,938 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:34:46,167 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:34:46,167 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 04:34:46,167 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 04:34:46,167 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 04:34:46,167 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 04:34:46,168 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:34:57,302 DeMo.train INFO: Epoch[20] Iteration[10/129] Loss: 1.751, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:35:04,708 DeMo.train INFO: Epoch[20] Iteration[20/129] Loss: 1.752, Acc: 0.999, Base Lr: 8.78e-05
2025-05-28 04:35:11,828 DeMo.train INFO: Epoch[20] Iteration[30/129] Loss: 1.751, Acc: 0.999, Base Lr: 8.78e-05
2025-05-28 04:35:19,302 DeMo.train INFO: Epoch[20] Iteration[40/129] Loss: 1.749, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:35:32,606 DeMo.train INFO: Epoch[20] Iteration[50/129] Loss: 1.749, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:35:46,837 DeMo.train INFO: Epoch[20] Iteration[60/129] Loss: 1.750, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:36:01,326 DeMo.train INFO: Epoch[20] Iteration[70/129] Loss: 1.749, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:36:15,800 DeMo.train INFO: Epoch[20] Iteration[80/129] Loss: 1.749, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:36:30,289 DeMo.train INFO: Epoch[20] Iteration[90/129] Loss: 1.749, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:36:44,767 DeMo.train INFO: Epoch[20] Iteration[100/129] Loss: 1.748, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:36:59,256 DeMo.train INFO: Epoch[20] Iteration[110/129] Loss: 1.748, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:37:13,782 DeMo.train INFO: Epoch[20] Iteration[120/129] Loss: 1.748, Acc: 1.000, Base Lr: 8.78e-05
2025-05-28 04:37:24,042 DeMo.train INFO: Epoch 20 done. Time per batch: 1.243[s] Speed: 51.5[samples/s]
2025-05-28 04:37:24,046 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:37:24,047 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 04:37:24,047 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7904
CMC curve: Rank-1: 0.9475, Rank-5: 0.9603, Rank-10: 0.9656
=> Enter reranking
=> Results after reranking:
mAP: 0.7968
CMC curve: Rank-1: 0.9405, Rank-5: 0.9493, Rank-10: 0.9539
=> Improvement:
mAP improvement: 0.0064 (+0.81%)
Rank-1 improvement: -0.0070 (-0.74%)
2025-05-28 04:43:09,126 DeMo.train INFO: Validation Results - Epoch: 20
2025-05-28 04:43:09,126 DeMo.train INFO: mAP: 79.7%
2025-05-28 04:43:09,126 DeMo.train INFO: CMC curve, Rank-1  :94.1%
2025-05-28 04:43:09,126 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 04:43:09,127 DeMo.train INFO: CMC curve, Rank-10 :95.4%
2025-05-28 04:43:09,127 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:43:09,522 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:43:09,523 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 04:43:09,523 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7932
CMC curve: Rank-1: 0.9446, Rank-5: 0.9574, Rank-10: 0.9609
=> Enter reranking
=> Results after reranking:
mAP: 0.8005
CMC curve: Rank-1: 0.9481, Rank-5: 0.9563, Rank-10: 0.9574
=> Improvement:
mAP improvement: 0.0073 (+0.92%)
Rank-1 improvement: 0.0035 (+0.37%)
2025-05-28 04:48:23,524 DeMo.train INFO: Validation Results - Epoch: 20
2025-05-28 04:48:23,525 DeMo.train INFO: mAP: 80.0%
2025-05-28 04:48:23,525 DeMo.train INFO: CMC curve, Rank-1  :94.8%
2025-05-28 04:48:23,525 DeMo.train INFO: CMC curve, Rank-5  :95.6%
2025-05-28 04:48:23,525 DeMo.train INFO: CMC curve, Rank-10 :95.7%
2025-05-28 04:48:23,526 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:48:23,559 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:48:23,559 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 04:48:23,559 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7968
CMC curve: Rank-1: 0.9522, Rank-5: 0.9598, Rank-10: 0.9638
=> Enter reranking
=> Results after reranking:
mAP: 0.8020
CMC curve: Rank-1: 0.9440, Rank-5: 0.9504, Rank-10: 0.9522
=> Improvement:
mAP improvement: 0.0053 (+0.66%)
Rank-1 improvement: -0.0082 (-0.86%)
2025-05-28 04:53:35,642 DeMo.train INFO: Validation Results - Epoch: 20
2025-05-28 04:53:35,642 DeMo.train INFO: mAP: 80.2%
2025-05-28 04:53:35,642 DeMo.train INFO: CMC curve, Rank-1  :94.4%
2025-05-28 04:53:35,643 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 04:53:35,643 DeMo.train INFO: CMC curve, Rank-10 :95.2%
2025-05-28 04:53:35,643 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:53:35,855 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:53:35,855 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 04:53:35,855 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 04:53:35,855 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 04:53:35,855 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 04:53:35,856 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:53:46,934 DeMo.train INFO: Epoch[21] Iteration[10/129] Loss: 1.744, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:53:54,079 DeMo.train INFO: Epoch[21] Iteration[20/129] Loss: 1.747, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:54:01,209 DeMo.train INFO: Epoch[21] Iteration[30/129] Loss: 1.751, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:54:09,600 DeMo.train INFO: Epoch[21] Iteration[40/129] Loss: 1.751, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:54:23,611 DeMo.train INFO: Epoch[21] Iteration[50/129] Loss: 1.750, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:54:37,856 DeMo.train INFO: Epoch[21] Iteration[60/129] Loss: 1.749, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:54:52,372 DeMo.train INFO: Epoch[21] Iteration[70/129] Loss: 1.750, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:55:06,891 DeMo.train INFO: Epoch[21] Iteration[80/129] Loss: 1.749, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:55:21,435 DeMo.train INFO: Epoch[21] Iteration[90/129] Loss: 1.749, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:55:35,957 DeMo.train INFO: Epoch[21] Iteration[100/129] Loss: 1.748, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:55:49,837 DeMo.train INFO: Epoch[21] Iteration[110/129] Loss: 1.748, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:56:03,939 DeMo.train INFO: Epoch[21] Iteration[120/129] Loss: 1.747, Acc: 1.000, Base Lr: 7.24e-05
2025-05-28 04:56:14,106 DeMo.train INFO: Epoch 21 done. Time per batch: 1.246[s] Speed: 51.4[samples/s]
2025-05-28 04:56:14,110 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 04:56:14,110 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 04:56:14,110 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7903
CMC curve: Rank-1: 0.9458, Rank-5: 0.9603, Rank-10: 0.9621
=> Enter reranking
=> Results after reranking:
mAP: 0.7974
CMC curve: Rank-1: 0.9452, Rank-5: 0.9510, Rank-10: 0.9551
=> Improvement:
mAP improvement: 0.0071 (+0.90%)
Rank-1 improvement: -0.0006 (-0.06%)
2025-05-28 05:01:45,947 DeMo.train INFO: Validation Results - Epoch: 21
2025-05-28 05:01:45,947 DeMo.train INFO: mAP: 79.7%
2025-05-28 05:01:45,947 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 05:01:45,947 DeMo.train INFO: CMC curve, Rank-5  :95.1%
2025-05-28 05:01:45,947 DeMo.train INFO: CMC curve, Rank-10 :95.5%
2025-05-28 05:01:45,947 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:01:47,094 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:01:47,095 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 05:01:47,095 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7963
CMC curve: Rank-1: 0.9411, Rank-5: 0.9586, Rank-10: 0.9644
=> Enter reranking
=> Results after reranking:
mAP: 0.8040
CMC curve: Rank-1: 0.9469, Rank-5: 0.9569, Rank-10: 0.9638
=> Improvement:
mAP improvement: 0.0077 (+0.97%)
Rank-1 improvement: 0.0058 (+0.62%)
2025-05-28 05:06:49,627 DeMo.train INFO: Validation Results - Epoch: 21
2025-05-28 05:06:49,627 DeMo.train INFO: mAP: 80.4%
2025-05-28 05:06:49,627 DeMo.train INFO: CMC curve, Rank-1  :94.7%
2025-05-28 05:06:49,627 DeMo.train INFO: CMC curve, Rank-5  :95.7%
2025-05-28 05:06:49,627 DeMo.train INFO: CMC curve, Rank-10 :96.4%
2025-05-28 05:06:49,627 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:06:50,112 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:06:50,112 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 05:06:50,112 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7968
CMC curve: Rank-1: 0.9516, Rank-5: 0.9621, Rank-10: 0.9662
=> Enter reranking
=> Results after reranking:
mAP: 0.8024
CMC curve: Rank-1: 0.9423, Rank-5: 0.9481, Rank-10: 0.9528
=> Improvement:
mAP improvement: 0.0056 (+0.70%)
Rank-1 improvement: -0.0093 (-0.98%)
2025-05-28 05:11:50,069 DeMo.train INFO: Validation Results - Epoch: 21
2025-05-28 05:11:50,070 DeMo.train INFO: mAP: 80.2%
2025-05-28 05:11:50,070 DeMo.train INFO: CMC curve, Rank-1  :94.2%
2025-05-28 05:11:50,070 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 05:11:50,070 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 05:11:50,070 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:11:50,431 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:11:50,431 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 05:11:50,431 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 05:11:50,431 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 05:11:50,431 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 05:11:50,432 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:12:01,222 DeMo.train INFO: Epoch[22] Iteration[10/129] Loss: 1.747, Acc: 0.998, Base Lr: 5.82e-05
2025-05-28 05:12:08,352 DeMo.train INFO: Epoch[22] Iteration[20/129] Loss: 1.750, Acc: 0.999, Base Lr: 5.82e-05
2025-05-28 05:12:15,459 DeMo.train INFO: Epoch[22] Iteration[30/129] Loss: 1.749, Acc: 0.999, Base Lr: 5.82e-05
2025-05-28 05:12:22,809 DeMo.train INFO: Epoch[22] Iteration[40/129] Loss: 1.749, Acc: 1.000, Base Lr: 5.82e-05
2025-05-28 05:12:30,191 DeMo.train INFO: Epoch[22] Iteration[50/129] Loss: 1.747, Acc: 1.000, Base Lr: 5.82e-05
2025-05-28 05:12:43,619 DeMo.train INFO: Epoch[22] Iteration[60/129] Loss: 1.746, Acc: 1.000, Base Lr: 5.82e-05
2025-05-28 05:12:57,948 DeMo.train INFO: Epoch[22] Iteration[70/129] Loss: 1.746, Acc: 1.000, Base Lr: 5.82e-05
2025-05-28 05:13:12,220 DeMo.train INFO: Epoch[22] Iteration[80/129] Loss: 1.746, Acc: 1.000, Base Lr: 5.82e-05
2025-05-28 05:13:26,618 DeMo.train INFO: Epoch[22] Iteration[90/129] Loss: 1.746, Acc: 1.000, Base Lr: 5.82e-05
2025-05-28 05:13:41,078 DeMo.train INFO: Epoch[22] Iteration[100/129] Loss: 1.746, Acc: 1.000, Base Lr: 5.82e-05
2025-05-28 05:13:55,544 DeMo.train INFO: Epoch[22] Iteration[110/129] Loss: 1.746, Acc: 1.000, Base Lr: 5.82e-05
2025-05-28 05:14:09,996 DeMo.train INFO: Epoch[22] Iteration[120/129] Loss: 1.745, Acc: 1.000, Base Lr: 5.82e-05
2025-05-28 05:14:20,285 DeMo.train INFO: Epoch 22 done. Time per batch: 1.180[s] Speed: 54.2[samples/s]
2025-05-28 05:14:20,289 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:14:20,290 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 05:14:20,290 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7901
CMC curve: Rank-1: 0.9429, Rank-5: 0.9557, Rank-10: 0.9598
=> Enter reranking
=> Results after reranking:
mAP: 0.7980
CMC curve: Rank-1: 0.9458, Rank-5: 0.9481, Rank-10: 0.9534
=> Improvement:
mAP improvement: 0.0079 (+1.00%)
Rank-1 improvement: 0.0029 (+0.31%)
2025-05-28 05:19:47,735 DeMo.train INFO: Validation Results - Epoch: 22
2025-05-28 05:19:47,736 DeMo.train INFO: mAP: 79.8%
2025-05-28 05:19:47,736 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 05:19:47,736 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 05:19:47,736 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 05:19:47,736 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:19:48,860 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:19:48,861 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 05:19:48,861 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7928
CMC curve: Rank-1: 0.9399, Rank-5: 0.9522, Rank-10: 0.9574
=> Enter reranking
=> Results after reranking:
mAP: 0.7999
CMC curve: Rank-1: 0.9464, Rank-5: 0.9551, Rank-10: 0.9586
=> Improvement:
mAP improvement: 0.0071 (+0.89%)
Rank-1 improvement: 0.0064 (+0.68%)
2025-05-28 05:24:37,860 DeMo.train INFO: Validation Results - Epoch: 22
2025-05-28 05:24:37,860 DeMo.train INFO: mAP: 80.0%
2025-05-28 05:24:37,860 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 05:24:37,860 DeMo.train INFO: CMC curve, Rank-5  :95.5%
2025-05-28 05:24:37,860 DeMo.train INFO: CMC curve, Rank-10 :95.9%
2025-05-28 05:24:37,860 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:24:38,057 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:24:38,057 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 05:24:38,057 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7963
CMC curve: Rank-1: 0.9487, Rank-5: 0.9580, Rank-10: 0.9621
=> Enter reranking
=> Results after reranking:
mAP: 0.8024
CMC curve: Rank-1: 0.9440, Rank-5: 0.9469, Rank-10: 0.9522
=> Improvement:
mAP improvement: 0.0060 (+0.76%)
Rank-1 improvement: -0.0047 (-0.49%)
2025-05-28 05:29:24,932 DeMo.train INFO: Validation Results - Epoch: 22
2025-05-28 05:29:24,933 DeMo.train INFO: mAP: 80.2%
2025-05-28 05:29:24,933 DeMo.train INFO: CMC curve, Rank-1  :94.4%
2025-05-28 05:29:24,933 DeMo.train INFO: CMC curve, Rank-5  :94.7%
2025-05-28 05:29:24,933 DeMo.train INFO: CMC curve, Rank-10 :95.2%
2025-05-28 05:29:24,933 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:29:26,236 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:29:26,236 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 05:29:26,236 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 05:29:26,237 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 05:29:26,237 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 05:29:26,237 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:29:37,102 DeMo.train INFO: Epoch[23] Iteration[10/129] Loss: 1.744, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:29:44,209 DeMo.train INFO: Epoch[23] Iteration[20/129] Loss: 1.743, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:29:51,321 DeMo.train INFO: Epoch[23] Iteration[30/129] Loss: 1.745, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:29:58,447 DeMo.train INFO: Epoch[23] Iteration[40/129] Loss: 1.745, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:30:05,605 DeMo.train INFO: Epoch[23] Iteration[50/129] Loss: 1.744, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:30:12,750 DeMo.train INFO: Epoch[23] Iteration[60/129] Loss: 1.743, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:30:22,260 DeMo.train INFO: Epoch[23] Iteration[70/129] Loss: 1.743, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:30:36,417 DeMo.train INFO: Epoch[23] Iteration[80/129] Loss: 1.743, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:30:50,406 DeMo.train INFO: Epoch[23] Iteration[90/129] Loss: 1.743, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:31:04,653 DeMo.train INFO: Epoch[23] Iteration[100/129] Loss: 1.742, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:31:19,035 DeMo.train INFO: Epoch[23] Iteration[110/129] Loss: 1.742, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:31:33,547 DeMo.train INFO: Epoch[23] Iteration[120/129] Loss: 1.742, Acc: 1.000, Base Lr: 4.53e-05
2025-05-28 05:31:45,274 DeMo.train INFO: Epoch 23 done. Time per batch: 1.086[s] Speed: 58.9[samples/s]
2025-05-28 05:31:45,278 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:31:45,278 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 05:31:45,278 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7888
CMC curve: Rank-1: 0.9417, Rank-5: 0.9563, Rank-10: 0.9638
=> Enter reranking
=> Results after reranking:
mAP: 0.7967
CMC curve: Rank-1: 0.9458, Rank-5: 0.9510, Rank-10: 0.9569
=> Improvement:
mAP improvement: 0.0079 (+1.01%)
Rank-1 improvement: 0.0041 (+0.43%)
2025-05-28 05:37:09,580 DeMo.train INFO: Validation Results - Epoch: 23
2025-05-28 05:37:09,581 DeMo.train INFO: mAP: 79.7%
2025-05-28 05:37:09,581 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 05:37:09,581 DeMo.train INFO: CMC curve, Rank-5  :95.1%
2025-05-28 05:37:09,581 DeMo.train INFO: CMC curve, Rank-10 :95.7%
2025-05-28 05:37:09,581 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:37:09,820 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:37:09,821 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 05:37:09,821 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7945
CMC curve: Rank-1: 0.9318, Rank-5: 0.9499, Rank-10: 0.9574
=> Enter reranking
=> Results after reranking:
mAP: 0.8014
CMC curve: Rank-1: 0.9359, Rank-5: 0.9487, Rank-10: 0.9534
=> Improvement:
mAP improvement: 0.0069 (+0.87%)
Rank-1 improvement: 0.0041 (+0.44%)
2025-05-28 05:41:51,200 DeMo.train INFO: Validation Results - Epoch: 23
2025-05-28 05:41:51,200 DeMo.train INFO: mAP: 80.1%
2025-05-28 05:41:51,200 DeMo.train INFO: CMC curve, Rank-1  :93.6%
2025-05-28 05:41:51,201 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 05:41:51,201 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 05:41:51,201 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:41:51,991 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:41:51,992 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 05:41:51,992 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7956
CMC curve: Rank-1: 0.9493, Rank-5: 0.9586, Rank-10: 0.9638
=> Enter reranking
=> Results after reranking:
mAP: 0.8025
CMC curve: Rank-1: 0.9469, Rank-5: 0.9504, Rank-10: 0.9569
=> Improvement:
mAP improvement: 0.0069 (+0.86%)
Rank-1 improvement: -0.0023 (-0.25%)
2025-05-28 05:46:29,968 DeMo.train INFO: Validation Results - Epoch: 23
2025-05-28 05:46:29,968 DeMo.train INFO: mAP: 80.2%
2025-05-28 05:46:29,969 DeMo.train INFO: CMC curve, Rank-1  :94.7%
2025-05-28 05:46:29,969 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 05:46:29,969 DeMo.train INFO: CMC curve, Rank-10 :95.7%
2025-05-28 05:46:29,969 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:46:30,125 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:46:30,126 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 05:46:30,126 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 05:46:30,126 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 05:46:30,126 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 05:46:30,126 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:46:43,314 DeMo.train INFO: Epoch[24] Iteration[10/129] Loss: 1.740, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:46:50,533 DeMo.train INFO: Epoch[24] Iteration[20/129] Loss: 1.742, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:46:57,810 DeMo.train INFO: Epoch[24] Iteration[30/129] Loss: 1.742, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:47:04,954 DeMo.train INFO: Epoch[24] Iteration[40/129] Loss: 1.743, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:47:12,109 DeMo.train INFO: Epoch[24] Iteration[50/129] Loss: 1.743, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:47:19,260 DeMo.train INFO: Epoch[24] Iteration[60/129] Loss: 1.743, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:47:26,470 DeMo.train INFO: Epoch[24] Iteration[70/129] Loss: 1.743, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:47:37,204 DeMo.train INFO: Epoch[24] Iteration[80/129] Loss: 1.742, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:47:51,456 DeMo.train INFO: Epoch[24] Iteration[90/129] Loss: 1.741, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:48:05,916 DeMo.train INFO: Epoch[24] Iteration[100/129] Loss: 1.741, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:48:20,410 DeMo.train INFO: Epoch[24] Iteration[110/129] Loss: 1.741, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:48:34,919 DeMo.train INFO: Epoch[24] Iteration[120/129] Loss: 1.740, Acc: 1.000, Base Lr: 3.37e-05
2025-05-28 05:48:43,659 DeMo.train INFO: Epoch 24 done. Time per batch: 1.060[s] Speed: 60.4[samples/s]
2025-05-28 05:48:43,664 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:48:43,664 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 05:48:43,664 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7889
CMC curve: Rank-1: 0.9452, Rank-5: 0.9569, Rank-10: 0.9627
=> Enter reranking
=> Results after reranking:
mAP: 0.7970
CMC curve: Rank-1: 0.9458, Rank-5: 0.9499, Rank-10: 0.9551
=> Improvement:
mAP improvement: 0.0081 (+1.03%)
Rank-1 improvement: 0.0006 (+0.06%)
2025-05-28 05:54:03,517 DeMo.train INFO: Validation Results - Epoch: 24
2025-05-28 05:54:03,517 DeMo.train INFO: mAP: 79.7%
2025-05-28 05:54:03,517 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 05:54:03,517 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 05:54:03,517 DeMo.train INFO: CMC curve, Rank-10 :95.5%
2025-05-28 05:54:03,518 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:54:04,273 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:54:04,273 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 05:54:04,273 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7956
CMC curve: Rank-1: 0.9423, Rank-5: 0.9574, Rank-10: 0.9615
=> Enter reranking
=> Results after reranking:
mAP: 0.8030
CMC curve: Rank-1: 0.9510, Rank-5: 0.9580, Rank-10: 0.9603
=> Improvement:
mAP improvement: 0.0074 (+0.93%)
Rank-1 improvement: 0.0087 (+0.93%)
2025-05-28 05:58:44,881 DeMo.train INFO: Validation Results - Epoch: 24
2025-05-28 05:58:44,882 DeMo.train INFO: mAP: 80.3%
2025-05-28 05:58:44,882 DeMo.train INFO: CMC curve, Rank-1  :95.1%
2025-05-28 05:58:44,882 DeMo.train INFO: CMC curve, Rank-5  :95.8%
2025-05-28 05:58:44,882 DeMo.train INFO: CMC curve, Rank-10 :96.0%
2025-05-28 05:58:44,882 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:58:45,768 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 05:58:45,769 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 05:58:45,769 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7958
CMC curve: Rank-1: 0.9510, Rank-5: 0.9586, Rank-10: 0.9650
=> Enter reranking
=> Results after reranking:
mAP: 0.8026
CMC curve: Rank-1: 0.9469, Rank-5: 0.9504, Rank-10: 0.9539
=> Improvement:
mAP improvement: 0.0069 (+0.86%)
Rank-1 improvement: -0.0041 (-0.43%)
2025-05-28 06:03:25,304 DeMo.train INFO: Validation Results - Epoch: 24
2025-05-28 06:03:25,304 DeMo.train INFO: mAP: 80.3%
2025-05-28 06:03:25,304 DeMo.train INFO: CMC curve, Rank-1  :94.7%
2025-05-28 06:03:25,304 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 06:03:25,304 DeMo.train INFO: CMC curve, Rank-10 :95.4%
2025-05-28 06:03:25,304 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:03:25,743 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:03:25,744 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 06:03:25,744 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 06:03:25,744 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 06:03:25,744 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 06:03:25,744 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:03:45,080 DeMo.train INFO: Epoch[25] Iteration[10/129] Loss: 1.742, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:03:52,279 DeMo.train INFO: Epoch[25] Iteration[20/129] Loss: 1.742, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:03:59,389 DeMo.train INFO: Epoch[25] Iteration[30/129] Loss: 1.742, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:04:06,523 DeMo.train INFO: Epoch[25] Iteration[40/129] Loss: 1.743, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:04:13,641 DeMo.train INFO: Epoch[25] Iteration[50/129] Loss: 1.743, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:04:20,787 DeMo.train INFO: Epoch[25] Iteration[60/129] Loss: 1.743, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:04:27,960 DeMo.train INFO: Epoch[25] Iteration[70/129] Loss: 1.742, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:04:35,097 DeMo.train INFO: Epoch[25] Iteration[80/129] Loss: 1.742, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:04:46,007 DeMo.train INFO: Epoch[25] Iteration[90/129] Loss: 1.742, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:05:00,366 DeMo.train INFO: Epoch[25] Iteration[100/129] Loss: 1.742, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:05:14,527 DeMo.train INFO: Epoch[25] Iteration[110/129] Loss: 1.742, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:05:28,623 DeMo.train INFO: Epoch[25] Iteration[120/129] Loss: 1.741, Acc: 1.000, Base Lr: 2.38e-05
2025-05-28 06:05:38,639 DeMo.train INFO: Epoch 25 done. Time per batch: 1.046[s] Speed: 61.2[samples/s]
2025-05-28 06:05:38,644 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:05:38,644 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 06:05:38,644 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7896
CMC curve: Rank-1: 0.9446, Rank-5: 0.9574, Rank-10: 0.9633
=> Enter reranking
=> Results after reranking:
mAP: 0.7978
CMC curve: Rank-1: 0.9464, Rank-5: 0.9504, Rank-10: 0.9545
=> Improvement:
mAP improvement: 0.0082 (+1.04%)
Rank-1 improvement: 0.0017 (+0.19%)
2025-05-28 06:10:58,770 DeMo.train INFO: Validation Results - Epoch: 25
2025-05-28 06:10:58,771 DeMo.train INFO: mAP: 79.8%
2025-05-28 06:10:58,771 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 06:10:58,771 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 06:10:58,771 DeMo.train INFO: CMC curve, Rank-10 :95.5%
2025-05-28 06:10:58,771 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:11:00,207 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:11:00,208 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 06:11:00,208 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7918
CMC curve: Rank-1: 0.9312, Rank-5: 0.9464, Rank-10: 0.9522
=> Enter reranking
=> Results after reranking:
mAP: 0.7993
CMC curve: Rank-1: 0.9452, Rank-5: 0.9539, Rank-10: 0.9569
=> Improvement:
mAP improvement: 0.0075 (+0.95%)
Rank-1 improvement: 0.0140 (+1.50%)
2025-05-28 06:15:39,456 DeMo.train INFO: Validation Results - Epoch: 25
2025-05-28 06:15:39,456 DeMo.train INFO: mAP: 79.9%
2025-05-28 06:15:39,456 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 06:15:39,456 DeMo.train INFO: CMC curve, Rank-5  :95.4%
2025-05-28 06:15:39,457 DeMo.train INFO: CMC curve, Rank-10 :95.7%
2025-05-28 06:15:39,457 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:15:39,472 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:15:39,472 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 06:15:39,472 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7962
CMC curve: Rank-1: 0.9487, Rank-5: 0.9569, Rank-10: 0.9650
=> Enter reranking
=> Results after reranking:
mAP: 0.8030
CMC curve: Rank-1: 0.9446, Rank-5: 0.9475, Rank-10: 0.9528
=> Improvement:
mAP improvement: 0.0068 (+0.86%)
Rank-1 improvement: -0.0041 (-0.43%)
2025-05-28 06:20:15,957 DeMo.train INFO: Validation Results - Epoch: 25
2025-05-28 06:20:15,957 DeMo.train INFO: mAP: 80.3%
2025-05-28 06:20:15,957 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 06:20:15,957 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 06:20:15,958 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 06:20:15,958 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:20:15,974 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:20:15,975 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 06:20:15,975 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 06:20:15,975 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 06:20:15,975 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 06:20:15,975 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:20:37,043 DeMo.train INFO: Epoch[26] Iteration[10/129] Loss: 1.739, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:20:52,467 DeMo.train INFO: Epoch[26] Iteration[20/129] Loss: 1.741, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:20:59,656 DeMo.train INFO: Epoch[26] Iteration[30/129] Loss: 1.741, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:21:06,842 DeMo.train INFO: Epoch[26] Iteration[40/129] Loss: 1.741, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:21:14,003 DeMo.train INFO: Epoch[26] Iteration[50/129] Loss: 1.741, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:21:21,135 DeMo.train INFO: Epoch[26] Iteration[60/129] Loss: 1.740, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:21:28,292 DeMo.train INFO: Epoch[26] Iteration[70/129] Loss: 1.740, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:21:35,428 DeMo.train INFO: Epoch[26] Iteration[80/129] Loss: 1.740, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:21:42,582 DeMo.train INFO: Epoch[26] Iteration[90/129] Loss: 1.739, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:21:51,042 DeMo.train INFO: Epoch[26] Iteration[100/129] Loss: 1.739, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:22:05,454 DeMo.train INFO: Epoch[26] Iteration[110/129] Loss: 1.739, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:22:19,895 DeMo.train INFO: Epoch[26] Iteration[120/129] Loss: 1.739, Acc: 1.000, Base Lr: 1.55e-05
2025-05-28 06:22:28,698 DeMo.train INFO: Epoch 26 done. Time per batch: 1.053[s] Speed: 60.8[samples/s]
2025-05-28 06:22:28,703 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:22:28,703 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 06:22:28,703 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7881
CMC curve: Rank-1: 0.9417, Rank-5: 0.9551, Rank-10: 0.9598
=> Enter reranking
=> Results after reranking:
mAP: 0.7963
CMC curve: Rank-1: 0.9452, Rank-5: 0.9493, Rank-10: 0.9528
=> Improvement:
mAP improvement: 0.0082 (+1.04%)
Rank-1 improvement: 0.0035 (+0.37%)
2025-05-28 06:27:48,049 DeMo.train INFO: Validation Results - Epoch: 26
2025-05-28 06:27:48,049 DeMo.train INFO: mAP: 79.6%
2025-05-28 06:27:48,049 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 06:27:48,049 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 06:27:48,049 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 06:27:48,049 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:27:49,331 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:27:49,331 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 06:27:49,331 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7916
CMC curve: Rank-1: 0.9364, Rank-5: 0.9516, Rank-10: 0.9563
=> Enter reranking
=> Results after reranking:
mAP: 0.7983
CMC curve: Rank-1: 0.9434, Rank-5: 0.9499, Rank-10: 0.9528
=> Improvement:
mAP improvement: 0.0067 (+0.85%)
Rank-1 improvement: 0.0070 (+0.75%)
2025-05-28 06:32:29,349 DeMo.train INFO: Validation Results - Epoch: 26
2025-05-28 06:32:29,349 DeMo.train INFO: mAP: 79.8%
2025-05-28 06:32:29,349 DeMo.train INFO: CMC curve, Rank-1  :94.3%
2025-05-28 06:32:29,350 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 06:32:29,350 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 06:32:29,350 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:32:29,379 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:32:29,379 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 06:32:29,379 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7946
CMC curve: Rank-1: 0.9487, Rank-5: 0.9563, Rank-10: 0.9609
=> Enter reranking
=> Results after reranking:
mAP: 0.8018
CMC curve: Rank-1: 0.9464, Rank-5: 0.9487, Rank-10: 0.9528
=> Improvement:
mAP improvement: 0.0072 (+0.90%)
Rank-1 improvement: -0.0023 (-0.25%)
2025-05-28 06:37:11,277 DeMo.train INFO: Validation Results - Epoch: 26
2025-05-28 06:37:11,277 DeMo.train INFO: mAP: 80.2%
2025-05-28 06:37:11,277 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 06:37:11,277 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 06:37:11,277 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 06:37:11,277 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:37:12,399 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:37:12,399 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 06:37:12,399 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 06:37:12,399 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 06:37:12,399 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 06:37:12,399 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:37:32,892 DeMo.train INFO: Epoch[27] Iteration[10/129] Loss: 1.741, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:37:48,899 DeMo.train INFO: Epoch[27] Iteration[20/129] Loss: 1.749, Acc: 0.999, Base Lr: 8.91e-06
2025-05-28 06:38:01,995 DeMo.train INFO: Epoch[27] Iteration[30/129] Loss: 1.747, Acc: 0.999, Base Lr: 8.91e-06
2025-05-28 06:38:09,206 DeMo.train INFO: Epoch[27] Iteration[40/129] Loss: 1.745, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:38:16,378 DeMo.train INFO: Epoch[27] Iteration[50/129] Loss: 1.744, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:38:23,531 DeMo.train INFO: Epoch[27] Iteration[60/129] Loss: 1.743, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:38:30,705 DeMo.train INFO: Epoch[27] Iteration[70/129] Loss: 1.742, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:38:37,839 DeMo.train INFO: Epoch[27] Iteration[80/129] Loss: 1.742, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:38:44,993 DeMo.train INFO: Epoch[27] Iteration[90/129] Loss: 1.742, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:38:52,281 DeMo.train INFO: Epoch[27] Iteration[100/129] Loss: 1.741, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:39:02,978 DeMo.train INFO: Epoch[27] Iteration[110/129] Loss: 1.741, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:39:17,189 DeMo.train INFO: Epoch[27] Iteration[120/129] Loss: 1.741, Acc: 1.000, Base Lr: 8.91e-06
2025-05-28 06:39:27,497 DeMo.train INFO: Epoch 27 done. Time per batch: 1.064[s] Speed: 60.2[samples/s]
2025-05-28 06:39:27,507 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:39:27,507 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 06:39:27,507 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7888
CMC curve: Rank-1: 0.9423, Rank-5: 0.9574, Rank-10: 0.9598
=> Enter reranking
=> Results after reranking:
mAP: 0.7971
CMC curve: Rank-1: 0.9464, Rank-5: 0.9499, Rank-10: 0.9528
=> Improvement:
mAP improvement: 0.0082 (+1.04%)
Rank-1 improvement: 0.0041 (+0.43%)
2025-05-28 06:44:43,038 DeMo.train INFO: Validation Results - Epoch: 27
2025-05-28 06:44:43,039 DeMo.train INFO: mAP: 79.7%
2025-05-28 06:44:43,039 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 06:44:43,039 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 06:44:43,039 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 06:44:43,039 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:44:43,572 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:44:43,573 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 06:44:43,573 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7987
CMC curve: Rank-1: 0.9417, Rank-5: 0.9545, Rank-10: 0.9603
=> Enter reranking
=> Results after reranking:
mAP: 0.8060
CMC curve: Rank-1: 0.9487, Rank-5: 0.9557, Rank-10: 0.9615
=> Improvement:
mAP improvement: 0.0073 (+0.92%)
Rank-1 improvement: 0.0070 (+0.74%)
2025-05-28 06:49:23,463 DeMo.train INFO: Validation Results - Epoch: 27
2025-05-28 06:49:23,464 DeMo.train INFO: mAP: 80.6%
2025-05-28 06:49:23,464 DeMo.train INFO: CMC curve, Rank-1  :94.9%
2025-05-28 06:49:23,464 DeMo.train INFO: CMC curve, Rank-5  :95.6%
2025-05-28 06:49:23,464 DeMo.train INFO: CMC curve, Rank-10 :96.2%
2025-05-28 06:49:23,464 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:49:23,478 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:49:23,479 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 06:49:23,479 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7956
CMC curve: Rank-1: 0.9475, Rank-5: 0.9574, Rank-10: 0.9644
=> Enter reranking
=> Results after reranking:
mAP: 0.8030
CMC curve: Rank-1: 0.9464, Rank-5: 0.9510, Rank-10: 0.9551
=> Improvement:
mAP improvement: 0.0074 (+0.93%)
Rank-1 improvement: -0.0012 (-0.12%)
2025-05-28 06:54:02,735 DeMo.train INFO: Validation Results - Epoch: 27
2025-05-28 06:54:02,735 DeMo.train INFO: mAP: 80.3%
2025-05-28 06:54:02,736 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 06:54:02,736 DeMo.train INFO: CMC curve, Rank-5  :95.1%
2025-05-28 06:54:02,736 DeMo.train INFO: CMC curve, Rank-10 :95.5%
2025-05-28 06:54:02,736 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:54:03,267 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:54:03,267 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 06:54:03,267 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 06:54:03,268 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 06:54:03,268 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 06:54:03,268 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:54:23,952 DeMo.train INFO: Epoch[28] Iteration[10/129] Loss: 1.745, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:54:39,890 DeMo.train INFO: Epoch[28] Iteration[20/129] Loss: 1.743, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:54:55,802 DeMo.train INFO: Epoch[28] Iteration[30/129] Loss: 1.741, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:55:09,762 DeMo.train INFO: Epoch[28] Iteration[40/129] Loss: 1.741, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:55:16,963 DeMo.train INFO: Epoch[28] Iteration[50/129] Loss: 1.740, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:55:24,065 DeMo.train INFO: Epoch[28] Iteration[60/129] Loss: 1.740, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:55:31,207 DeMo.train INFO: Epoch[28] Iteration[70/129] Loss: 1.740, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:55:38,334 DeMo.train INFO: Epoch[28] Iteration[80/129] Loss: 1.740, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:55:45,440 DeMo.train INFO: Epoch[28] Iteration[90/129] Loss: 1.740, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:55:52,553 DeMo.train INFO: Epoch[28] Iteration[100/129] Loss: 1.739, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:55:59,686 DeMo.train INFO: Epoch[28] Iteration[110/129] Loss: 1.739, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:56:11,013 DeMo.train INFO: Epoch[28] Iteration[120/129] Loss: 1.739, Acc: 1.000, Base Lr: 4.17e-06
2025-05-28 06:56:22,491 DeMo.train INFO: Epoch 28 done. Time per batch: 1.088[s] Speed: 58.8[samples/s]
2025-05-28 06:56:22,495 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 06:56:22,496 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 06:56:22,496 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7884
CMC curve: Rank-1: 0.9388, Rank-5: 0.9563, Rank-10: 0.9592
=> Enter reranking
=> Results after reranking:
mAP: 0.7964
CMC curve: Rank-1: 0.9452, Rank-5: 0.9504, Rank-10: 0.9551
=> Improvement:
mAP improvement: 0.0079 (+1.01%)
Rank-1 improvement: 0.0064 (+0.68%)
2025-05-28 07:01:36,349 DeMo.train INFO: Validation Results - Epoch: 28
2025-05-28 07:01:36,349 DeMo.train INFO: mAP: 79.6%
2025-05-28 07:01:36,349 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 07:01:36,350 DeMo.train INFO: CMC curve, Rank-5  :95.0%
2025-05-28 07:01:36,350 DeMo.train INFO: CMC curve, Rank-10 :95.5%
2025-05-28 07:01:36,350 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:01:37,843 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:01:37,843 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 07:01:37,843 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7968
CMC curve: Rank-1: 0.9434, Rank-5: 0.9539, Rank-10: 0.9609
=> Enter reranking
=> Results after reranking:
mAP: 0.8038
CMC curve: Rank-1: 0.9464, Rank-5: 0.9522, Rank-10: 0.9563
=> Improvement:
mAP improvement: 0.0070 (+0.88%)
Rank-1 improvement: 0.0029 (+0.31%)
2025-05-28 07:06:15,892 DeMo.train INFO: Validation Results - Epoch: 28
2025-05-28 07:06:15,893 DeMo.train INFO: mAP: 80.4%
2025-05-28 07:06:15,893 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 07:06:15,893 DeMo.train INFO: CMC curve, Rank-5  :95.2%
2025-05-28 07:06:15,893 DeMo.train INFO: CMC curve, Rank-10 :95.6%
2025-05-28 07:06:15,893 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:06:17,182 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:06:17,183 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 07:06:17,183 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7955
CMC curve: Rank-1: 0.9458, Rank-5: 0.9580, Rank-10: 0.9615
=> Enter reranking
=> Results after reranking:
mAP: 0.8025
CMC curve: Rank-1: 0.9458, Rank-5: 0.9510, Rank-10: 0.9545
=> Improvement:
mAP improvement: 0.0070 (+0.88%)
Rank-1 improvement: 0.0000 (+0.00%)
2025-05-28 07:10:54,161 DeMo.train INFO: Validation Results - Epoch: 28
2025-05-28 07:10:54,161 DeMo.train INFO: mAP: 80.3%
2025-05-28 07:10:54,161 DeMo.train INFO: CMC curve, Rank-1  :94.6%
2025-05-28 07:10:54,161 DeMo.train INFO: CMC curve, Rank-5  :95.1%
2025-05-28 07:10:54,161 DeMo.train INFO: CMC curve, Rank-10 :95.5%
2025-05-28 07:10:54,161 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:10:54,176 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:10:54,176 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 07:10:54,176 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 07:10:54,176 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 07:10:54,176 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 07:10:54,176 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:11:14,812 DeMo.train INFO: Epoch[29] Iteration[10/129] Loss: 1.744, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:11:30,742 DeMo.train INFO: Epoch[29] Iteration[20/129] Loss: 1.741, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:11:46,694 DeMo.train INFO: Epoch[29] Iteration[30/129] Loss: 1.741, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:12:02,777 DeMo.train INFO: Epoch[29] Iteration[40/129] Loss: 1.741, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:12:14,097 DeMo.train INFO: Epoch[29] Iteration[50/129] Loss: 1.740, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:12:21,206 DeMo.train INFO: Epoch[29] Iteration[60/129] Loss: 1.740, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:12:28,340 DeMo.train INFO: Epoch[29] Iteration[70/129] Loss: 1.739, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:12:35,476 DeMo.train INFO: Epoch[29] Iteration[80/129] Loss: 1.740, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:12:42,596 DeMo.train INFO: Epoch[29] Iteration[90/129] Loss: 1.739, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:12:49,729 DeMo.train INFO: Epoch[29] Iteration[100/129] Loss: 1.739, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:12:56,842 DeMo.train INFO: Epoch[29] Iteration[110/129] Loss: 1.738, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:13:04,108 DeMo.train INFO: Epoch[29] Iteration[120/129] Loss: 1.738, Acc: 1.000, Base Lr: 1.31e-06
2025-05-28 07:13:12,207 DeMo.train INFO: Epoch 29 done. Time per batch: 1.087[s] Speed: 58.9[samples/s]
2025-05-28 07:13:12,212 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:13:12,212 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 07:13:12,212 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7879
CMC curve: Rank-1: 0.9394, Rank-5: 0.9545, Rank-10: 0.9586
=> Enter reranking
=> Results after reranking:
mAP: 0.7960
CMC curve: Rank-1: 0.9452, Rank-5: 0.9487, Rank-10: 0.9516
=> Improvement:
mAP improvement: 0.0081 (+1.02%)
Rank-1 improvement: 0.0058 (+0.62%)
2025-05-28 07:18:24,143 DeMo.train INFO: Validation Results - Epoch: 29
2025-05-28 07:18:24,143 DeMo.train INFO: mAP: 79.6%
2025-05-28 07:18:24,143 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 07:18:24,144 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 07:18:24,144 DeMo.train INFO: CMC curve, Rank-10 :95.2%
2025-05-28 07:18:24,144 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:18:24,369 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:18:24,370 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 07:18:24,370 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7847
CMC curve: Rank-1: 0.9242, Rank-5: 0.9446, Rank-10: 0.9522
=> Enter reranking
=> Results after reranking:
mAP: 0.7920
CMC curve: Rank-1: 0.9324, Rank-5: 0.9452, Rank-10: 0.9516
=> Improvement:
mAP improvement: 0.0073 (+0.93%)
Rank-1 improvement: 0.0082 (+0.88%)
2025-05-28 07:23:03,427 DeMo.train INFO: Validation Results - Epoch: 29
2025-05-28 07:23:03,427 DeMo.train INFO: mAP: 79.2%
2025-05-28 07:23:03,428 DeMo.train INFO: CMC curve, Rank-1  :93.2%
2025-05-28 07:23:03,428 DeMo.train INFO: CMC curve, Rank-5  :94.5%
2025-05-28 07:23:03,428 DeMo.train INFO: CMC curve, Rank-10 :95.2%
2025-05-28 07:23:03,428 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:23:04,304 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:23:04,305 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 07:23:04,305 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7941
CMC curve: Rank-1: 0.9458, Rank-5: 0.9534, Rank-10: 0.9609
=> Enter reranking
=> Results after reranking:
mAP: 0.8008
CMC curve: Rank-1: 0.9440, Rank-5: 0.9475, Rank-10: 0.9539
=> Improvement:
mAP improvement: 0.0067 (+0.85%)
Rank-1 improvement: -0.0017 (-0.18%)
2025-05-28 07:27:42,657 DeMo.train INFO: Validation Results - Epoch: 29
2025-05-28 07:27:42,658 DeMo.train INFO: mAP: 80.1%
2025-05-28 07:27:42,658 DeMo.train INFO: CMC curve, Rank-1  :94.4%
2025-05-28 07:27:42,658 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 07:27:42,658 DeMo.train INFO: CMC curve, Rank-10 :95.4%
2025-05-28 07:27:42,658 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:27:43,662 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:27:43,663 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 07:27:43,663 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 07:27:43,663 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 07:27:43,663 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 07:27:43,663 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:28:04,288 DeMo.train INFO: Epoch[30] Iteration[10/129] Loss: 1.740, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:28:20,058 DeMo.train INFO: Epoch[30] Iteration[20/129] Loss: 1.741, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:28:35,909 DeMo.train INFO: Epoch[30] Iteration[30/129] Loss: 1.742, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:28:51,753 DeMo.train INFO: Epoch[30] Iteration[40/129] Loss: 1.741, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:29:07,637 DeMo.train INFO: Epoch[30] Iteration[50/129] Loss: 1.740, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:29:16,948 DeMo.train INFO: Epoch[30] Iteration[60/129] Loss: 1.740, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:29:24,048 DeMo.train INFO: Epoch[30] Iteration[70/129] Loss: 1.740, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:29:31,145 DeMo.train INFO: Epoch[30] Iteration[80/129] Loss: 1.739, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:29:38,258 DeMo.train INFO: Epoch[30] Iteration[90/129] Loss: 1.739, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:29:45,366 DeMo.train INFO: Epoch[30] Iteration[100/129] Loss: 1.739, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:29:52,451 DeMo.train INFO: Epoch[30] Iteration[110/129] Loss: 1.738, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:29:59,546 DeMo.train INFO: Epoch[30] Iteration[120/129] Loss: 1.738, Acc: 1.000, Base Lr: 3.50e-07
2025-05-28 07:30:05,660 DeMo.train INFO: Epoch 30 done. Time per batch: 1.109[s] Speed: 57.7[samples/s]
2025-05-28 07:30:05,665 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:30:05,665 DeMo.train INFO: Current is the ori feature testing!
2025-05-28 07:30:05,665 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7883
CMC curve: Rank-1: 0.9405, Rank-5: 0.9557, Rank-10: 0.9598
=> Enter reranking
=> Results after reranking:
mAP: 0.7963
CMC curve: Rank-1: 0.9452, Rank-5: 0.9481, Rank-10: 0.9516
=> Improvement:
mAP improvement: 0.0079 (+1.01%)
Rank-1 improvement: 0.0047 (+0.50%)
2025-05-28 07:35:15,445 DeMo.train INFO: Validation Results - Epoch: 30
2025-05-28 07:35:15,445 DeMo.train INFO: mAP: 79.6%
2025-05-28 07:35:15,446 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 07:35:15,446 DeMo.train INFO: CMC curve, Rank-5  :94.8%
2025-05-28 07:35:15,446 DeMo.train INFO: CMC curve, Rank-10 :95.2%
2025-05-28 07:35:15,446 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:35:16,683 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:35:16,684 DeMo.train INFO: Current is the moe feature testing!
2025-05-28 07:35:16,684 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7985
CMC curve: Rank-1: 0.9429, Rank-5: 0.9545, Rank-10: 0.9586
=> Enter reranking
=> Results after reranking:
mAP: 0.8056
CMC curve: Rank-1: 0.9452, Rank-5: 0.9545, Rank-10: 0.9563
=> Improvement:
mAP improvement: 0.0071 (+0.89%)
Rank-1 improvement: 0.0023 (+0.25%)
2025-05-28 07:39:56,594 DeMo.train INFO: Validation Results - Epoch: 30
2025-05-28 07:39:56,594 DeMo.train INFO: mAP: 80.6%
2025-05-28 07:39:56,594 DeMo.train INFO: CMC curve, Rank-1  :94.5%
2025-05-28 07:39:56,594 DeMo.train INFO: CMC curve, Rank-5  :95.5%
2025-05-28 07:39:56,595 DeMo.train INFO: CMC curve, Rank-10 :95.6%
2025-05-28 07:39:56,595 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:39:57,202 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:39:57,202 DeMo.train INFO: Current is the [moe,ori] feature testing!
2025-05-28 07:39:57,202 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The test feature is normalized
=> Computing DistMat with euclidean_distance (before reranking)
=> Results before reranking:
mAP: 0.7953
CMC curve: Rank-1: 0.9452, Rank-5: 0.9580, Rank-10: 0.9627
=> Enter reranking
=> Results after reranking:
mAP: 0.8024
CMC curve: Rank-1: 0.9440, Rank-5: 0.9493, Rank-10: 0.9534
=> Improvement:
mAP improvement: 0.0070 (+0.89%)
Rank-1 improvement: -0.0012 (-0.12%)
2025-05-28 07:44:34,471 DeMo.train INFO: Validation Results - Epoch: 30
2025-05-28 07:44:34,472 DeMo.train INFO: mAP: 80.2%
2025-05-28 07:44:34,472 DeMo.train INFO: CMC curve, Rank-1  :94.4%
2025-05-28 07:44:34,472 DeMo.train INFO: CMC curve, Rank-5  :94.9%
2025-05-28 07:44:34,472 DeMo.train INFO: CMC curve, Rank-10 :95.3%
2025-05-28 07:44:34,472 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:44:35,409 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2025-05-28 07:44:35,410 DeMo.train INFO: Best mAP: 80.9%
2025-05-28 07:44:35,410 DeMo.train INFO: Best Rank-1: 94.3%
2025-05-28 07:44:35,410 DeMo.train INFO: Best Rank-5: 94.8%
2025-05-28 07:44:35,410 DeMo.train INFO: Best Rank-10: 95.1%
2025-05-28 07:44:35,410 DeMo.train INFO: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
